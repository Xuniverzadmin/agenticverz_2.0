# WIRING VIOLATIONS

**Generated by:** `scripts/ops/hoc_literature_generator.py`  
**Reference:** HOC_LAYER_TOPOLOGY_V1.md (RATIFIED, V1.4.0)

**Total violations:** 82

## General (11 violations)

| File | Layer | Import | Rule | Fix | Line |
|------|-------|--------|------|-----|------|
| `alert_worker.py` | L5_engines | `from app.db_async import AsyncSessionLocal, async_` | L5 MUST NOT access DB directly | Use L6 driver for DB access | 99 |
| `knowledge_lifecycle_manager.py` | L5_engines | `from app.models.knowledge_lifecycle import Knowled` | L5 MUST NOT import L7 models directly | Route through L6 driver | 54 |
| `knowledge_sdk.py` | L5_engines | `from app.models.knowledge_lifecycle import Knowled` | L5 MUST NOT import L7 models directly | Route through L6 driver | 58 |
| `lifecycle_stages_base.py` | L5_engines | `from app.models.knowledge_lifecycle import Knowled` | L5 MUST NOT import L7 models directly | Route through L6 driver | 44 |
| `guard_write_driver.py` | L5_other | `from sqlalchemy import and_, select` | L5 MUST NOT import sqlalchemy | Move DB logic to L6 driver | 51 |
| `guard_write_driver.py` | L5_other | `from sqlmodel import Session` | L5 MUST NOT import sqlmodel at runtime | Move DB logic to L6 driver | 52 |
| `guard_write_driver.py` | L5_other | `from app.models.killswitch import Incident, Incide` | L5 MUST NOT import L7 models directly | Route through L6 driver | 55 |
| `offboarding.py` | L5_other | `from app.models.knowledge_lifecycle import Knowled` | L5 MUST NOT import L7 models directly | Route through L6 driver | 50 |
| `onboarding.py` | L5_other | `from app.models.knowledge_lifecycle import Knowled` | L5 MUST NOT import L7 models directly | Route through L6 driver | 45 |
| `job_executor.py` | L5_other | `from app.models.governance_job import JobStatus, J` | L5 MUST NOT import L7 models directly | Route through L6 driver | 63 |
| `contract_engine.py` | L5_other | `from app.models.contract import TERMINAL_STATES, V` | L5 MUST NOT import L7 models directly | Route through L6 driver | 82 |

## Overview (1 violations)

| File | Layer | Import | Rule | Fix | Line |
|------|-------|--------|------|-----|------|
| `overview.py` | L2_api | `from app.hoc.cus.overview.L5_engines.overview_faca` | L2 MUST NOT import L5 directly | Route through L3 adapter | 51 |

## Activity (1 violations)

| File | Layer | Import | Rule | Fix | Line |
|------|-------|--------|------|-----|------|
| `activity.py` | L2_api | `from app.hoc.cus.activity.L5_engines.activity_faca` | L2 MUST NOT import L5 directly | Route through L3 adapter | 68 |

## Incidents (4 violations)

| File | Layer | Import | Rule | Fix | Line |
|------|-------|--------|------|-----|------|
| `incidents.py` | L2_api | `from app.models.killswitch import Incident` | L2 MUST NOT import L7 models | Use L5 schemas or response models | 54 |
| `incidents.py` | L2_api | `from app.hoc.cus.incidents.L5_engines.incidents_fa` | L2 MUST NOT import L5 directly | Route through L3 adapter | 57 |
| `incident_severity_engine.py` | L5_engines | `from app.models.killswitch import IncidentSeverity` | L5 MUST NOT import L7 models directly | Route through L6 driver | 39 |
| `incident_write_engine.py` | L5_engines | `from app.models.audit_ledger import ActorType` | L5 MUST NOT import L7 models directly | Route through L6 driver | 57 |

## Policies (42 violations)

| File | Layer | Import | Rule | Fix | Line |
|------|-------|--------|------|-----|------|
| `alerts.py` | L2_api | `from app.hoc.cus.general.L5_engines.alerts_facade ` | L2 MUST NOT import L5 directly | Route through L3 adapter | 46 |
| `analytics.py` | L2_api | `from app.hoc.cus.analytics.L5_engines.analytics_fa` | L2 MUST NOT import L5 directly | Route through L3 adapter | 57 |
| `aos_accounts.py` | L2_api | `from app.hoc.cus.account.L5_engines.accounts_facad` | L2 MUST NOT import L5 directly | Route through L3 adapter | 65 |
| `aos_accounts.py` | L2_api | `from app.models.tenant import Invitation, Subscrip` | L2 MUST NOT import L7 models | Use L5 schemas or response models | 66 |
| `aos_api_key.py` | L2_api | `from app.hoc.cus.api_keys.L5_engines.api_keys_faca` | L2 MUST NOT import L5 directly | Route through L3 adapter | 49 |
| `aos_cus_integrations.py` | L2_api | `from app.hoc.cus.integrations.L5_engines.integrati` | L2 MUST NOT import L5 directly | Route through L3 adapter | 69 |
| `compliance.py` | L2_api | `from app.hoc.cus.general.L5_engines.compliance_fac` | L2 MUST NOT import L5 directly | Route through L3 adapter | 40 |
| `connectors.py` | L2_api | `from app.hoc.cus.integrations.L5_engines.connector` | L2 MUST NOT import L5 directly | Route through L3 adapter | 40 |
| `controls.py` | L2_api | `from app.hoc.cus.controls.L5_engines.controls_faca` | L2 MUST NOT import L5 directly | Route through L3 adapter | 42 |
| `cus_enforcement.py` | L2_api | `from app.hoc.cus.policies.L5_engines.cus_enforceme` | L2 MUST NOT import L5 directly | Route through L3 adapter | 41 |
| `datasources.py` | L2_api | `from app.hoc.cus.integrations.L5_engines.datasourc` | L2 MUST NOT import L5 directly | Route through L3 adapter | 43 |
| `detection.py` | L2_api | `from app.hoc.cus.analytics.L5_engines.detection_fa` | L2 MUST NOT import L5 directly | Route through L3 adapter | 40 |
| `evidence.py` | L2_api | `from app.hoc.cus.logs.L5_engines.evidence_facade i` | L2 MUST NOT import L5 directly | Route through L3 adapter | 42 |
| `governance.py` | L2_api | `from app.hoc.cus.policies.L5_engines.governance_fa` | L2 MUST NOT import L5 directly | Route through L3 adapter | 40 |
| `guard.py` | L2_api | `from app.models.killswitch import DefaultGuardrail` | L2 MUST NOT import L7 models | Use L5 schemas or response models | 71 |
| `guard.py` | L2_api | `from app.models.tenant import Tenant` | L2 MUST NOT import L7 models | Use L5 schemas or response models | 79 |
| `guard.py` | L2_api | `from app.hoc.cus.logs.L5_engines.certificate impor` | L2 MUST NOT import L5 directly | Route through L3 adapter | 83 |
| `guard.py` | L2_api | `from app.hoc.cus.logs.L5_engines.replay_determinis` | L2 MUST NOT import L5 directly | Route through L3 adapter | 93 |
| `guard.py` | L2_api | `from app.hoc.cus.logs.L5_engines.replay_determinis` | L2 MUST NOT import L5 directly | Route through L3 adapter | 97 |
| `lifecycle.py` | L2_api | `from app.hoc.cus.general.L5_engines.lifecycle_faca` | L2 MUST NOT import L5 directly | Route through L3 adapter | 49 |
| `logs.py` | L2_api | `from app.hoc.cus.logs.L5_engines.logs_facade impor` | L2 MUST NOT import L5 directly | Route through L3 adapter | 71 |
| `monitors.py` | L2_api | `from app.hoc.cus.general.L5_engines.monitors_facad` | L2 MUST NOT import L5 directly | Route through L3 adapter | 44 |
| `notifications.py` | L2_api | `from app.hoc.cus.account.L5_engines.notifications_` | L2 MUST NOT import L5 directly | Route through L3 adapter | 40 |
| `override.py` | L2_api | `from app.hoc.cus.controls.L6_drivers.override_driv` | L2 MUST NOT import L6 | Route through L3 → L5 → L6 | 43 |
| `policies.py` | L2_api | `from app.hoc.cus.policies.L5_engines.policies_faca` | L2 MUST NOT import L5 directly | Route through L3 adapter | 52 |
| `policy_layer.py` | L2_api | `from app.hoc.cus.policies.L5_engines.policy_driver` | L2 MUST NOT import L5 directly | Route through L3 adapter | 39 |
| `policy_limits_crud.py` | L2_api | `from app.hoc.cus.policies.L5_engines.policy_limits` | L2 MUST NOT import L5 directly | Route through L3 adapter | 45 |
| `policy_rules_crud.py` | L2_api | `from app.hoc.cus.policies.L5_engines.policy_rules_` | L2 MUST NOT import L5 directly | Route through L3 adapter | 41 |
| `rate_limits.py` | L2_api | `from app.hoc.cus.policies.L5_engines.limits_facade` | L2 MUST NOT import L5 directly | Route through L3 adapter | 42 |
| `retrieval.py` | L2_api | `from app.hoc.cus.general.L5_engines.retrieval_faca` | L2 MUST NOT import L5 directly | Route through L3 adapter | 42 |
| `scheduler.py` | L2_api | `from app.hoc.cus.general.L5_engines.scheduler_faca` | L2 MUST NOT import L5 directly | Route through L3 adapter | 44 |
| `simulate.py` | L2_api | `from app.hoc.cus.policies.L5_engines.limits_simula` | L2 MUST NOT import L5 directly | Route through L3 adapter | 42 |
| `workers.py` | L2_api | `from app.models.tenant import WorkerRun` | L2 MUST NOT import L7 models | Use L5 schemas or response models | 59 |
| `workers.py` | L2_api | `from app.hoc.cus.general.L6_drivers.worker_write_s` | L2 MUST NOT import L6 | Route through L3 → L5 → L6 | 63 |
| `engine.py` | L5_engines | `from sqlalchemy.exc import SQLAlchemyError` | L5 MUST NOT import sqlalchemy | Move DB logic to L6 driver | 102 |
| `keys_shim.py` | L5_engines | `from app.models.tenant import APIKey` | L5 MUST NOT import L7 models directly | Route through L6 driver | 49 |
| `policy_limits_engine.py` | L5_engines | `from app.models.policy_control_plane import Limit,` | L5 MUST NOT import L7 models directly | Route through L6 driver | 66 |
| `policy_limits_engine.py` | L5_engines | `from app.models.audit_ledger import ActorType` | L5 MUST NOT import L7 models directly | Route through L6 driver | 71 |
| `policy_proposal_engine.py` | L5_engines | `from app.models.audit_ledger import ActorType` | L5 MUST NOT import L7 models directly | Route through L6 driver | 49 |
| `policy_proposal_engine.py` | L5_engines | `from app.models.policy import PolicyApprovalReques` | L5 MUST NOT import L7 models directly | Route through L6 driver | 50 |
| `policy_rules_engine.py` | L5_engines | `from app.models.policy_control_plane import Policy` | L5 MUST NOT import L7 models directly | Route through L6 driver | 67 |
| `policy_rules_engine.py` | L5_engines | `from app.models.audit_ledger import ActorType` | L5 MUST NOT import L7 models directly | Route through L6 driver | 72 |

## Controls (5 violations)

| File | Layer | Import | Rule | Fix | Line |
|------|-------|--------|------|-----|------|
| `customer_killswitch_adapter.py` | L3_adapters | `from sqlmodel import Session` | L3 MUST NOT access DB | Delegate to L5 engine or L6 driver | 38 |
| `customer_killswitch_adapter.py` | L3_adapters | `from app.models.killswitch import TriggerType` | L3 MUST NOT import L7 models | Use L5 schemas for data contracts | 42 |
| `killswitch_read_driver.py` | L5_other | `from sqlalchemy import and_, desc, func, select` | L5 MUST NOT import sqlalchemy | Move DB logic to L6 driver | 36 |
| `killswitch_read_driver.py` | L5_other | `from sqlmodel import Session` | L5 MUST NOT import sqlmodel at runtime | Move DB logic to L6 driver | 37 |
| `killswitch_read_driver.py` | L5_other | `from app.models.killswitch import DefaultGuardrail` | L5 MUST NOT import L7 models directly | Route through L6 driver | 40 |

## Logs (4 violations)

| File | Layer | Import | Rule | Fix | Line |
|------|-------|--------|------|-----|------|
| `export_bundle_adapter.py` | L3_adapters | `from app.models.export_bundles import DEFAULT_SOC2` | L3 MUST NOT import L7 models | Use L5 schemas for data contracts | 49 |
| `audit_ledger_service.py` | L5_engines | `from app.models.audit_ledger import ActorType, Aud` | L5 MUST NOT import L7 models directly | Route through L6 driver | 41 |
| `pdf_renderer.py` | L5_engines | `from app.models.export_bundles import EvidenceBund` | L5 MUST NOT import L7 models directly | Route through L6 driver | 54 |
| `audit_engine.py` | L5_other | `from app.models.contract import AuditVerdict` | L5 MUST NOT import L7 models directly | Route through L6 driver | 64 |

## Analytics (7 violations)

| File | Layer | Import | Rule | Fix | Line |
|------|-------|--------|------|-----|------|
| `coordinator.py` | L5_engines | `from sqlmodel import Session` | L5 MUST NOT import sqlmodel at runtime | Move DB logic to L6 driver | 47 |
| `cost_anomaly_detector.py` | L5_engines | `from sqlmodel import Session, select` | L5 MUST NOT import sqlmodel at runtime | Move DB logic to L6 driver | 46 |
| `cost_anomaly_detector.py` | L5_engines | `from app.db import CostAnomaly, CostBudget, utc_no` | L5 MUST NOT access DB directly | Use L6 driver for DB access | 48 |
| `cost_snapshots.py` | L5_engines | `from sqlalchemy.ext.asyncio import AsyncSession` | L5 MUST NOT import sqlalchemy | Move DB logic to L6 driver | 55 |
| `pattern_detection.py` | L5_engines | `from app.db import get_async_session` | L5 MUST NOT access DB directly | Use L6 driver for DB access | 55 |
| `pattern_detection.py` | L5_engines | `from app.models.feedback import PatternFeedbackCre` | L5 MUST NOT import L7 models directly | Route through L6 driver | 56 |
| `prediction.py` | L5_engines | `from app.db import get_async_session` | L5 MUST NOT access DB directly | Use L6 driver for DB access | 66 |

## Integrations (6 violations)

| File | Layer | Import | Rule | Fix | Line |
|------|-------|--------|------|-----|------|
| `cus_telemetry.py` | L2_api | `from app.hoc.cus.activity.L5_engines.cus_telemetry` | L2 MUST NOT import L5 directly | Route through L3 adapter | 47 |
| `customer_incidents_adapter.py` | L3_adapters | `from sqlmodel import Session` | L3 MUST NOT access DB | Delegate to L5 engine or L6 driver | 39 |
| `customer_keys_adapter.py` | L3_adapters | `from sqlmodel import Session` | L3 MUST NOT access DB | Delegate to L5 engine or L6 driver | 38 |
| `cus_health_engine.py` | L5_engines | `from sqlmodel import Session, select` | L5 MUST NOT import sqlmodel at runtime | Move DB logic to L6 driver | 60 |
| `cus_health_engine.py` | L5_engines | `from app.db import get_engine` | L5 MUST NOT access DB directly | Use L6 driver for DB access | 62 |
| `cus_health_engine.py` | L5_engines | `from app.models.cus_models import CusHealthState, ` | L5 MUST NOT import L7 models directly | Route through L6 driver | 63 |

## Apis (0 violations)

No violations.

## Account (1 violations)

| File | Layer | Import | Rule | Fix | Line |
|------|-------|--------|------|-----|------|
| `tenant_engine.py` | L5_engines | `from app.models.tenant import PLAN_QUOTAS, APIKey,` | L5 MUST NOT import L7 models directly | Route through L6 driver | 52 |
