[
  {
    "file_path": "backend/app/hoc/cus/general/L5_engines/alert_worker.py",
    "file_name": "alert_worker.py",
    "domain": "general",
    "layer": "L5_engines",
    "import_statement": "from app.db_async import AsyncSessionLocal, async_session_context",
    "rule_broken": "L5 MUST NOT access DB directly",
    "required_fix": "Use L6 driver for DB access",
    "line": 99
  },
  {
    "file_path": "backend/app/hoc/cus/general/L5_engines/knowledge_lifecycle_manager.py",
    "file_name": "knowledge_lifecycle_manager.py",
    "domain": "general",
    "layer": "L5_engines",
    "import_statement": "from app.models.knowledge_lifecycle import KnowledgePlaneLifecycleState, LifecycleAction, TransitionResult, is_valid_transition, validate_transition, get_action_for_transition, get_transition_for_action, get_next_onboarding_state, get_next_offboarding_state",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 54
  },
  {
    "file_path": "backend/app/hoc/cus/general/L5_engines/knowledge_sdk.py",
    "file_name": "knowledge_sdk.py",
    "domain": "general",
    "layer": "L5_engines",
    "import_statement": "from app.models.knowledge_lifecycle import KnowledgePlaneLifecycleState, LifecycleAction",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 58
  },
  {
    "file_path": "backend/app/hoc/cus/general/L5_engines/lifecycle_stages_base.py",
    "file_name": "lifecycle_stages_base.py",
    "domain": "general",
    "layer": "L5_engines",
    "import_statement": "from app.models.knowledge_lifecycle import KnowledgePlaneLifecycleState",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 44
  },
  {
    "file_path": "backend/app/hoc/cus/general/L5_controls/drivers/guard_write_driver.py",
    "file_name": "guard_write_driver.py",
    "domain": "general",
    "layer": "L5_other",
    "import_statement": "from sqlalchemy import and_, select",
    "rule_broken": "L5 MUST NOT import sqlalchemy",
    "required_fix": "Move DB logic to L6 driver",
    "line": 51
  },
  {
    "file_path": "backend/app/hoc/cus/general/L5_controls/drivers/guard_write_driver.py",
    "file_name": "guard_write_driver.py",
    "domain": "general",
    "layer": "L5_other",
    "import_statement": "from sqlmodel import Session",
    "rule_broken": "L5 MUST NOT import sqlmodel at runtime",
    "required_fix": "Move DB logic to L6 driver",
    "line": 52
  },
  {
    "file_path": "backend/app/hoc/cus/general/L5_controls/drivers/guard_write_driver.py",
    "file_name": "guard_write_driver.py",
    "domain": "general",
    "layer": "L5_other",
    "import_statement": "from app.models.killswitch import Incident, IncidentEvent, IncidentSeverity, IncidentStatus, KillSwitchState, TriggerType",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 55
  },
  {
    "file_path": "backend/app/hoc/cus/general/L5_lifecycle/engines/offboarding.py",
    "file_name": "offboarding.py",
    "domain": "general",
    "layer": "L5_other",
    "import_statement": "from app.models.knowledge_lifecycle import KnowledgePlaneLifecycleState",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 50
  },
  {
    "file_path": "backend/app/hoc/cus/general/L5_lifecycle/engines/onboarding.py",
    "file_name": "onboarding.py",
    "domain": "general",
    "layer": "L5_other",
    "import_statement": "from app.models.knowledge_lifecycle import KnowledgePlaneLifecycleState",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 45
  },
  {
    "file_path": "backend/app/hoc/cus/general/L5_support/CRM/engines/job_executor.py",
    "file_name": "job_executor.py",
    "domain": "general",
    "layer": "L5_other",
    "import_statement": "from app.models.governance_job import JobStatus, JobStep, StepResult, StepStatus",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 63
  },
  {
    "file_path": "backend/app/hoc/cus/general/L5_workflow/contracts/engines/contract_engine.py",
    "file_name": "contract_engine.py",
    "domain": "general",
    "layer": "L5_other",
    "import_statement": "from app.models.contract import TERMINAL_STATES, VALID_TRANSITIONS, AuditVerdict, ContractApproval, ContractImmutableError, ContractSource, ContractStatus, EligibilityVerdictData, InvalidTransitionError, MayNotVerdictError, RiskLevel, TransitionRecord, ValidatorVerdictData",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 82
  },
  {
    "file_path": "backend/app/hoc/api/cus/overview/overview.py",
    "file_name": "overview.py",
    "domain": "overview",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.overview.L5_engines.overview_facade import get_overview_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 51
  },
  {
    "file_path": "backend/app/hoc/api/cus/activity/activity.py",
    "file_name": "activity.py",
    "domain": "activity",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.activity.L5_engines.activity_facade import get_activity_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 68
  },
  {
    "file_path": "backend/app/hoc/api/cus/incidents/incidents.py",
    "file_name": "incidents.py",
    "domain": "incidents",
    "layer": "L2_api",
    "import_statement": "from app.models.killswitch import Incident",
    "rule_broken": "L2 MUST NOT import L7 models",
    "required_fix": "Use L5 schemas or response models",
    "line": 54
  },
  {
    "file_path": "backend/app/hoc/api/cus/incidents/incidents.py",
    "file_name": "incidents.py",
    "domain": "incidents",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.incidents.L5_engines.incidents_facade import get_incidents_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 57
  },
  {
    "file_path": "backend/app/hoc/cus/incidents/L5_engines/incident_severity_engine.py",
    "file_name": "incident_severity_engine.py",
    "domain": "incidents",
    "layer": "L5_engines",
    "import_statement": "from app.models.killswitch import IncidentSeverity",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 39
  },
  {
    "file_path": "backend/app/hoc/cus/incidents/L5_engines/incident_write_engine.py",
    "file_name": "incident_write_engine.py",
    "domain": "incidents",
    "layer": "L5_engines",
    "import_statement": "from app.models.audit_ledger import ActorType",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 57
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/alerts.py",
    "file_name": "alerts.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.general.L5_engines.alerts_facade import AlertsFacade, get_alerts_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 46
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/analytics.py",
    "file_name": "analytics.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.analytics.L5_engines.analytics_facade import get_analytics_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 57
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/aos_accounts.py",
    "file_name": "aos_accounts.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.account.L5_engines.accounts_facade import get_accounts_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 65
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/aos_accounts.py",
    "file_name": "aos_accounts.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.models.tenant import Invitation, Subscription, SupportTicket, Tenant, TenantMembership, User, generate_uuid, utc_now",
    "rule_broken": "L2 MUST NOT import L7 models",
    "required_fix": "Use L5 schemas or response models",
    "line": 66
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/aos_api_key.py",
    "file_name": "aos_api_key.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.api_keys.L5_engines.api_keys_facade import get_api_keys_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 49
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/aos_cus_integrations.py",
    "file_name": "aos_cus_integrations.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.integrations.L5_engines.integrations_facade import get_integrations_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 69
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/compliance.py",
    "file_name": "compliance.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.general.L5_engines.compliance_facade import ComplianceFacade, get_compliance_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 40
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/connectors.py",
    "file_name": "connectors.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.integrations.L5_engines.connectors_facade import ConnectorsFacade, get_connectors_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 40
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/controls.py",
    "file_name": "controls.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.controls.L5_engines.controls_facade import ControlsFacade, get_controls_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 42
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/cus_enforcement.py",
    "file_name": "cus_enforcement.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.policies.L5_engines.cus_enforcement_service import CusEnforcementService",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 41
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/datasources.py",
    "file_name": "datasources.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.integrations.L5_engines.datasources_facade import DataSourcesFacade, get_datasources_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 43
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/detection.py",
    "file_name": "detection.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.analytics.L5_engines.detection_facade import DetectionFacade, get_detection_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 40
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/evidence.py",
    "file_name": "evidence.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.logs.L5_engines.evidence_facade import EvidenceFacade, get_evidence_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 42
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/governance.py",
    "file_name": "governance.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.policies.L5_engines.governance_facade import GovernanceFacade, GovernanceMode, get_governance_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 40
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/guard.py",
    "file_name": "guard.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.models.killswitch import DefaultGuardrail, Incident, IncidentEvent, IncidentSeverity, KillSwitchState, ProxyCall",
    "rule_broken": "L2 MUST NOT import L7 models",
    "required_fix": "Use L5 schemas or response models",
    "line": 71
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/guard.py",
    "file_name": "guard.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.models.tenant import Tenant",
    "rule_broken": "L2 MUST NOT import L7 models",
    "required_fix": "Use L5 schemas or response models",
    "line": 79
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/guard.py",
    "file_name": "guard.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.logs.L5_engines.certificate import CertificateService",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 83
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/guard.py",
    "file_name": "guard.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.logs.L5_engines.replay_determinism import DeterminismLevel, ReplayContextBuilder",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 93
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/guard.py",
    "file_name": "guard.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.logs.L5_engines.replay_determinism import ReplayValidator",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 97
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/lifecycle.py",
    "file_name": "lifecycle.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.general.L5_engines.lifecycle_facade import LifecycleFacade, get_lifecycle_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 49
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/logs.py",
    "file_name": "logs.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.logs.L5_engines.logs_facade import get_logs_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 71
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/monitors.py",
    "file_name": "monitors.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.general.L5_engines.monitors_facade import MonitorsFacade, get_monitors_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 44
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/notifications.py",
    "file_name": "notifications.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.account.L5_engines.notifications_facade import NotificationsFacade, get_notifications_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 40
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/override.py",
    "file_name": "override.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.controls.L6_drivers.override_driver import LimitNotFoundError, LimitOverrideService, LimitOverrideServiceError, OverrideNotFoundError, OverrideValidationError, StackingAbuseError",
    "rule_broken": "L2 MUST NOT import L6",
    "required_fix": "Route through L3 \u2192 L5 \u2192 L6",
    "line": 43
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/policies.py",
    "file_name": "policies.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.policies.L5_engines.policies_facade import get_policies_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 52
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/policy_layer.py",
    "file_name": "policy_layer.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.policies.L5_engines.policy_driver import get_policy_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 39
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/policy_limits_crud.py",
    "file_name": "policy_limits_crud.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.policies.L5_engines.policy_limits_engine import ImmutableFieldError, LimitNotFoundError, LimitValidationError, PolicyLimitsService, PolicyLimitsServiceError",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 45
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/policy_rules_crud.py",
    "file_name": "policy_rules_crud.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.policies.L5_engines.policy_rules_engine import PolicyRulesService, PolicyRulesServiceError, RuleNotFoundError, RuleValidationError",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 41
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/rate_limits.py",
    "file_name": "rate_limits.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.policies.L5_engines.limits_facade import LimitsFacade, get_limits_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 42
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/retrieval.py",
    "file_name": "retrieval.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.general.L5_engines.retrieval_facade import RetrievalFacade, get_retrieval_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 42
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/scheduler.py",
    "file_name": "scheduler.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.general.L5_engines.scheduler_facade import SchedulerFacade, get_scheduler_facade",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 44
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/simulate.py",
    "file_name": "simulate.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.policies.L5_engines.limits_simulation_service import LimitsSimulationService, LimitsSimulationServiceError, TenantNotFoundError",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 42
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/workers.py",
    "file_name": "workers.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.models.tenant import WorkerRun",
    "rule_broken": "L2 MUST NOT import L7 models",
    "required_fix": "Use L5 schemas or response models",
    "line": 59
  },
  {
    "file_path": "backend/app/hoc/api/cus/policies/workers.py",
    "file_name": "workers.py",
    "domain": "policies",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.general.L6_drivers.worker_write_service_async import WorkerWriteServiceAsync",
    "rule_broken": "L2 MUST NOT import L6",
    "required_fix": "Route through L3 \u2192 L5 \u2192 L6",
    "line": 63
  },
  {
    "file_path": "backend/app/hoc/cus/policies/L5_engines/engine.py",
    "file_name": "engine.py",
    "domain": "policies",
    "layer": "L5_engines",
    "import_statement": "from sqlalchemy.exc import SQLAlchemyError",
    "rule_broken": "L5 MUST NOT import sqlalchemy",
    "required_fix": "Move DB logic to L6 driver",
    "line": 102
  },
  {
    "file_path": "backend/app/hoc/cus/policies/L5_engines/keys_shim.py",
    "file_name": "keys_shim.py",
    "domain": "policies",
    "layer": "L5_engines",
    "import_statement": "from app.models.tenant import APIKey",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 49
  },
  {
    "file_path": "backend/app/hoc/cus/policies/L5_engines/policy_limits_engine.py",
    "file_name": "policy_limits_engine.py",
    "domain": "policies",
    "layer": "L5_engines",
    "import_statement": "from app.models.policy_control_plane import Limit, LimitIntegrity, LimitStatus",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 66
  },
  {
    "file_path": "backend/app/hoc/cus/policies/L5_engines/policy_limits_engine.py",
    "file_name": "policy_limits_engine.py",
    "domain": "policies",
    "layer": "L5_engines",
    "import_statement": "from app.models.audit_ledger import ActorType",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 71
  },
  {
    "file_path": "backend/app/hoc/cus/policies/L5_engines/policy_proposal_engine.py",
    "file_name": "policy_proposal_engine.py",
    "domain": "policies",
    "layer": "L5_engines",
    "import_statement": "from app.models.audit_ledger import ActorType",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 49
  },
  {
    "file_path": "backend/app/hoc/cus/policies/L5_engines/policy_proposal_engine.py",
    "file_name": "policy_proposal_engine.py",
    "domain": "policies",
    "layer": "L5_engines",
    "import_statement": "from app.models.policy import PolicyApprovalRequest, PolicyProposalCreate",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 50
  },
  {
    "file_path": "backend/app/hoc/cus/policies/L5_engines/policy_rules_engine.py",
    "file_name": "policy_rules_engine.py",
    "domain": "policies",
    "layer": "L5_engines",
    "import_statement": "from app.models.policy_control_plane import PolicyRule, PolicyRuleIntegrity, PolicyRuleStatus",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 67
  },
  {
    "file_path": "backend/app/hoc/cus/policies/L5_engines/policy_rules_engine.py",
    "file_name": "policy_rules_engine.py",
    "domain": "policies",
    "layer": "L5_engines",
    "import_statement": "from app.models.audit_ledger import ActorType",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 72
  },
  {
    "file_path": "backend/app/hoc/cus/controls/L3_adapters/customer_killswitch_adapter.py",
    "file_name": "customer_killswitch_adapter.py",
    "domain": "controls",
    "layer": "L3_adapters",
    "import_statement": "from sqlmodel import Session",
    "rule_broken": "L3 MUST NOT access DB",
    "required_fix": "Delegate to L5 engine or L6 driver",
    "line": 38
  },
  {
    "file_path": "backend/app/hoc/cus/controls/L3_adapters/customer_killswitch_adapter.py",
    "file_name": "customer_killswitch_adapter.py",
    "domain": "controls",
    "layer": "L3_adapters",
    "import_statement": "from app.models.killswitch import TriggerType",
    "rule_broken": "L3 MUST NOT import L7 models",
    "required_fix": "Use L5 schemas for data contracts",
    "line": 42
  },
  {
    "file_path": "backend/app/hoc/cus/controls/L5_controls/drivers/killswitch_read_driver.py",
    "file_name": "killswitch_read_driver.py",
    "domain": "controls",
    "layer": "L5_other",
    "import_statement": "from sqlalchemy import and_, desc, func, select",
    "rule_broken": "L5 MUST NOT import sqlalchemy",
    "required_fix": "Move DB logic to L6 driver",
    "line": 36
  },
  {
    "file_path": "backend/app/hoc/cus/controls/L5_controls/drivers/killswitch_read_driver.py",
    "file_name": "killswitch_read_driver.py",
    "domain": "controls",
    "layer": "L5_other",
    "import_statement": "from sqlmodel import Session",
    "rule_broken": "L5 MUST NOT import sqlmodel at runtime",
    "required_fix": "Move DB logic to L6 driver",
    "line": 37
  },
  {
    "file_path": "backend/app/hoc/cus/controls/L5_controls/drivers/killswitch_read_driver.py",
    "file_name": "killswitch_read_driver.py",
    "domain": "controls",
    "layer": "L5_other",
    "import_statement": "from app.models.killswitch import DefaultGuardrail, Incident, KillSwitchState",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 40
  },
  {
    "file_path": "backend/app/hoc/cus/logs/L3_adapters/export_bundle_adapter.py",
    "file_name": "export_bundle_adapter.py",
    "domain": "logs",
    "layer": "L3_adapters",
    "import_statement": "from app.models.export_bundles import DEFAULT_SOC2_CONTROLS, EvidenceBundle, ExecutiveDebriefBundle, PolicyContext, SOC2Bundle, TraceStepEvidence",
    "rule_broken": "L3 MUST NOT import L7 models",
    "required_fix": "Use L5 schemas for data contracts",
    "line": 49
  },
  {
    "file_path": "backend/app/hoc/cus/logs/L5_engines/audit_ledger_service.py",
    "file_name": "audit_ledger_service.py",
    "domain": "logs",
    "layer": "L5_engines",
    "import_statement": "from app.models.audit_ledger import ActorType, AuditEntityType, AuditEventType, AuditLedger",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 41
  },
  {
    "file_path": "backend/app/hoc/cus/logs/L5_engines/pdf_renderer.py",
    "file_name": "pdf_renderer.py",
    "domain": "logs",
    "layer": "L5_engines",
    "import_statement": "from app.models.export_bundles import EvidenceBundle, ExecutiveDebriefBundle, SOC2Bundle",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 54
  },
  {
    "file_path": "backend/app/hoc/cus/logs/L5_support/CRM/engines/audit_engine.py",
    "file_name": "audit_engine.py",
    "domain": "logs",
    "layer": "L5_other",
    "import_statement": "from app.models.contract import AuditVerdict",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 64
  },
  {
    "file_path": "backend/app/hoc/cus/analytics/L5_engines/coordinator.py",
    "file_name": "coordinator.py",
    "domain": "analytics",
    "layer": "L5_engines",
    "import_statement": "from sqlmodel import Session",
    "rule_broken": "L5 MUST NOT import sqlmodel at runtime",
    "required_fix": "Move DB logic to L6 driver",
    "line": 47
  },
  {
    "file_path": "backend/app/hoc/cus/analytics/L5_engines/cost_anomaly_detector.py",
    "file_name": "cost_anomaly_detector.py",
    "domain": "analytics",
    "layer": "L5_engines",
    "import_statement": "from sqlmodel import Session, select",
    "rule_broken": "L5 MUST NOT import sqlmodel at runtime",
    "required_fix": "Move DB logic to L6 driver",
    "line": 46
  },
  {
    "file_path": "backend/app/hoc/cus/analytics/L5_engines/cost_anomaly_detector.py",
    "file_name": "cost_anomaly_detector.py",
    "domain": "analytics",
    "layer": "L5_engines",
    "import_statement": "from app.db import CostAnomaly, CostBudget, utc_now",
    "rule_broken": "L5 MUST NOT access DB directly",
    "required_fix": "Use L6 driver for DB access",
    "line": 48
  },
  {
    "file_path": "backend/app/hoc/cus/analytics/L5_engines/cost_snapshots.py",
    "file_name": "cost_snapshots.py",
    "domain": "analytics",
    "layer": "L5_engines",
    "import_statement": "from sqlalchemy.ext.asyncio import AsyncSession",
    "rule_broken": "L5 MUST NOT import sqlalchemy",
    "required_fix": "Move DB logic to L6 driver",
    "line": 55
  },
  {
    "file_path": "backend/app/hoc/cus/analytics/L5_engines/pattern_detection.py",
    "file_name": "pattern_detection.py",
    "domain": "analytics",
    "layer": "L5_engines",
    "import_statement": "from app.db import get_async_session",
    "rule_broken": "L5 MUST NOT access DB directly",
    "required_fix": "Use L6 driver for DB access",
    "line": 55
  },
  {
    "file_path": "backend/app/hoc/cus/analytics/L5_engines/pattern_detection.py",
    "file_name": "pattern_detection.py",
    "domain": "analytics",
    "layer": "L5_engines",
    "import_statement": "from app.models.feedback import PatternFeedbackCreate",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 56
  },
  {
    "file_path": "backend/app/hoc/cus/analytics/L5_engines/prediction.py",
    "file_name": "prediction.py",
    "domain": "analytics",
    "layer": "L5_engines",
    "import_statement": "from app.db import get_async_session",
    "rule_broken": "L5 MUST NOT access DB directly",
    "required_fix": "Use L6 driver for DB access",
    "line": 66
  },
  {
    "file_path": "backend/app/hoc/api/cus/integrations/cus_telemetry.py",
    "file_name": "cus_telemetry.py",
    "domain": "integrations",
    "layer": "L2_api",
    "import_statement": "from app.hoc.cus.activity.L5_engines.cus_telemetry_service import CusTelemetryService",
    "rule_broken": "L2 MUST NOT import L5 directly",
    "required_fix": "Route through L3 adapter",
    "line": 47
  },
  {
    "file_path": "backend/app/hoc/cus/integrations/L3_adapters/customer_incidents_adapter.py",
    "file_name": "customer_incidents_adapter.py",
    "domain": "integrations",
    "layer": "L3_adapters",
    "import_statement": "from sqlmodel import Session",
    "rule_broken": "L3 MUST NOT access DB",
    "required_fix": "Delegate to L5 engine or L6 driver",
    "line": 39
  },
  {
    "file_path": "backend/app/hoc/cus/integrations/L3_adapters/customer_keys_adapter.py",
    "file_name": "customer_keys_adapter.py",
    "domain": "integrations",
    "layer": "L3_adapters",
    "import_statement": "from sqlmodel import Session",
    "rule_broken": "L3 MUST NOT access DB",
    "required_fix": "Delegate to L5 engine or L6 driver",
    "line": 38
  },
  {
    "file_path": "backend/app/hoc/cus/integrations/L5_engines/cus_health_engine.py",
    "file_name": "cus_health_engine.py",
    "domain": "integrations",
    "layer": "L5_engines",
    "import_statement": "from sqlmodel import Session, select",
    "rule_broken": "L5 MUST NOT import sqlmodel at runtime",
    "required_fix": "Move DB logic to L6 driver",
    "line": 60
  },
  {
    "file_path": "backend/app/hoc/cus/integrations/L5_engines/cus_health_engine.py",
    "file_name": "cus_health_engine.py",
    "domain": "integrations",
    "layer": "L5_engines",
    "import_statement": "from app.db import get_engine",
    "rule_broken": "L5 MUST NOT access DB directly",
    "required_fix": "Use L6 driver for DB access",
    "line": 62
  },
  {
    "file_path": "backend/app/hoc/cus/integrations/L5_engines/cus_health_engine.py",
    "file_name": "cus_health_engine.py",
    "domain": "integrations",
    "layer": "L5_engines",
    "import_statement": "from app.models.cus_models import CusHealthState, CusIntegration",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 63
  },
  {
    "file_path": "backend/app/hoc/cus/account/L5_engines/tenant_engine.py",
    "file_name": "tenant_engine.py",
    "domain": "account",
    "layer": "L5_engines",
    "import_statement": "from app.models.tenant import PLAN_QUOTAS, APIKey, Tenant, TenantMembership, WorkerRun",
    "rule_broken": "L5 MUST NOT import L7 models directly",
    "required_fix": "Route through L6 driver",
    "line": 52
  }
]