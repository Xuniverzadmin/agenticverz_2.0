openapi: 3.1.0
info:
  title: NOVA Agent Manager
  description: AOS MVA - Agent Manager + Planner with async execution
  version: 0.2.0
paths:
  /health:
    get:
      summary: Health Check
      description: Health check with DB validation.
      operationId: health_check_health_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
  /health/ready:
    get:
      tags:
      - health
      summary: Readiness Check
      description: 'Kubernetes readiness probe.


        Checks:

        - Database connectivity

        - Redis connectivity

        - Essential services'
      operationId: readiness_check_health_ready_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: object
                title: Response Readiness Check Health Ready Get
  /health/determinism:
    get:
      tags:
      - health
      summary: Determinism Status
      description: 'Determinism status endpoint.


        Shows:

        - Last replay hash

        - Replay count

        - Drift detection status


        Used for operational monitoring and debugging.'
      operationId: determinism_status_health_determinism_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: object
                title: Response Determinism Status Health Determinism Get
  /health/adapters:
    get:
      tags:
      - health
      summary: Adapter Status
      description: 'LLM adapter availability status.


        Shows registered adapters and their health.'
      operationId: adapter_status_health_adapters_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: object
                title: Response Adapter Status Health Adapters Get
  /health/skills:
    get:
      tags:
      - health
      summary: Skills Status
      description: 'Skill registry status.


        Shows registered skills and their versions.'
      operationId: skills_status_health_skills_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: object
                title: Response Skills Status Health Skills Get
  /api/v1/policy/eval:
    post:
      tags:
      - policy
      summary: Evaluate Policy
      description: Sandbox evaluation of policy for a skill execution.
      operationId: evaluate_policy_api_v1_policy_eval_post
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PolicyEvalRequest'
        required: true
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicyEvalResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/policy/requests:
    post:
      tags:
      - policy
      summary: Create Approval Request
      description: Create a new approval request (persisted to DB).
      operationId: create_approval_request_api_v1_policy_requests_post
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApprovalRequestCreate'
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApprovalRequestResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
    get:
      tags:
      - policy
      summary: List Approval Requests
      description: List approval requests with optional filtering.
      operationId: list_approval_requests_api_v1_policy_requests_get
      parameters:
      - name: status
        in: query
        required: false
        schema:
          anyOf:
          - $ref: '#/components/schemas/ApprovalStatus'
          - type: 'null'
          title: Status
      - name: tenant_id
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          title: Tenant Id
      - name: limit
        in: query
        required: false
        schema:
          type: integer
          default: 50
          title: Limit
      - name: offset
        in: query
        required: false
        schema:
          type: integer
          default: 0
          title: Offset
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ApprovalStatusResponse'
                title: Response List Approval Requests Api V1 Policy Requests Get
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/policy/requests/{request_id}:
    get:
      tags:
      - policy
      summary: Get Approval Request
      description: Get the current status of an approval request.
      operationId: get_approval_request_api_v1_policy_requests__request_id__get
      parameters:
      - name: request_id
        in: path
        required: true
        schema:
          type: string
          title: Request Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApprovalStatusResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/policy/requests/{request_id}/approve:
    post:
      tags:
      - policy
      summary: Approve Request
      description: Approve an approval request.
      operationId: approve_request_api_v1_policy_requests__request_id__approve_post
      parameters:
      - name: request_id
        in: path
        required: true
        schema:
          type: string
          title: Request Id
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApprovalAction'
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApprovalStatusResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/policy/requests/{request_id}/reject:
    post:
      tags:
      - policy
      summary: Reject Request
      description: Reject an approval request.
      operationId: reject_request_api_v1_policy_requests__request_id__reject_post
      parameters:
      - name: request_id
        in: path
        required: true
        schema:
          type: string
          title: Request Id
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApprovalAction'
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApprovalStatusResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/runtime/simulate:
    post:
      tags:
      - runtime
      summary: Simulate Plan
      description: "Simulate a plan before execution.\n\nReturns cost estimates, latency\
        \ estimates, risk assessment, and feasibility check.\nThis allows agents to\
        \ evaluate plans before committing resources.\n\nExample:\n```json\n{\n  \"\
        plan\": [\n    {\"skill\": \"http_call\", \"params\": {\"url\": \"https://api.example.com/data\"\
        }},\n    {\"skill\": \"llm_invoke\", \"params\": {\"prompt\": \"Summarize\
        \ this data\"}}\n  ],\n  \"budget_cents\": 100\n}\n```"
      operationId: simulate_plan_api_v1_runtime_simulate_post
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/app__api__runtime__SimulateRequest'
        required: true
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SimulateResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/runtime/query:
    post:
      tags:
      - runtime
      summary: Query Runtime
      description: "Query runtime state.\n\nSupported query types:\n- remaining_budget_cents:\
        \ Current budget status\n- what_did_i_try_already: Previous execution attempts\n\
        - allowed_skills: List of available skills\n- last_step_outcome: Most recent\
        \ execution result\n- skills_available_for_goal: Skills matching a goal\n\n\
        Example:\n```json\n{\n  \"query_type\": \"remaining_budget_cents\",\n  \"\
        params\": {}\n}\n```"
      operationId: query_runtime_api_v1_runtime_query_post
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryRequest'
        required: true
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueryResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/runtime/skills:
    get:
      tags:
      - runtime
      summary: List Available Skills
      description: 'List all available skills.


        Returns skill IDs and basic descriptors for each skill.'
      operationId: list_available_skills_api_v1_runtime_skills_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SkillListResponse'
  /api/v1/runtime/skills/{skill_id}:
    get:
      tags:
      - runtime
      summary: Describe Skill
      description: 'Get detailed descriptor for a skill.


        Returns full metadata including:

        - Input/output schemas

        - Cost model

        - Failure modes with recovery hints

        - Constraints

        - Composition hints (what skills often precede/follow)'
      operationId: describe_skill_api_v1_runtime_skills__skill_id__get
      parameters:
      - name: skill_id
        in: path
        required: true
        schema:
          type: string
          title: Skill Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SkillDescriptorResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/runtime/capabilities:
    get:
      tags:
      - runtime
      summary: Get Capabilities
      description: 'Get available capabilities for an agent/tenant.


        Returns:

        - Available skills with their current status

        - Budget information

        - Rate limit information

        - Permissions


        This allows agents to know exactly what they can do before attempting.'
      operationId: get_capabilities_api_v1_runtime_capabilities_get
      parameters:
      - name: agent_id
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Agent ID
          title: Agent Id
        description: Agent ID
      - name: tenant_id
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Tenant ID
          title: Tenant Id
        description: Tenant ID
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CapabilitiesResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/runtime/resource-contract/{resource_id}:
    get:
      tags:
      - runtime
      summary: Get Resource Contract
      description: 'Get resource contract for a specific resource.


        Returns budget, rate limits, and concurrency constraints.'
      operationId: get_resource_contract_api_v1_runtime_resource_contract__resource_id__get
      parameters:
      - name: resource_id
        in: path
        required: true
        schema:
          type: string
          title: Resource Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/runtime/replay/{run_id}:
    post:
      tags:
      - runtime
      summary: Replay Run
      description: "Replay a stored plan and optionally verify determinism parity.\n\
        \nM6 Deliverable: Re-execute stored plans without re-planning.\n\nParity verification\
        \ checks:\n- Same skill calls in same order\n- Same parameters to each skill\n\
        - Same retry decisions\n- Same error classifications\n\nDoes NOT verify:\n\
        - External API responses (vary between runs)\n- LLM output content (non-deterministic)\n\
        - Timestamps (always different)\n- Execution duration (timing varies)\n\n\
        Args:\n    run_id: The original run ID to replay\n    request: Replay options\n\
        \nReturns:\n    ReplayResponse with parity check result"
      operationId: replay_run_api_v1_runtime_replay__run_id__post
      parameters:
      - name: run_id
        in: path
        required: true
        schema:
          type: string
          title: Run Id
      requestBody:
        content:
          application/json:
            schema:
              allOf:
              - $ref: '#/components/schemas/ReplayRequest'
              default:
                verify_parity: true
                dry_run: false
                timeout_seconds: 300.0
              title: Request
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReplayResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/runtime/traces:
    get:
      tags:
      - runtime
      summary: List Traces
      description: "List stored traces for a tenant.\n\nM6 Deliverable: Access to\
        \ execution traces for debugging and replay.\n\nArgs:\n    tenant_id: Filter\
        \ by tenant (optional)\n    limit: Maximum traces to return\n    offset: Pagination\
        \ offset\n\nReturns:\n    List of trace summaries"
      operationId: list_traces_api_v1_runtime_traces_get
      parameters:
      - name: tenant_id
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Filter by tenant
          title: Tenant Id
        description: Filter by tenant
      - name: limit
        in: query
        required: false
        schema:
          type: integer
          maximum: 1000
          minimum: 1
          description: Max traces to return
          default: 100
          title: Limit
        description: Max traces to return
      - name: offset
        in: query
        required: false
        schema:
          type: integer
          minimum: 0
          description: Pagination offset
          default: 0
          title: Offset
        description: Pagination offset
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/runtime/traces/{run_id}:
    get:
      tags:
      - runtime
      summary: Get Trace
      description: "Get a specific trace by run ID.\n\nM6 Deliverable: Access to full\
        \ execution trace for debugging.\n\nArgs:\n    run_id: The run ID to retrieve\n\
        \nReturns:\n    Full trace record with all steps"
      operationId: get_trace_api_v1_runtime_traces__run_id__get
      parameters:
      - name: run_id
        in: path
        required: true
        schema:
          type: string
          title: Run Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /status_history:
    get:
      tags:
      - status_history
      summary: Query Status History
      description: 'Query status history with filters.


        Supports filtering by:

        - entity_type: run, agent, approval, workflow, costsim

        - entity_id: Specific entity ID

        - tenant_id: Tenant scope (required in production)

        - actor_type: system, user, agent, scheduler

        - new_status: Target status

        - start_time/end_time: Time range'
      operationId: query_status_history_status_history_get
      parameters:
      - name: entity_type
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Filter by entity type
          title: Entity Type
        description: Filter by entity type
      - name: entity_id
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Filter by entity ID
          title: Entity Id
        description: Filter by entity ID
      - name: tenant_id
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Filter by tenant
          title: Tenant Id
        description: Filter by tenant
      - name: actor_type
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Filter by actor type
          title: Actor Type
        description: Filter by actor type
      - name: new_status
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Filter by new status
          title: New Status
        description: Filter by new status
      - name: start_time
        in: query
        required: false
        schema:
          anyOf:
          - type: string
            format: date-time
          - type: 'null'
          description: Filter from this time
          title: Start Time
        description: Filter from this time
      - name: end_time
        in: query
        required: false
        schema:
          anyOf:
          - type: string
            format: date-time
          - type: 'null'
          description: Filter until this time
          title: End Time
        description: Filter until this time
      - name: limit
        in: query
        required: false
        schema:
          type: integer
          maximum: 1000
          minimum: 1
          description: Max results
          default: 100
          title: Limit
        description: Max results
      - name: offset
        in: query
        required: false
        schema:
          type: integer
          minimum: 0
          description: Offset for pagination
          default: 0
          title: Offset
        description: Offset for pagination
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusHistoryListResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /status_history/entity/{entity_type}/{entity_id}:
    get:
      tags:
      - status_history
      summary: Get Entity History
      description: 'Get complete status history for a specific entity.


        Returns all status transitions in chronological order.'
      operationId: get_entity_history_status_history_entity__entity_type___entity_id__get
      parameters:
      - name: entity_type
        in: path
        required: true
        schema:
          type: string
          title: Entity Type
      - name: entity_id
        in: path
        required: true
        schema:
          type: string
          title: Entity Id
      - name: limit
        in: query
        required: false
        schema:
          type: integer
          maximum: 1000
          minimum: 1
          default: 100
          title: Limit
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusHistoryListResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /status_history/export:
    post:
      tags:
      - status_history
      summary: Create Export
      description: 'Create an export of status history records.


        Returns a signed URL for download that expires in 1 hour.


        Supported formats:

        - csv: Comma-separated values

        - jsonl: JSON Lines (one JSON object per line)'
      operationId: create_export_status_history_export_post
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExportRequest'
        required: true
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExportResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /status_history/download/{export_id}:
    get:
      tags:
      - status_history
      summary: Download Export
      description: 'Download an exported file using signed URL.


        This endpoint verifies the signature and expiration before

        returning the file contents.'
      operationId: download_export_status_history_download__export_id__get
      parameters:
      - name: export_id
        in: path
        required: true
        schema:
          type: string
          title: Export Id
      - name: format
        in: query
        required: true
        schema:
          type: string
          description: Export format
          title: Format
        description: Export format
      - name: expires
        in: query
        required: true
        schema:
          type: integer
          description: Expiration timestamp
          title: Expires
        description: Expiration timestamp
      - name: sig
        in: query
        required: true
        schema:
          type: string
          description: Signature
          title: Sig
        description: Signature
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /status_history/stats:
    get:
      tags:
      - status_history
      summary: Get Stats
      description: 'Get statistics about status history records.


        Useful for audit reporting and monitoring.'
      operationId: get_stats_status_history_stats_get
      parameters:
      - name: tenant_id
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Filter by tenant
          title: Tenant Id
        description: Filter by tenant
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatsResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /costsim/v2/status:
    get:
      tags:
      - costsim
      summary: Get Sandbox Status
      description: 'Get current V2 sandbox status.


        Returns information about:

        - Whether sandbox is enabled (feature flag)

        - Whether circuit breaker is open (auto-disabled due to drift)

        - Current model version

        - Drift thresholds'
      operationId: get_sandbox_status_costsim_v2_status_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SandboxStatusResponse'
  /costsim/v2/simulate:
    post:
      tags:
      - costsim
      summary: Simulate V2
      description: 'Run simulation through V2 sandbox.


        This endpoint always runs V1 for production results.

        If sandbox is enabled, also runs V2 in shadow mode

        and returns comparison metrics.


        The V1 result is always the authoritative result.

        V2 is for validation only.


        M7 Enhancements:

        - Memory context injection for simulations

        - Post-execution memory updates via rules engine

        - Drift detection between baseline and memory-enabled runs'
      operationId: simulate_v2_costsim_v2_simulate_post
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/app__api__costsim__SimulateRequest'
        required: true
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SandboxSimulateResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /costsim/v2/reset:
    post:
      tags:
      - costsim
      summary: Reset Circuit Breaker
      description: 'Reset the V2 circuit breaker.


        This re-enables V2 sandbox after it was auto-disabled due to drift.

        Should only be called after investigating and fixing the drift cause.


        Returns success status and updated circuit breaker state.'
      operationId: reset_circuit_breaker_costsim_v2_reset_post
      parameters:
      - name: reason
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Reason for reset
          title: Reason
        description: Reason for reset
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /costsim/v2/incidents:
    get:
      tags:
      - costsim
      summary: Get Incidents
      description: 'Get circuit breaker incidents.


        Returns recent incidents that caused circuit breaker trips.

        Useful for investigating drift causes.'
      operationId: get_incidents_costsim_v2_incidents_get
      parameters:
      - name: include_resolved
        in: query
        required: false
        schema:
          type: boolean
          description: Include resolved incidents
          default: false
          title: Include Resolved
        description: Include resolved incidents
      - name: limit
        in: query
        required: false
        schema:
          type: integer
          maximum: 100
          minimum: 1
          description: Max incidents to return
          default: 10
          title: Limit
        description: Max incidents to return
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /costsim/divergence:
    get:
      tags:
      - costsim
      summary: Get Divergence Report
      description: 'Get cost divergence report between V1 and V2.


        Returns metrics:

        - delta_p50: Median cost delta

        - delta_p90: 90th percentile cost delta

        - kl_divergence: KL divergence between distributions

        - outlier_count: Number of outlier samples

        - fail_ratio: Ratio of major drift samples

        - matching_rate: Ratio of matching samples'
      operationId: get_divergence_report_costsim_divergence_get
      parameters:
      - name: start_date
        in: query
        required: false
        schema:
          anyOf:
          - type: string
            format: date-time
          - type: 'null'
          description: Start of analysis period
          title: Start Date
        description: Start of analysis period
      - name: end_date
        in: query
        required: false
        schema:
          anyOf:
          - type: string
            format: date-time
          - type: 'null'
          description: End of analysis period
          title: End Date
        description: End of analysis period
      - name: tenant_id
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Filter by tenant
          title: Tenant Id
        description: Filter by tenant
      - name: days
        in: query
        required: false
        schema:
          type: integer
          maximum: 90
          minimum: 1
          description: Days to analyze (if start_date not provided)
          default: 7
          title: Days
        description: Days to analyze (if start_date not provided)
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DivergenceReportResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /costsim/canary/run:
    post:
      tags:
      - costsim
      summary: Trigger Canary Run
      description: 'Trigger a canary run on-demand.


        The canary run:

        1. Loads samples from recent provenance logs

        2. Runs both V1 and V2 on each sample

        3. Computes drift metrics

        4. Returns pass/fail verdict


        Note: Daily canary runs are automatic via systemd timer.

        This endpoint is for manual testing.'
      operationId: trigger_canary_run_costsim_canary_run_post
      parameters:
      - name: sample_count
        in: query
        required: false
        schema:
          type: integer
          maximum: 1000
          minimum: 10
          description: Number of samples
          default: 100
          title: Sample Count
        description: Number of samples
      - name: drift_threshold
        in: query
        required: false
        schema:
          type: number
          maximum: 1.0
          minimum: 0.0
          description: Drift threshold
          default: 0.2
          title: Drift Threshold
        description: Drift threshold
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CanaryRunResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /costsim/canary/reports:
    get:
      tags:
      - costsim
      summary: Get Canary Reports
      description: 'Get recent canary run reports.


        Returns summaries of recent canary runs.

        Full artifacts are available at the artifact_paths.'
      operationId: get_canary_reports_costsim_canary_reports_get
      parameters:
      - name: limit
        in: query
        required: false
        schema:
          type: integer
          maximum: 100
          minimum: 1
          description: Max reports to return
          default: 10
          title: Limit
        description: Max reports to return
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /costsim/datasets:
    get:
      tags:
      - costsim
      summary: List Datasets
      description: 'List all available reference datasets.


        Reference datasets are used to validate V2 accuracy:

        - low_variance: Simple, predictable plans

        - high_variance: Complex, variable plans

        - mixed_city: Real-world mixed workloads

        - noise_injected: Edge cases and invalid inputs

        - historical: Real production patterns'
      operationId: list_datasets_costsim_datasets_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/DatasetInfo'
                type: array
                title: Response List Datasets Costsim Datasets Get
  /costsim/datasets/{dataset_id}:
    get:
      tags:
      - costsim
      summary: Get Dataset Info
      description: Get information about a specific dataset.
      operationId: get_dataset_info_costsim_datasets__dataset_id__get
      parameters:
      - name: dataset_id
        in: path
        required: true
        schema:
          type: string
          title: Dataset Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /costsim/datasets/{dataset_id}/validate:
    post:
      tags:
      - costsim
      summary: Validate Against Dataset
      description: 'Validate V2 against a specific reference dataset.


        Runs V2 on all samples in the dataset and compares

        against expected values. Returns metrics and verdict.


        Verdict is "acceptable" if all metrics are within thresholds.'
      operationId: validate_against_dataset_costsim_datasets__dataset_id__validate_post
      parameters:
      - name: dataset_id
        in: path
        required: true
        schema:
          type: string
          title: Dataset Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationResultResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /costsim/datasets/validate-all:
    post:
      tags:
      - costsim
      summary: Validate All
      description: 'Validate V2 against ALL reference datasets.


        This is a comprehensive validation that runs all 5 datasets.

        Use for pre-release validation or debugging.'
      operationId: validate_all_costsim_datasets_validate_all_post
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
  /api/v1/memory/pins:
    post:
      tags:
      - memory
      summary: Create Or Upsert Pin
      description: 'Create or upsert a memory pin.


        If a pin with the same (tenant_id, key) exists, it will be updated.

        Otherwise, a new pin is created.


        Requires RBAC permission: memory_pin:write'
      operationId: create_or_upsert_pin_api_v1_memory_pins_post
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MemoryPinCreate'
      responses:
        '201':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MemoryPinResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
    get:
      tags:
      - memory
      summary: List Pins
      description: 'List memory pins for a tenant.


        Supports filtering by key prefix and pagination.


        Requires RBAC permission: memory_pin:read'
      operationId: list_pins_api_v1_memory_pins_get
      parameters:
      - name: tenant_id
        in: query
        required: false
        schema:
          type: string
          description: Tenant ID
          default: global
          title: Tenant Id
        description: Tenant ID
      - name: prefix
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Key prefix filter
          title: Prefix
        description: Key prefix filter
      - name: limit
        in: query
        required: false
        schema:
          type: integer
          maximum: 1000
          minimum: 1
          description: Max results
          default: 100
          title: Limit
        description: Max results
      - name: offset
        in: query
        required: false
        schema:
          type: integer
          minimum: 0
          description: Offset for pagination
          default: 0
          title: Offset
        description: Offset for pagination
      - name: include_expired
        in: query
        required: false
        schema:
          type: boolean
          description: Include expired pins
          default: false
          title: Include Expired
        description: Include expired pins
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MemoryPinListResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/memory/pins/{key}:
    get:
      tags:
      - memory
      summary: Get Pin
      description: 'Get a memory pin by key.


        Returns 404 if not found or expired.


        Requires RBAC permission: memory_pin:read'
      operationId: get_pin_api_v1_memory_pins__key__get
      parameters:
      - name: key
        in: path
        required: true
        schema:
          type: string
          title: Key
      - name: tenant_id
        in: query
        required: false
        schema:
          type: string
          description: Tenant ID
          default: global
          title: Tenant Id
        description: Tenant ID
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MemoryPinResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
    delete:
      tags:
      - memory
      summary: Delete Pin
      description: 'Delete a memory pin by key.


        Returns 404 if not found.


        Requires RBAC permission: memory_pin:delete'
      operationId: delete_pin_api_v1_memory_pins__key__delete
      parameters:
      - name: key
        in: path
        required: true
        schema:
          type: string
          title: Key
      - name: tenant_id
        in: query
        required: false
        schema:
          type: string
          description: Tenant ID
          default: global
          title: Tenant Id
        description: Tenant ID
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MemoryPinDeleteResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/memory/pins/cleanup:
    post:
      tags:
      - memory
      summary: Cleanup Expired Pins
      description: 'Clean up expired memory pins.


        Typically called by a cron job. Deletes all pins where expires_at < now().


        Requires RBAC permission: memory_pin:admin'
      operationId: cleanup_expired_pins_api_v1_memory_pins_cleanup_post
      parameters:
      - name: tenant_id
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Limit to specific tenant
          title: Tenant Id
        description: Limit to specific tenant
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/rbac/info:
    get:
      tags:
      - rbac
      summary: Get Policy Info
      description: 'Get current RBAC policy information.


        Returns version, hash, loaded timestamp, roles, and resources.


        Requires RBAC permission: rbac:read'
      operationId: get_policy_info_api_v1_rbac_info_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicyInfoResponse'
  /api/v1/rbac/reload:
    post:
      tags:
      - rbac
      summary: Reload Policies
      description: 'Hot-reload RBAC policies from file.


        Reloads the policy file and updates the in-memory policy matrix.

        Returns the previous and new policy hashes for verification.


        Requires RBAC permission: rbac:reload'
      operationId: reload_policies_api_v1_rbac_reload_post
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReloadResponse'
  /api/v1/rbac/matrix:
    get:
      tags:
      - rbac
      summary: Get Permission Matrix
      description: 'Get current permission matrix.


        Returns the full role->resource->actions mapping.


        Requires RBAC permission: rbac:read'
      operationId: get_permission_matrix_api_v1_rbac_matrix_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: object
                title: Response Get Permission Matrix Api V1 Rbac Matrix Get
  /api/v1/rbac/audit:
    get:
      tags:
      - rbac
      summary: Query Audit Logs
      description: 'Query RBAC audit logs.


        Supports filtering by resource, action, decision, subject, tenant, and time.


        Requires RBAC permission: rbac:read'
      operationId: query_audit_logs_api_v1_rbac_audit_get
      parameters:
      - name: resource
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Filter by resource
          title: Resource
        description: Filter by resource
      - name: action
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Filter by action
          title: Action
        description: Filter by action
      - name: allowed
        in: query
        required: false
        schema:
          anyOf:
          - type: boolean
          - type: 'null'
          description: Filter by decision
          title: Allowed
        description: Filter by decision
      - name: subject
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Filter by subject
          title: Subject
        description: Filter by subject
      - name: tenant_id
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Filter by tenant
          title: Tenant Id
        description: Filter by tenant
      - name: since
        in: query
        required: false
        schema:
          anyOf:
          - type: string
            format: date-time
          - type: 'null'
          description: Filter since timestamp
          title: Since
        description: Filter since timestamp
      - name: limit
        in: query
        required: false
        schema:
          type: integer
          maximum: 1000
          minimum: 1
          default: 100
          title: Limit
      - name: offset
        in: query
        required: false
        schema:
          type: integer
          minimum: 0
          default: 0
          title: Offset
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuditResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/rbac/audit/cleanup:
    post:
      tags:
      - rbac
      summary: Cleanup Audit Logs
      description: 'Clean up old audit logs.


        Deletes audit entries older than retention_days.


        Requires RBAC permission: rbac:reload (admin action)'
      operationId: cleanup_audit_logs_api_v1_rbac_audit_cleanup_post
      parameters:
      - name: retention_days
        in: query
        required: false
        schema:
          type: integer
          maximum: 365
          minimum: 1
          default: 90
          title: Retention Days
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /version:
    get:
      summary: Version
      description: Version info.
      operationId: version_version_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
  /healthz:
    get:
      summary: Healthz
      description: Kubernetes-style health check.
      operationId: healthz_healthz_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
  /openapi-download:
    get:
      summary: Download Openapi
      description: Download OpenAPI spec as JSON file.
      operationId: download_openapi_openapi_download_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
  /healthz/worker_pool:
    get:
      summary: Worker Pool Health
      description: Worker pool health probe endpoint.
      operationId: worker_pool_health_healthz_worker_pool_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
  /metrics:
    get:
      summary: Metrics
      description: Prometheus metrics endpoint (multiprocess-aware).
      operationId: metrics_metrics_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
  /skills:
    get:
      summary: Get Skills
      description: List all registered skills.
      operationId: get_skills_skills_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
  /agents:
    post:
      summary: Create Agent
      description: Create a new agent.
      operationId: create_agent_agents_post
      parameters:
      - name: X-AOS-Key
        in: header
        required: true
        schema:
          type: string
          title: X-Aos-Key
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAgentRequest'
      responses:
        '201':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateAgentResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /agents/{agent_id}:
    get:
      summary: Get Agent
      description: Get agent by ID.
      operationId: get_agent_agents__agent_id__get
      parameters:
      - name: agent_id
        in: path
        required: true
        schema:
          type: string
          title: Agent Id
      - name: X-AOS-Key
        in: header
        required: true
        schema:
          type: string
          title: X-Aos-Key
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /agents/{agent_id}/goals:
    post:
      summary: Post Goal
      description: 'Submit a goal to an agent.

        Returns 202 Accepted with run_id. Poll /runs/{run_id} for status.


        Includes:

        - Idempotency checking (via idempotency_key in payload)

        - Rate limiting per tenant (100 requests/min)

        - Concurrent runs limiting per agent (max 5)

        - Budget pre-check before accepting'
      operationId: post_goal_agents__agent_id__goals_post
      parameters:
      - name: agent_id
        in: path
        required: true
        schema:
          type: string
          title: Agent Id
      - name: X-AOS-Key
        in: header
        required: true
        schema:
          type: string
          title: X-Aos-Key
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoalRequest'
      responses:
        '202':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoalResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /agents/{agent_id}/runs/{run_id}:
    get:
      summary: Get Run
      description: Get run status and results.
      operationId: get_run_agents__agent_id__runs__run_id__get
      parameters:
      - name: agent_id
        in: path
        required: true
        schema:
          type: string
          title: Agent Id
      - name: run_id
        in: path
        required: true
        schema:
          type: string
          title: Run Id
      - name: X-AOS-Key
        in: header
        required: true
        schema:
          type: string
          title: X-Aos-Key
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RunResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /agents/{agent_id}/runs:
    get:
      summary: List Runs
      description: List runs for an agent.
      operationId: list_runs_agents__agent_id__runs_get
      parameters:
      - name: agent_id
        in: path
        required: true
        schema:
          type: string
          title: Agent Id
      - name: limit
        in: query
        required: false
        schema:
          type: integer
          default: 10
          title: Limit
      - name: X-AOS-Key
        in: header
        required: true
        schema:
          type: string
          title: X-Aos-Key
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RunResponse'
                title: Response List Runs Agents  Agent Id  Runs Get
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /agents/{agent_id}/recall:
    get:
      summary: Recall Memory
      description: Recall memories for an agent.
      operationId: recall_memory_agents__agent_id__recall_get
      parameters:
      - name: agent_id
        in: path
        required: true
        schema:
          type: string
          title: Agent Id
      - name: query
        in: query
        required: true
        schema:
          type: string
          title: Query
      - name: k
        in: query
        required: false
        schema:
          type: integer
          default: 5
          title: K
      - name: X-AOS-Key
        in: header
        required: true
        schema:
          type: string
          title: X-Aos-Key
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MemoryResponse'
                title: Response Recall Memory Agents  Agent Id  Recall Get
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /agents/{agent_id}/provenance:
    get:
      summary: Get Provenance
      description: Get provenance records for an agent.
      operationId: get_provenance_agents__agent_id__provenance_get
      parameters:
      - name: agent_id
        in: path
        required: true
        schema:
          type: string
          title: Agent Id
      - name: limit
        in: query
        required: false
        schema:
          type: integer
          default: 10
          title: Limit
      - name: X-AOS-Key
        in: header
        required: true
        schema:
          type: string
          title: X-Aos-Key
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProvenanceResponse'
                title: Response Get Provenance Agents  Agent Id  Provenance Get
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /agents/{agent_id}/provenance/{prov_id}:
    get:
      summary: Get Provenance By Id
      description: Get a specific provenance record.
      operationId: get_provenance_by_id_agents__agent_id__provenance__prov_id__get
      parameters:
      - name: agent_id
        in: path
        required: true
        schema:
          type: string
          title: Agent Id
      - name: prov_id
        in: path
        required: true
        schema:
          type: string
          title: Prov Id
      - name: X-AOS-Key
        in: header
        required: true
        schema:
          type: string
          title: X-Aos-Key
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProvenanceResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /admin/rerun:
    post:
      summary: Rerun Failed Run
      description: 'Re-queue a failed or completed run for retry.

        Only allows re-running runs with status: failed, succeeded, or retry.'
      operationId: rerun_failed_run_admin_rerun_post
      parameters:
      - name: X-AOS-Key
        in: header
        required: true
        schema:
          type: string
          title: X-Aos-Key
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RerunRequest'
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RerunResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /admin/failed-runs:
    get:
      summary: List Failed Runs
      description: List recent failed runs for review.
      operationId: list_failed_runs_admin_failed_runs_get
      parameters:
      - name: limit
        in: query
        required: false
        schema:
          type: integer
          default: 50
          title: Limit
      - name: X-AOS-Key
        in: header
        required: true
        schema:
          type: string
          title: X-Aos-Key
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
components:
  schemas:
    ApprovalAction:
      properties:
        approver_id:
          type: string
          title: Approver Id
          description: ID of approver
        level:
          type: integer
          maximum: 5.0
          minimum: 1.0
          title: Level
          description: Approval level (1-5)
        notes:
          anyOf:
          - type: string
          - type: 'null'
          title: Notes
          description: Optional notes
      type: object
      required:
      - approver_id
      - level
      title: ApprovalAction
      description: Action to approve or reject a request.
    ApprovalRequestCreate:
      properties:
        policy_type:
          allOf:
          - $ref: '#/components/schemas/PolicyType'
          description: Type of policy requiring approval
        skill_id:
          type: string
          title: Skill Id
          description: Skill requiring approval
        tenant_id:
          type: string
          title: Tenant Id
          description: Tenant context
        agent_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Agent Id
          description: Agent context
        payload:
          type: object
          title: Payload
          description: Execution payload
        requested_by:
          type: string
          title: Requested By
          description: Requester ID
        justification:
          anyOf:
          - type: string
          - type: 'null'
          title: Justification
          description: Why approval is needed
        webhook_url:
          anyOf:
          - type: string
          - type: 'null'
          title: Webhook Url
          description: Webhook for async callback
        webhook_secret:
          anyOf:
          - type: string
          - type: 'null'
          title: Webhook Secret
          description: Secret for webhook HMAC
        expires_in_seconds:
          type: integer
          title: Expires In Seconds
          description: Expiration time
          default: 300
      type: object
      required:
      - policy_type
      - skill_id
      - tenant_id
      - requested_by
      title: ApprovalRequestCreate
      description: Request to create an approval request.
    ApprovalRequestResponse:
      properties:
        request_id:
          type: string
          title: Request Id
        status:
          $ref: '#/components/schemas/ApprovalStatus'
        required_level:
          type: integer
          title: Required Level
        escalate_to:
          anyOf:
          - type: string
          - type: 'null'
          title: Escalate To
        expires_at:
          type: string
          title: Expires At
        created_at:
          type: string
          title: Created At
      type: object
      required:
      - request_id
      - status
      - required_level
      - escalate_to
      - expires_at
      - created_at
      title: ApprovalRequestResponse
      description: Response when creating an approval request.
    ApprovalStatus:
      type: string
      enum:
      - pending
      - approved
      - rejected
      - escalated
      - expired
      - auto_approved
      title: ApprovalStatus
      description: Status of an approval request.
    ApprovalStatusResponse:
      properties:
        request_id:
          type: string
          title: Request Id
        correlation_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Correlation Id
          description: Idempotency key for webhook deduplication
        status:
          $ref: '#/components/schemas/ApprovalStatus'
        status_history:
          items:
            type: object
          type: array
          title: Status History
          description: Audit trail of status transitions
        policy_type:
          $ref: '#/components/schemas/PolicyType'
        skill_id:
          type: string
          title: Skill Id
        tenant_id:
          type: string
          title: Tenant Id
        agent_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Agent Id
        payload:
          type: object
          title: Payload
        requested_by:
          type: string
          title: Requested By
        justification:
          anyOf:
          - type: string
          - type: 'null'
          title: Justification
        required_level:
          type: integer
          title: Required Level
        current_level:
          type: integer
          title: Current Level
        approvers:
          items:
            type: object
          type: array
          title: Approvers
        escalate_to:
          anyOf:
          - type: string
          - type: 'null'
          title: Escalate To
        webhook_attempts:
          type: integer
          title: Webhook Attempts
          description: Number of webhook delivery attempts
          default: 0
        last_webhook_status:
          anyOf:
          - type: string
          - type: 'null'
          title: Last Webhook Status
          description: Last webhook delivery status
        expires_at:
          type: string
          title: Expires At
        created_at:
          type: string
          title: Created At
        updated_at:
          type: string
          title: Updated At
      type: object
      required:
      - request_id
      - status
      - policy_type
      - skill_id
      - tenant_id
      - agent_id
      - payload
      - requested_by
      - justification
      - required_level
      - current_level
      - approvers
      - escalate_to
      - expires_at
      - created_at
      - updated_at
      title: ApprovalStatusResponse
      description: Full status of an approval request.
    AuditEntry:
      properties:
        id:
          type: integer
          title: Id
        ts:
          type: string
          format: date-time
          title: Ts
        subject:
          type: string
          title: Subject
        resource:
          type: string
          title: Resource
        action:
          type: string
          title: Action
        allowed:
          type: boolean
          title: Allowed
        reason:
          anyOf:
          - type: string
          - type: 'null'
          title: Reason
        roles:
          anyOf:
          - items:
              type: string
            type: array
          - type: 'null'
          title: Roles
        path:
          anyOf:
          - type: string
          - type: 'null'
          title: Path
        method:
          anyOf:
          - type: string
          - type: 'null'
          title: Method
        tenant_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Tenant Id
        latency_ms:
          anyOf:
          - type: number
          - type: 'null'
          title: Latency Ms
      type: object
      required:
      - id
      - ts
      - subject
      - resource
      - action
      - allowed
      - reason
      - roles
      - path
      - method
      - tenant_id
      - latency_ms
      title: AuditEntry
      description: Single audit log entry.
    AuditResponse:
      properties:
        entries:
          items:
            $ref: '#/components/schemas/AuditEntry'
          type: array
          title: Entries
        total:
          type: integer
          title: Total
        limit:
          type: integer
          title: Limit
        offset:
          type: integer
          title: Offset
      type: object
      required:
      - entries
      - total
      - limit
      - offset
      title: AuditResponse
      description: Audit log query response.
    CanaryRunResponse:
      properties:
        run_id:
          type: string
          title: Run Id
        status:
          type: string
          title: Status
        passed:
          type: boolean
          title: Passed
        total_samples:
          type: integer
          title: Total Samples
        matching_samples:
          type: integer
          title: Matching Samples
        kl_divergence:
          type: number
          title: Kl Divergence
        failure_reasons:
          items:
            type: string
          type: array
          title: Failure Reasons
        artifact_paths:
          items:
            type: string
          type: array
          title: Artifact Paths
      type: object
      required:
      - run_id
      - status
      - passed
      - total_samples
      - matching_samples
      - kl_divergence
      - failure_reasons
      - artifact_paths
      title: CanaryRunResponse
      description: Canary run response.
    CapabilitiesResponse:
      properties:
        agent_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Agent Id
        skills:
          additionalProperties:
            type: object
          type: object
          title: Skills
        budget:
          type: object
          title: Budget
        rate_limits:
          additionalProperties:
            type: object
          type: object
          title: Rate Limits
        permissions:
          items:
            type: string
          type: array
          title: Permissions
      type: object
      required:
      - agent_id
      - skills
      - budget
      - rate_limits
      - permissions
      title: CapabilitiesResponse
      description: Response with agent capabilities.
    ComparisonResponse:
      properties:
        verdict:
          type: string
          title: Verdict
        v1_cost_cents:
          type: integer
          title: V1 Cost Cents
        v2_cost_cents:
          type: integer
          title: V2 Cost Cents
        cost_delta_cents:
          type: integer
          title: Cost Delta Cents
        cost_delta_pct:
          type: number
          title: Cost Delta Pct
        drift_score:
          type: number
          title: Drift Score
        feasibility_match:
          type: boolean
          title: Feasibility Match
      type: object
      required:
      - verdict
      - v1_cost_cents
      - v2_cost_cents
      - cost_delta_cents
      - cost_delta_pct
      - drift_score
      - feasibility_match
      title: ComparisonResponse
      description: Comparison between V1 and V2.
    CreateAgentRequest:
      properties:
        name:
          type: string
          title: Name
      type: object
      required:
      - name
      title: CreateAgentRequest
    CreateAgentResponse:
      properties:
        agent_id:
          type: string
          title: Agent Id
        name:
          type: string
          title: Name
        status:
          type: string
          title: Status
        created_at:
          type: string
          title: Created At
      type: object
      required:
      - agent_id
      - name
      - status
      - created_at
      title: CreateAgentResponse
    DatasetInfo:
      properties:
        id:
          type: string
          title: Id
        name:
          type: string
          title: Name
        description:
          type: string
          title: Description
        sample_count:
          type: integer
          title: Sample Count
        thresholds:
          additionalProperties:
            type: number
          type: object
          title: Thresholds
      type: object
      required:
      - id
      - name
      - description
      - sample_count
      - thresholds
      title: DatasetInfo
      description: Dataset information.
    DivergenceReportResponse:
      properties:
        start_date:
          type: string
          format: date-time
          title: Start Date
        end_date:
          type: string
          format: date-time
          title: End Date
        version:
          type: string
          title: Version
        sample_count:
          type: integer
          title: Sample Count
        delta_p50:
          type: number
          title: Delta P50
        delta_p90:
          type: number
          title: Delta P90
        kl_divergence:
          type: number
          title: Kl Divergence
        outlier_count:
          type: integer
          title: Outlier Count
        fail_ratio:
          type: number
          title: Fail Ratio
        matching_rate:
          type: number
          title: Matching Rate
        detailed_samples:
          items:
            type: object
          type: array
          title: Detailed Samples
      type: object
      required:
      - start_date
      - end_date
      - version
      - sample_count
      - delta_p50
      - delta_p90
      - kl_divergence
      - outlier_count
      - fail_ratio
      - matching_rate
      - detailed_samples
      title: DivergenceReportResponse
      description: Divergence report response.
    ExportRequest:
      properties:
        format:
          type: string
          title: Format
          description: 'Export format: csv or jsonl'
          default: csv
        entity_type:
          anyOf:
          - type: string
          - type: 'null'
          title: Entity Type
        entity_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Entity Id
        tenant_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Tenant Id
        start_time:
          anyOf:
          - type: string
            format: date-time
          - type: 'null'
          title: Start Time
        end_time:
          anyOf:
          - type: string
            format: date-time
          - type: 'null'
          title: End Time
      type: object
      title: ExportRequest
      description: Request for status history export.
    ExportResponse:
      properties:
        export_id:
          type: string
          title: Export Id
        download_url:
          type: string
          title: Download Url
        expires_at:
          type: string
          format: date-time
          title: Expires At
        format:
          type: string
          title: Format
        record_count:
          type: integer
          title: Record Count
      type: object
      required:
      - export_id
      - download_url
      - expires_at
      - format
      - record_count
      title: ExportResponse
      description: Response with signed URL for export download.
    GoalRequest:
      properties:
        goal:
          type: string
          title: Goal
        idempotency_key:
          anyOf:
          - type: string
          - type: 'null'
          title: Idempotency Key
          description: Optional key for idempotent submissions
      type: object
      required:
      - goal
      title: GoalRequest
    GoalResponse:
      properties:
        run_id:
          type: string
          title: Run Id
        status:
          type: string
          title: Status
        message:
          type: string
          title: Message
      type: object
      required:
      - run_id
      - status
      - message
      title: GoalResponse
    HTTPValidationError:
      properties:
        detail:
          items:
            $ref: '#/components/schemas/ValidationError'
          type: array
          title: Detail
      type: object
      title: HTTPValidationError
    MemoryPinCreate:
      properties:
        tenant_id:
          type: string
          maxLength: 256
          minLength: 1
          title: Tenant Id
          description: Tenant identifier
        key:
          type: string
          maxLength: 512
          minLength: 1
          title: Key
          description: Pin key (unique per tenant)
        value:
          type: object
          title: Value
          description: Pin value (JSON object)
        source:
          type: string
          maxLength: 64
          title: Source
          description: Source of the pin (api, seed, import)
          default: api
        ttl_seconds:
          anyOf:
          - type: integer
            maximum: 31536000.0
            minimum: 0.0
          - type: 'null'
          title: Ttl Seconds
          description: TTL in seconds (max 1 year)
      type: object
      required:
      - tenant_id
      - key
      - value
      title: MemoryPinCreate
      description: Schema for creating/upserting a memory pin.
    MemoryPinDeleteResponse:
      properties:
        deleted:
          type: boolean
          title: Deleted
        key:
          type: string
          title: Key
        tenant_id:
          type: string
          title: Tenant Id
      type: object
      required:
      - deleted
      - key
      - tenant_id
      title: MemoryPinDeleteResponse
      description: Schema for delete response.
    MemoryPinListResponse:
      properties:
        pins:
          items:
            $ref: '#/components/schemas/MemoryPinResponse'
          type: array
          title: Pins
        total:
          type: integer
          title: Total
        limit:
          type: integer
          title: Limit
        offset:
          type: integer
          title: Offset
      type: object
      required:
      - pins
      - total
      - limit
      - offset
      title: MemoryPinListResponse
      description: Schema for listing memory pins.
    MemoryPinResponse:
      properties:
        id:
          type: integer
          title: Id
        tenant_id:
          type: string
          title: Tenant Id
        key:
          type: string
          title: Key
        value:
          type: object
          title: Value
        source:
          type: string
          title: Source
        created_at:
          type: string
          format: date-time
          title: Created At
        updated_at:
          type: string
          format: date-time
          title: Updated At
        ttl_seconds:
          anyOf:
          - type: integer
          - type: 'null'
          title: Ttl Seconds
        expires_at:
          anyOf:
          - type: string
            format: date-time
          - type: 'null'
          title: Expires At
      type: object
      required:
      - id
      - tenant_id
      - key
      - value
      - source
      - created_at
      - updated_at
      title: MemoryPinResponse
      description: Schema for memory pin response.
    MemoryResponse:
      properties:
        id:
          type: string
          title: Id
        text:
          type: string
          title: Text
        meta:
          anyOf:
          - type: string
          - type: 'null'
          title: Meta
        created_at:
          type: string
          title: Created At
      type: object
      required:
      - id
      - text
      - meta
      - created_at
      title: MemoryResponse
    PlanStep:
      properties:
        skill:
          type: string
          title: Skill
          description: Skill ID to execute
        params:
          type: object
          title: Params
          description: Parameters for the skill
      type: object
      required:
      - skill
      title: PlanStep
      description: A single step in a plan to simulate.
    PolicyEvalRequest:
      properties:
        skill_id:
          type: string
          title: Skill Id
          description: Skill to evaluate
        tenant_id:
          type: string
          title: Tenant Id
          description: Tenant context
        agent_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Agent Id
          description: Agent context
        payload:
          type: object
          title: Payload
          description: Skill parameters
        policy_version:
          anyOf:
          - type: string
          - type: 'null'
          title: Policy Version
          description: Specific policy version to use
        simulate_cost:
          type: boolean
          title: Simulate Cost
          description: Include cost simulation
          default: true
      type: object
      required:
      - skill_id
      - tenant_id
      title: PolicyEvalRequest
      description: Request for policy sandbox evaluation.
    PolicyEvalResponse:
      properties:
        decision:
          type: string
          title: Decision
          description: allow, deny, or requires_approval
        reasons:
          items:
            type: string
          type: array
          title: Reasons
          description: Reasons for decision
        simulated_cost_cents:
          anyOf:
          - type: integer
          - type: 'null'
          title: Simulated Cost Cents
          description: Estimated cost
        policy_version:
          type: string
          title: Policy Version
          description: Policy version used
        approval_level_required:
          anyOf:
          - type: integer
          - type: 'null'
          title: Approval Level Required
          description: Required approval level if denied
        violations:
          items:
            type: object
          type: array
          title: Violations
          description: Policy violations
        timestamp:
          type: string
          title: Timestamp
          description: Evaluation timestamp
      type: object
      required:
      - decision
      - policy_version
      - timestamp
      title: PolicyEvalResponse
      description: Response from policy sandbox evaluation.
    PolicyInfoResponse:
      properties:
        version:
          type: string
          title: Version
        hash:
          type: string
          title: Hash
        loaded_at:
          type: string
          title: Loaded At
        roles:
          items:
            type: string
          type: array
          title: Roles
        resources:
          items:
            type: string
          type: array
          title: Resources
        enforce_mode:
          type: boolean
          title: Enforce Mode
        fail_open:
          type: boolean
          title: Fail Open
      type: object
      required:
      - version
      - hash
      - loaded_at
      - roles
      - resources
      - enforce_mode
      - fail_open
      title: PolicyInfoResponse
      description: Current policy information.
    PolicyType:
      type: string
      enum:
      - cost
      - capability
      - resource
      - rate_limit
      title: PolicyType
      description: Types of policies that can be evaluated.
    ProvenanceResponse:
      properties:
        id:
          type: string
          title: Id
        run_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Run Id
        agent_id:
          type: string
          title: Agent Id
        goal:
          type: string
          title: Goal
        status:
          type: string
          title: Status
        plan:
          type: object
          title: Plan
        tool_calls:
          items:
            type: object
          type: array
          title: Tool Calls
        attempts:
          type: integer
          title: Attempts
        error_message:
          anyOf:
          - type: string
          - type: 'null'
          title: Error Message
        created_at:
          type: string
          title: Created At
        started_at:
          anyOf:
          - type: string
          - type: 'null'
          title: Started At
        completed_at:
          anyOf:
          - type: string
          - type: 'null'
          title: Completed At
        duration_ms:
          anyOf:
          - type: number
          - type: 'null'
          title: Duration Ms
      type: object
      required:
      - id
      - run_id
      - agent_id
      - goal
      - status
      - plan
      - tool_calls
      - attempts
      - error_message
      - created_at
      - started_at
      - completed_at
      - duration_ms
      title: ProvenanceResponse
    QueryRequest:
      properties:
        query_type:
          type: string
          title: Query Type
          description: Type of query to execute
        params:
          type: object
          title: Params
          description: Query-specific parameters
        agent_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Agent Id
          description: Agent ID for context
        run_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Run Id
          description: Run ID for context
      type: object
      required:
      - query_type
      title: QueryRequest
      description: Request to query runtime state.
    QueryResponse:
      properties:
        query_type:
          type: string
          title: Query Type
        result:
          type: object
          title: Result
        supported_queries:
          items:
            type: string
          type: array
          title: Supported Queries
      type: object
      required:
      - query_type
      - result
      - supported_queries
      title: QueryResponse
      description: Response from runtime query.
    ReloadResponse:
      properties:
        success:
          type: boolean
          title: Success
        message:
          type: string
          title: Message
        previous_hash:
          type: string
          title: Previous Hash
        new_hash:
          type: string
          title: New Hash
        timestamp:
          type: string
          title: Timestamp
      type: object
      required:
      - success
      - message
      - previous_hash
      - new_hash
      - timestamp
      title: ReloadResponse
      description: Policy reload response.
    ReplayRequest:
      properties:
        verify_parity:
          type: boolean
          title: Verify Parity
          description: Verify determinism parity with original
          default: true
        dry_run:
          type: boolean
          title: Dry Run
          description: Don't execute skills, just validate
          default: false
        timeout_seconds:
          type: number
          title: Timeout Seconds
          description: Maximum time for replay
          default: 300.0
      type: object
      title: ReplayRequest
      description: Request to replay a stored run.
    ReplayResponse:
      properties:
        success:
          type: boolean
          title: Success
          description: Whether replay completed successfully
        run_id:
          type: string
          title: Run Id
          description: New run ID for this replay
        original_run_id:
          type: string
          title: Original Run Id
          description: Original run that was replayed
        parity_check:
          anyOf:
          - type: object
          - type: 'null'
          title: Parity Check
          description: Parity verification result
        divergence_point:
          anyOf:
          - type: integer
          - type: 'null'
          title: Divergence Point
          description: Step where behavior diverged
        error:
          anyOf:
          - type: string
          - type: 'null'
          title: Error
          description: Error message if replay failed
      type: object
      required:
      - success
      - run_id
      - original_run_id
      title: ReplayResponse
      description: Response from replay operation.
    RerunRequest:
      properties:
        run_id:
          type: string
          title: Run Id
        reason:
          anyOf:
          - type: string
          - type: 'null'
          title: Reason
          default: manual_retry
      type: object
      required:
      - run_id
      title: RerunRequest
    RerunResponse:
      properties:
        status:
          type: string
          title: Status
        run_id:
          type: string
          title: Run Id
        original_status:
          type: string
          title: Original Status
        reason:
          type: string
          title: Reason
      type: object
      required:
      - status
      - run_id
      - original_status
      - reason
      title: RerunResponse
    RunResponse:
      properties:
        run_id:
          type: string
          title: Run Id
        agent_id:
          type: string
          title: Agent Id
        goal:
          type: string
          title: Goal
        status:
          type: string
          title: Status
        attempts:
          type: integer
          title: Attempts
        error_message:
          anyOf:
          - type: string
          - type: 'null'
          title: Error Message
        plan:
          anyOf:
          - type: object
          - type: 'null'
          title: Plan
        tool_calls:
          anyOf:
          - items:
              type: object
            type: array
          - type: 'null'
          title: Tool Calls
        created_at:
          type: string
          title: Created At
        started_at:
          anyOf:
          - type: string
          - type: 'null'
          title: Started At
        completed_at:
          anyOf:
          - type: string
          - type: 'null'
          title: Completed At
        duration_ms:
          anyOf:
          - type: number
          - type: 'null'
          title: Duration Ms
      type: object
      required:
      - run_id
      - agent_id
      - goal
      - status
      - attempts
      - error_message
      - plan
      - tool_calls
      - created_at
      - started_at
      - completed_at
      - duration_ms
      title: RunResponse
    SandboxSimulateResponse:
      properties:
        v1_feasible:
          type: boolean
          title: V1 Feasible
        v1_cost_cents:
          type: integer
          title: V1 Cost Cents
        v1_duration_ms:
          type: integer
          title: V1 Duration Ms
        v2_result:
          anyOf:
          - $ref: '#/components/schemas/V2SimulationResponse'
          - type: 'null'
        comparison:
          anyOf:
          - $ref: '#/components/schemas/ComparisonResponse'
          - type: 'null'
        sandbox_enabled:
          type: boolean
          title: Sandbox Enabled
        v2_error:
          anyOf:
          - type: string
          - type: 'null'
          title: V2 Error
        memory_context_keys:
          anyOf:
          - items:
              type: string
            type: array
          - type: 'null'
          title: Memory Context Keys
        memory_updates_applied:
          anyOf:
          - type: integer
          - type: 'null'
          title: Memory Updates Applied
        drift_detected:
          anyOf:
          - type: boolean
          - type: 'null'
          title: Drift Detected
        drift_score:
          anyOf:
          - type: number
          - type: 'null'
          title: Drift Score
      type: object
      required:
      - v1_feasible
      - v1_cost_cents
      - v1_duration_ms
      - sandbox_enabled
      title: SandboxSimulateResponse
      description: Response from sandbox simulation.
    SandboxStatusResponse:
      properties:
        sandbox_enabled:
          type: boolean
          title: Sandbox Enabled
        circuit_breaker_open:
          type: boolean
          title: Circuit Breaker Open
        disabled_by_drift:
          type: boolean
          title: Disabled By Drift
        model_version:
          type: string
          title: Model Version
        adapter_version:
          type: string
          title: Adapter Version
        drift_threshold:
          type: number
          title: Drift Threshold
      type: object
      required:
      - sandbox_enabled
      - circuit_breaker_open
      - disabled_by_drift
      - model_version
      - adapter_version
      - drift_threshold
      title: SandboxStatusResponse
      description: Status of V2 sandbox.
    SimulateResponse:
      properties:
        feasible:
          type: boolean
          title: Feasible
        status:
          type: string
          title: Status
        estimated_cost_cents:
          type: integer
          title: Estimated Cost Cents
        estimated_duration_ms:
          type: integer
          title: Estimated Duration Ms
        budget_remaining_cents:
          type: integer
          title: Budget Remaining Cents
        budget_sufficient:
          type: boolean
          title: Budget Sufficient
        permission_gaps:
          items:
            type: string
          type: array
          title: Permission Gaps
        risks:
          items:
            type: object
          type: array
          title: Risks
        step_estimates:
          items:
            type: object
          type: array
          title: Step Estimates
        alternatives:
          items:
            type: object
          type: array
          title: Alternatives
        warnings:
          items:
            type: string
          type: array
          title: Warnings
      type: object
      required:
      - feasible
      - status
      - estimated_cost_cents
      - estimated_duration_ms
      - budget_remaining_cents
      - budget_sufficient
      - permission_gaps
      - risks
      - step_estimates
      - alternatives
      - warnings
      title: SimulateResponse
      description: Response from plan simulation.
    SimulationStep:
      properties:
        skill:
          type: string
          title: Skill
          description: Skill ID
        params:
          type: object
          title: Params
          description: Skill parameters
      type: object
      required:
      - skill
      title: SimulationStep
      description: A single step in a simulation plan.
    SimulationStepResult:
      properties:
        step_index:
          type: integer
          title: Step Index
        skill_id:
          type: string
          title: Skill Id
        cost_cents:
          type: number
          title: Cost Cents
        latency_ms:
          type: number
          title: Latency Ms
        confidence:
          type: number
          title: Confidence
      type: object
      required:
      - step_index
      - skill_id
      - cost_cents
      - latency_ms
      - confidence
      title: SimulationStepResult
      description: Result for a single step.
    SkillDescriptorResponse:
      properties:
        skill_id:
          type: string
          title: Skill Id
        name:
          type: string
          title: Name
        version:
          type: string
          title: Version
        description:
          type: string
          title: Description
        inputs_schema:
          anyOf:
          - type: object
          - type: 'null'
          title: Inputs Schema
        outputs_schema:
          anyOf:
          - type: object
          - type: 'null'
          title: Outputs Schema
        cost_model:
          type: object
          title: Cost Model
        failure_modes:
          items:
            type: object
          type: array
          title: Failure Modes
        constraints:
          type: object
          title: Constraints
        composition_hints:
          type: object
          title: Composition Hints
      type: object
      required:
      - skill_id
      - name
      - version
      - description
      - cost_model
      - failure_modes
      - constraints
      - composition_hints
      title: SkillDescriptorResponse
      description: Response describing a skill.
    SkillListResponse:
      properties:
        skills:
          items:
            type: string
          type: array
          title: Skills
        count:
          type: integer
          title: Count
        descriptors:
          additionalProperties:
            type: object
          type: object
          title: Descriptors
      type: object
      required:
      - skills
      - count
      - descriptors
      title: SkillListResponse
      description: Response listing available skills.
    StatsResponse:
      properties:
        total_records:
          type: integer
          title: Total Records
        records_by_entity_type:
          additionalProperties:
            type: integer
          type: object
          title: Records By Entity Type
        records_by_actor_type:
          additionalProperties:
            type: integer
          type: object
          title: Records By Actor Type
        records_by_status:
          additionalProperties:
            type: integer
          type: object
          title: Records By Status
        oldest_record:
          anyOf:
          - type: string
            format: date-time
          - type: 'null'
          title: Oldest Record
        newest_record:
          anyOf:
          - type: string
            format: date-time
          - type: 'null'
          title: Newest Record
        time_range_days:
          anyOf:
          - type: number
          - type: 'null'
          title: Time Range Days
      type: object
      required:
      - total_records
      - records_by_entity_type
      - records_by_actor_type
      - records_by_status
      - oldest_record
      - newest_record
      - time_range_days
      title: StatsResponse
      description: Statistics for audit reporting.
    StatusHistoryListResponse:
      properties:
        items:
          items:
            $ref: '#/components/schemas/StatusHistoryResponse'
          type: array
          title: Items
        total:
          type: integer
          title: Total
        limit:
          type: integer
          title: Limit
        offset:
          type: integer
          title: Offset
        has_more:
          type: boolean
          title: Has More
      type: object
      required:
      - items
      - total
      - limit
      - offset
      - has_more
      title: StatusHistoryListResponse
      description: Paginated list of status history records.
    StatusHistoryResponse:
      properties:
        id:
          type: string
          title: Id
        entity_type:
          type: string
          title: Entity Type
        entity_id:
          type: string
          title: Entity Id
        old_status:
          anyOf:
          - type: string
          - type: 'null'
          title: Old Status
        new_status:
          type: string
          title: New Status
        actor_type:
          type: string
          title: Actor Type
        actor_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Actor Id
        reason:
          anyOf:
          - type: string
          - type: 'null'
          title: Reason
        tenant_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Tenant Id
        correlation_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Correlation Id
        metadata:
          type: object
          title: Metadata
        created_at:
          type: string
          format: date-time
          title: Created At
        sequence:
          anyOf:
          - type: integer
          - type: 'null'
          title: Sequence
      type: object
      required:
      - id
      - entity_type
      - entity_id
      - old_status
      - new_status
      - actor_type
      - actor_id
      - reason
      - tenant_id
      - correlation_id
      - metadata
      - created_at
      - sequence
      title: StatusHistoryResponse
      description: Single status history record.
    V2SimulationResponse:
      properties:
        feasible:
          type: boolean
          title: Feasible
        status:
          type: string
          title: Status
        estimated_cost_cents:
          type: integer
          title: Estimated Cost Cents
        estimated_duration_ms:
          type: integer
          title: Estimated Duration Ms
        budget_remaining_cents:
          type: integer
          title: Budget Remaining Cents
        confidence_score:
          type: number
          title: Confidence Score
        model_version:
          type: string
          title: Model Version
        step_estimates:
          items:
            $ref: '#/components/schemas/SimulationStepResult'
          type: array
          title: Step Estimates
        risks:
          items:
            type: object
          type: array
          title: Risks
        warnings:
          items:
            type: string
          type: array
          title: Warnings
        runtime_ms:
          type: integer
          title: Runtime Ms
      type: object
      required:
      - feasible
      - status
      - estimated_cost_cents
      - estimated_duration_ms
      - budget_remaining_cents
      - confidence_score
      - model_version
      - step_estimates
      - risks
      - warnings
      - runtime_ms
      title: V2SimulationResponse
      description: Response from V2 simulation.
    ValidationError:
      properties:
        loc:
          items:
            anyOf:
            - type: string
            - type: integer
          type: array
          title: Location
        msg:
          type: string
          title: Message
        type:
          type: string
          title: Error Type
      type: object
      required:
      - loc
      - msg
      - type
      title: ValidationError
    ValidationResultResponse:
      properties:
        dataset_id:
          type: string
          title: Dataset Id
        dataset_name:
          type: string
          title: Dataset Name
        sample_count:
          type: integer
          title: Sample Count
        mean_error:
          type: number
          title: Mean Error
        median_error:
          type: number
          title: Median Error
        std_deviation:
          type: number
          title: Std Deviation
        outlier_pct:
          type: number
          title: Outlier Pct
        drift_score:
          type: number
          title: Drift Score
        verdict:
          type: string
          title: Verdict
        details:
          type: object
          title: Details
        timestamp:
          type: string
          format: date-time
          title: Timestamp
      type: object
      required:
      - dataset_id
      - dataset_name
      - sample_count
      - mean_error
      - median_error
      - std_deviation
      - outlier_pct
      - drift_score
      - verdict
      - details
      - timestamp
      title: ValidationResultResponse
      description: Validation result response.
    app__api__costsim__SimulateRequest:
      properties:
        plan:
          items:
            $ref: '#/components/schemas/SimulationStep'
          type: array
          title: Plan
          description: Plan steps to simulate
        budget_cents:
          type: integer
          minimum: 0.0
          title: Budget Cents
          description: Available budget in cents
          default: 1000
        tenant_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Tenant Id
          description: Tenant identifier
        run_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Run Id
          description: Run identifier
        workflow_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Workflow Id
          description: Workflow identifier for memory context
        agent_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Agent Id
          description: Agent identifier for memory context
        inject_memory:
          anyOf:
          - type: boolean
          - type: 'null'
          title: Inject Memory
          description: Override memory injection setting
      type: object
      required:
      - plan
      title: SimulateRequest
      description: Request for V2 simulation.
    app__api__runtime__SimulateRequest:
      properties:
        plan:
          items:
            $ref: '#/components/schemas/PlanStep'
          type: array
          title: Plan
          description: List of steps to simulate
        budget_cents:
          type: integer
          title: Budget Cents
          description: Available budget in cents
          default: 1000
        agent_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Agent Id
          description: Agent ID for permission checking
        tenant_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Tenant Id
          description: Tenant ID for isolation
      type: object
      required:
      - plan
      title: SimulateRequest
      description: Request to simulate a plan before execution.
