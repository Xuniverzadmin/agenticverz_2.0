{
  "contract": {
    "name": "AOS Execution Integrity Contract",
    "version": "1.0.0",
    "status": "foundational",
    "effective_date": "2026-01-12",
    "scope": {
      "applies_to": [
        "llm_calls",
        "agent_runs",
        "human_initiated_runs",
        "system_initiated_runs"
      ]
    },
    "purpose": [
      "capture_execution_truth",
      "make_uncertainty_explicit",
      "ensure_integrity_over_completeness",
      "act_as_foundation_for_sdsr_and_aurora"
    ]
  },
  "principles": [
    {
      "id": "P1_CAPTURE_ALL",
      "statement": "Every execution attempt must result in a Run Record. Silence is a violation."
    },
    {
      "id": "P2_INTEGRITY_OVER_COMPLETENESS",
      "statement": "The system must not assume complete visibility. Missing data must be explicitly represented."
    },
    {
      "id": "P3_NO_FABRICATED_CERTAINTY",
      "statement": "Absence of evidence must never be interpreted as success."
    }
  ],
  "definitions": {
    "run": {
      "description": "A Run is any attempt to invoke an LLM or LLM-backed capability by a human, agent, or system, regardless of outcome.",
      "atomic": true,
      "includes": [
        "successful_calls",
        "failed_calls",
        "retries",
        "partial_responses",
        "blocked_or_rejected_attempts",
        "streaming_or_non_streaming_calls"
      ]
    },
    "traffic_vs_run": {
      "traffic": "raw_network_or_api_activity",
      "run": "semantic_execution_attempt",
      "reasoning_unit": "run"
    }
  },
  "capture_mandate": {
    "universal": true,
    "drop_policy": "forbidden",
    "minimum_capture": {
      "must_create_run_record": true,
      "must_assign_run_id": true,
      "must_record_attempt_even_if_failed": true
    }
  },
  "run_record_schema": {
    "identity": {
      "required": ["run_id", "actor_type", "timestamp_start"],
      "optional": ["parent_run_id", "actor_id", "auth_context", "environment", "sdk_version"]
    },
    "timing": {
      "required": ["timestamp_start"],
      "optional": ["timestamp_end", "duration_ms"]
    },
    "execution_intent": {
      "required": ["operation_type", "model_provider"],
      "optional": ["model_name", "input_schema_version"]
    },
    "execution_outcome": {
      "required": ["run_status", "response_expected"],
      "optional": ["response_received", "retry_count", "termination_reason"]
    },
    "observability": {
      "required": ["trace_expected"],
      "optional": ["trace_received", "trace_id", "span_count", "log_count"]
    },
    "policy_context": {
      "required": ["policies_evaluated"],
      "optional": ["policy_results", "thresholds_checked", "risk_level", "sensitivity_class"]
    },
    "explicit_absence": {
      "required": ["missing_fields"],
      "structure": {
        "missing_fields": {
          "type": "list",
          "item_schema": {
            "field_name": "string",
            "missing_reason": {
              "enum": ["unknown", "blocked", "dropped", "unsupported", "provider_side", "customer_side"]
            }
          }
        }
      }
    }
  },
  "integrity_model": {
    "expectations": [
      {
        "id": "EXPECT_RESPONSE",
        "condition": "response_expected == true",
        "requires": "response_received == true"
      },
      {
        "id": "EXPECT_TRACE",
        "condition": "trace_expected == true",
        "requires": "trace_received == true"
      }
    ],
    "integrity_evaluation": {
      "output": ["expected_events", "observed_events", "missing_events"],
      "integrity_score": {
        "type": "percentage",
        "computation": "observed_events / expected_events"
      }
    }
  },
  "integrity_events": {
    "type": "observability_integrity_event",
    "created_when": ["expectation_violated"],
    "default_severity": "informational",
    "promotion_rules": {
      "incident_creation": false,
      "policy_creation": false
    }
  },
  "layering_model": {
    "layer_0": {
      "name": "runs",
      "description": "raw_truth",
      "judgment": "none"
    },
    "layer_1": {
      "name": "notability",
      "description": "hypothesis",
      "judgment": "tentative"
    },
    "layer_2": {
      "name": "incidents",
      "description": "committed_memory",
      "judgment": "explicit"
    },
    "layer_3": {
      "name": "policies",
      "description": "governance",
      "judgment": "enforceable"
    }
  },
  "forbidden_behaviors": [
    {"id": "FB_001", "name": "silent_run_drop"},
    {"id": "FB_002", "name": "infer_success_from_absence"},
    {"id": "FB_003", "name": "treat_missing_as_clean"},
    {"id": "FB_004", "name": "incident_without_run"},
    {"id": "FB_005", "name": "policy_without_evidence"}
  ],
  "guarantees": {
    "downstream": [
      "all_effects_traceable_to_runs",
      "uncertainty_explicit",
      "confidence_computable",
      "integrity_score_available"
    ]
  },
  "agent_instructions": {
    "mandatory_reasoning_steps": [
      "start_from_run_records",
      "never_assume_completeness",
      "treat_missing_data_as_signal",
      "defer_judgment_if_integrity_low"
    ],
    "when_integrity_uncertain": "Surface uncertainty, not confidence."
  },
  "canonical_statement": "We capture everything we can. We never pretend to capture everything. We make the difference visible.",
  "sdsr_verification_mapping": [
    {"sdsr_check": "No silent failures", "verified_by": "P1_CAPTURE_ALL"},
    {"sdsr_check": "Explicit uncertainty", "verified_by": "explicit_absence"},
    {"sdsr_check": "Observation integrity", "verified_by": "integrity_model"},
    {"sdsr_check": "No fake inference", "verified_by": "P3_NO_FABRICATED_CERTAINTY"},
    {"sdsr_check": "Upstream truth only", "verified_by": "layer_0"},
    {"sdsr_check": "Aurora never assumes", "verified_by": "guarantees.downstream"}
  ]
}
