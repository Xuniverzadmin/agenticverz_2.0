{
  "metadata": {
    "generated": "2025-12-30T19:35:24.711561",
    "scanned_path": "/root/agenticverz2.0/backend/app",
    "version": "0.1.0"
  },
  "summary": {
    "files_scanned": 336,
    "files_with_signals": 93,
    "total_findings": 352,
    "risk_scores": {
      "total_score": 7840,
      "INFO": 20,
      "WARNING": 24,
      "HIGH_RISK": 308,
      "CRITICAL": 0
    }
  },
  "findings_by_type": {
    "WRITE_OUTSIDE_WRITE_SERVICE": [
      {
        "file": "cli.py",
        "line": 70,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'create_agent' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_agent",
        "signal_data": {
          "function": "create_agent",
          "write_operation": "session.add"
        }
      },
      {
        "file": "cli.py",
        "line": 70,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'create_agent' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_agent",
        "signal_data": {
          "function": "create_agent",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "cli.py",
        "line": 122,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'create_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_run",
        "signal_data": {
          "function": "create_run",
          "write_operation": "session.add"
        }
      },
      {
        "file": "cli.py",
        "line": 122,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'create_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_run",
        "signal_data": {
          "function": "create_run",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "cli.py",
        "line": 168,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'run_goal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: run_goal",
        "signal_data": {
          "function": "run_goal",
          "write_operation": "session.add"
        }
      },
      {
        "file": "cli.py",
        "line": 168,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'run_goal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: run_goal",
        "signal_data": {
          "function": "run_goal",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "db.py",
        "line": 938,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'log_status_change' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: log_status_change",
        "signal_data": {
          "function": "log_status_change",
          "write_operation": "session.add"
        }
      },
      {
        "file": "db.py",
        "line": 938,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'log_status_change' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: log_status_change",
        "signal_data": {
          "function": "log_status_change",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 852,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'create_agent' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_agent",
        "signal_data": {
          "function": "create_agent",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 852,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'create_agent' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_agent",
        "signal_data": {
          "function": "create_agent",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 885,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'post_goal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: post_goal",
        "signal_data": {
          "function": "post_goal",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 885,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'post_goal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: post_goal",
        "signal_data": {
          "function": "post_goal",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 1190,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'retry_failed_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: retry_failed_run",
        "signal_data": {
          "function": "retry_failed_run",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 1190,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'retry_failed_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: retry_failed_run",
        "signal_data": {
          "function": "retry_failed_run",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/sba/evolution.py",
        "line": 273,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_persist_violation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_violation",
        "signal_data": {
          "function": "_persist_violation",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "agents/sba/evolution.py",
        "line": 458,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_persist_drift_signal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_drift_signal",
        "signal_data": {
          "function": "_persist_drift_signal",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "agents/sba/evolution.py",
        "line": 582,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'apply_adjustment' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: apply_adjustment",
        "signal_data": {
          "function": "apply_adjustment",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "agents/sba/evolution.py",
        "line": 651,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_persist_adjustment' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_adjustment",
        "signal_data": {
          "function": "_persist_adjustment",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "agents/sba/service.py",
        "line": 87,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'register_agent' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: register_agent",
        "signal_data": {
          "function": "register_agent",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/sba/service.py",
        "line": 369,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'update_sba' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_sba",
        "signal_data": {
          "function": "update_sba",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/sba/service.py",
        "line": 408,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'update_fulfillment_metric' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_fulfillment_metric",
        "signal_data": {
          "function": "update_fulfillment_metric",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/sba/service.py",
        "line": 579,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'retrofit_missing_sba' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: retrofit_missing_sba",
        "signal_data": {
          "function": "retrofit_missing_sba",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/credit_service.py",
        "line": 187,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'log_reservation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: log_reservation",
        "signal_data": {
          "function": "log_reservation",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/credit_service.py",
        "line": 276,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'spend_for_item' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: spend_for_item",
        "signal_data": {
          "function": "spend_for_item",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/credit_service.py",
        "line": 324,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'refund_for_item' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: refund_for_item",
        "signal_data": {
          "function": "refund_for_item",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/credit_service.py",
        "line": 381,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'charge_skill' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: charge_skill",
        "signal_data": {
          "function": "charge_skill",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/governance_service.py",
        "line": 220,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'update_job_budget' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_job_budget",
        "signal_data": {
          "function": "update_job_budget",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/governance_service.py",
        "line": 315,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'allocate_worker_budget' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: allocate_worker_budget",
        "signal_data": {
          "function": "allocate_worker_budget",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/governance_service.py",
        "line": 436,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'record_item_llm_usage' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_item_llm_usage",
        "signal_data": {
          "function": "record_item_llm_usage",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/invoke_audit_service.py",
        "line": 63,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'start_invoke' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: start_invoke",
        "signal_data": {
          "function": "start_invoke",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/invoke_audit_service.py",
        "line": 131,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'complete_invoke' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: complete_invoke",
        "signal_data": {
          "function": "complete_invoke",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/invoke_audit_service.py",
        "line": 185,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'fail_invoke' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: fail_invoke",
        "signal_data": {
          "function": "fail_invoke",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/job_service.py",
        "line": 127,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'create_job' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_job",
        "signal_data": {
          "function": "create_job",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/job_service.py",
        "line": 406,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'check_job_completion' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: check_job_completion",
        "signal_data": {
          "function": "check_job_completion",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/job_service.py",
        "line": 468,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'cancel_job' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: cancel_job",
        "signal_data": {
          "function": "cancel_job",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/message_service.py",
        "line": 97,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'send' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: send",
        "signal_data": {
          "function": "send",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/message_service.py",
        "line": 289,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'mark_delivered' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: mark_delivered",
        "signal_data": {
          "function": "mark_delivered",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/message_service.py",
        "line": 312,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'mark_read' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: mark_read",
        "signal_data": {
          "function": "mark_read",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/message_service.py",
        "line": 512,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'cleanup_old_messages' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: cleanup_old_messages",
        "signal_data": {
          "function": "cleanup_old_messages",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 81,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'register' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: register",
        "signal_data": {
          "function": "register",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 157,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'heartbeat' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: heartbeat",
        "signal_data": {
          "function": "heartbeat",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 198,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'deregister' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: deregister",
        "signal_data": {
          "function": "deregister",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 336,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'mark_instance_stale' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: mark_instance_stale",
        "signal_data": {
          "function": "mark_instance_stale",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 376,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'mark_stale' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: mark_stale",
        "signal_data": {
          "function": "mark_stale",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 376,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'mark_stale' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: mark_stale",
        "signal_data": {
          "function": "mark_stale",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 428,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'reclaim_stale_items' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: reclaim_stale_items",
        "signal_data": {
          "function": "reclaim_stale_items",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 428,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'reclaim_stale_items' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: reclaim_stale_items",
        "signal_data": {
          "function": "reclaim_stale_items",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 76,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'claim_item' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: claim_item",
        "signal_data": {
          "function": "claim_item",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 172,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_claim_item_raw' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _claim_item_raw",
        "signal_data": {
          "function": "_claim_item_raw",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 277,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'start_item' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: start_item",
        "signal_data": {
          "function": "start_item",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 308,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'complete_item' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: complete_item",
        "signal_data": {
          "function": "complete_item",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 436,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'fail_item' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: fail_item",
        "signal_data": {
          "function": "fail_item",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 557,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'release_claimed' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: release_claimed",
        "signal_data": {
          "function": "release_claimed",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/skills/agent_invoke.py",
        "line": 253,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_create_invocation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _create_invocation",
        "signal_data": {
          "function": "_create_invocation",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/skills/agent_invoke.py",
        "line": 407,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_fail_invocation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _fail_invocation",
        "signal_data": {
          "function": "_fail_invocation",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/skills/agent_invoke.py",
        "line": 425,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_timeout_invocation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _timeout_invocation",
        "signal_data": {
          "function": "_timeout_invocation",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/skills/agent_invoke.py",
        "line": 444,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'respond_to_invoke' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: respond_to_invoke",
        "signal_data": {
          "function": "respond_to_invoke",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/skills/llm_invoke_governed.py",
        "line": 370,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_record_governance_data' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _record_governance_data",
        "signal_data": {
          "function": "_record_governance_data",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/agents.py",
        "line": 2101,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'update_agent_strategy' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_agent_strategy",
        "signal_data": {
          "function": "update_agent_strategy",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "api/founder_actions.py",
        "line": 259,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in 'execute_action' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: execute_action",
        "signal_data": {
          "function": "execute_action",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/founder_actions.py",
        "line": 517,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in 'execute_reversal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: execute_reversal",
        "signal_data": {
          "function": "execute_reversal",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/integration.py",
        "line": 900,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'simulate_prevention' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: simulate_prevention",
        "signal_data": {
          "function": "simulate_prevention",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/integration.py",
        "line": 978,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'simulate_regret' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: simulate_regret",
        "signal_data": {
          "function": "simulate_regret",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/integration.py",
        "line": 1070,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'simulate_timeline_view' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: simulate_timeline_view",
        "signal_data": {
          "function": "simulate_timeline_view",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/integration.py",
        "line": 1132,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'record_timeline_view' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_timeline_view",
        "signal_data": {
          "function": "record_timeline_view",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/integration.py",
        "line": 1198,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'trigger_graduation_re_evaluation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: trigger_graduation_re_evaluation",
        "signal_data": {
          "function": "trigger_graduation_re_evaluation",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/memory_pins.py",
        "line": 135,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'write_memory_audit' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: write_memory_audit",
        "signal_data": {
          "function": "write_memory_audit",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "api/memory_pins.py",
        "line": 192,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'create_or_upsert_pin' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_or_upsert_pin",
        "signal_data": {
          "function": "create_or_upsert_pin",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "api/memory_pins.py",
        "line": 448,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'delete_pin' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete_pin",
        "signal_data": {
          "function": "delete_pin",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "api/memory_pins.py",
        "line": 505,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'cleanup_expired_pins' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: cleanup_expired_pins",
        "signal_data": {
          "function": "cleanup_expired_pins",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 627,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'create_approval_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_approval_request",
        "signal_data": {
          "function": "create_approval_request",
          "write_operation": "session.add"
        }
      },
      {
        "file": "api/policy.py",
        "line": 627,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'create_approval_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_approval_request",
        "signal_data": {
          "function": "create_approval_request",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 704,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'get_approval_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: get_approval_request",
        "signal_data": {
          "function": "get_approval_request",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 825,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'approve_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: approve_request",
        "signal_data": {
          "function": "approve_request",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 825,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'approve_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: approve_request",
        "signal_data": {
          "function": "approve_request",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 892,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'reject_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: reject_request",
        "signal_data": {
          "function": "reject_request",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 939,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'list_approval_requests' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: list_approval_requests",
        "signal_data": {
          "function": "list_approval_requests",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 1011,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'run_escalation_check' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: run_escalation_check",
        "signal_data": {
          "function": "run_escalation_check",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/rbac_api.py",
        "line": 291,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'cleanup_audit_logs' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: cleanup_audit_logs",
        "signal_data": {
          "function": "cleanup_audit_logs",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "api/recovery.py",
        "line": 576,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in 'update_candidate' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_candidate",
        "signal_data": {
          "function": "update_candidate",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/recovery_ingest.py",
        "line": 117,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in 'ingest_failure' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: ingest_failure",
        "signal_data": {
          "function": "ingest_failure",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/recovery_ingest.py",
        "line": 286,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in '_enqueue_evaluation_async' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _enqueue_evaluation_async",
        "signal_data": {
          "function": "_enqueue_evaluation_async",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/traces.py",
        "line": 653,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'bulk_report_mismatches' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: bulk_report_mismatches",
        "signal_data": {
          "function": "bulk_report_mismatches",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/traces.py",
        "line": 778,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'report_mismatch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: report_mismatch",
        "signal_data": {
          "function": "report_mismatch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/traces.py",
        "line": 778,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'report_mismatch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: report_mismatch",
        "signal_data": {
          "function": "report_mismatch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/traces.py",
        "line": 778,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'report_mismatch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: report_mismatch",
        "signal_data": {
          "function": "report_mismatch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/traces.py",
        "line": 1015,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'resolve_mismatch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: resolve_mismatch",
        "signal_data": {
          "function": "resolve_mismatch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/v1_proxy.py",
        "line": 248,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'record_usage_after_killswitch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_usage_after_killswitch",
        "signal_data": {
          "function": "record_usage_after_killswitch",
          "write_operation": "session.add"
        }
      },
      {
        "file": "api/v1_proxy.py",
        "line": 248,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'record_usage_after_killswitch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_usage_after_killswitch",
        "signal_data": {
          "function": "record_usage_after_killswitch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/v1_proxy.py",
        "line": 430,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'log_proxy_call' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: log_proxy_call",
        "signal_data": {
          "function": "log_proxy_call",
          "write_operation": "session.add"
        }
      },
      {
        "file": "api/v1_proxy.py",
        "line": 430,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'log_proxy_call' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: log_proxy_call",
        "signal_data": {
          "function": "log_proxy_call",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/workers.py",
        "line": 194,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in '_store_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _store_run",
        "signal_data": {
          "function": "_store_run",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/workers.py",
        "line": 235,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in '_insert_cost_record' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert_cost_record",
        "signal_data": {
          "function": "_insert_cost_record",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/workers.py",
        "line": 273,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in '_check_and_emit_cost_advisory' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _check_and_emit_cost_advisory",
        "signal_data": {
          "function": "_check_and_emit_cost_advisory",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/workers.py",
        "line": 1208,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in 'delete_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete_run",
        "signal_data": {
          "function": "delete_run",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "auth/rbac_engine.py",
        "line": 396,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_audit' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _audit",
        "signal_data": {
          "function": "_audit",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "auth/tenant_auth.py",
        "line": 145,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'validate_api_key_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: validate_api_key_db",
        "signal_data": {
          "function": "validate_api_key_db",
          "write_operation": "session.add"
        }
      },
      {
        "file": "auth/tenant_auth.py",
        "line": 145,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'validate_api_key_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: validate_api_key_db",
        "signal_data": {
          "function": "validate_api_key_db",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "config/flag_sync.py",
        "line": 109,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'sync_file_to_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: sync_file_to_db",
        "signal_data": {
          "function": "sync_file_to_db",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "config/flag_sync.py",
        "line": 109,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'sync_file_to_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: sync_file_to_db",
        "signal_data": {
          "function": "sync_file_to_db",
          "write_operation": "session.add"
        }
      },
      {
        "file": "contracts/decisions.py",
        "line": 949,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'backfill_run_id_for_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: backfill_run_id_for_request",
        "signal_data": {
          "function": "backfill_run_id_for_request",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "contracts/decisions.py",
        "line": 182,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'emit' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: emit",
        "signal_data": {
          "function": "emit",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "contracts/decisions.py",
        "line": 264,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_emit_sync_impl' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _emit_sync_impl",
        "signal_data": {
          "function": "_emit_sync_impl",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "costsim/alert_worker.py",
        "line": 303,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'enqueue_alert' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: enqueue_alert",
        "signal_data": {
          "function": "enqueue_alert",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/alert_worker.py",
        "line": 303,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'enqueue_alert' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: enqueue_alert",
        "signal_data": {
          "function": "enqueue_alert",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/alert_worker.py",
        "line": 357,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'retry_failed_alerts' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: retry_failed_alerts",
        "signal_data": {
          "function": "retry_failed_alerts",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/alert_worker.py",
        "line": 395,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'purge_old_alerts' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: purge_old_alerts",
        "signal_data": {
          "function": "purge_old_alerts",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/alert_worker.py",
        "line": 95,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'process_batch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: process_batch",
        "signal_data": {
          "function": "process_batch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 206,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_get_or_create_state' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_or_create_state",
        "signal_data": {
          "function": "_get_or_create_state",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 206,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_get_or_create_state' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_or_create_state",
        "signal_data": {
          "function": "_get_or_create_state",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 271,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_auto_recover' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _auto_recover",
        "signal_data": {
          "function": "_auto_recover",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 350,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'report_drift' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: report_drift",
        "signal_data": {
          "function": "report_drift",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 350,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'report_drift' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: report_drift",
        "signal_data": {
          "function": "report_drift",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 498,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'reset' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: reset",
        "signal_data": {
          "function": "reset",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 573,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_trip' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _trip",
        "signal_data": {
          "function": "_trip",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 573,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_trip' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _trip",
        "signal_data": {
          "function": "_trip",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 573,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_trip' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _trip",
        "signal_data": {
          "function": "_trip",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 683,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_resolve_incident_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _resolve_incident_db",
        "signal_data": {
          "function": "_resolve_incident_db",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 130,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_get_or_create_state' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_or_create_state",
        "signal_data": {
          "function": "_get_or_create_state",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 130,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in '_get_or_create_state' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_or_create_state",
        "signal_data": {
          "function": "_get_or_create_state",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 229,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in '_try_auto_recover' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _try_auto_recover",
        "signal_data": {
          "function": "_try_auto_recover",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 321,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_auto_recover' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _auto_recover",
        "signal_data": {
          "function": "_auto_recover",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 598,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_trip' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _trip",
        "signal_data": {
          "function": "_trip",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 598,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in '_trip' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _trip",
        "signal_data": {
          "function": "_trip",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 694,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_resolve_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _resolve_incident",
        "signal_data": {
          "function": "_resolve_incident",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 762,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_enqueue_alert' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _enqueue_alert",
        "signal_data": {
          "function": "_enqueue_alert",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 762,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in '_enqueue_alert' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _enqueue_alert",
        "signal_data": {
          "function": "_enqueue_alert",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "costsim/provenance_async.py",
        "line": 61,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'write_provenance' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: write_provenance",
        "signal_data": {
          "function": "write_provenance",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/provenance_async.py",
        "line": 61,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'write_provenance' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: write_provenance",
        "signal_data": {
          "function": "write_provenance",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/provenance_async.py",
        "line": 146,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'write_provenance_batch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: write_provenance_batch",
        "signal_data": {
          "function": "write_provenance_batch",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/provenance_async.py",
        "line": 146,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'write_provenance_batch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: write_provenance_batch",
        "signal_data": {
          "function": "write_provenance_batch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "discovery/ledger.py",
        "line": 50,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'emit_signal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: emit_signal",
        "signal_data": {
          "function": "emit_signal",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "integrations/bridges.py",
        "line": 111,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'record_policy_activation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_policy_activation",
        "signal_data": {
          "function": "record_policy_activation",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/bridges.py",
        "line": 415,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_increment_pattern_count' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _increment_pattern_count",
        "signal_data": {
          "function": "_increment_pattern_count",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/bridges.py",
        "line": 432,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_create_pattern' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _create_pattern",
        "signal_data": {
          "function": "_create_pattern",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/bridges.py",
        "line": 668,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_persist_recovery' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_recovery",
        "signal_data": {
          "function": "_persist_recovery",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/bridges.py",
        "line": 867,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_persist_policy' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_policy",
        "signal_data": {
          "function": "_persist_policy",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/bridges.py",
        "line": 1142,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_persist_adjustment' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_adjustment",
        "signal_data": {
          "function": "_persist_adjustment",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/cost_snapshots.py",
        "line": 623,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_insert_snapshot' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert_snapshot",
        "signal_data": {
          "function": "_insert_snapshot",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "integrations/cost_snapshots.py",
        "line": 651,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_update_snapshot' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update_snapshot",
        "signal_data": {
          "function": "_update_snapshot",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "integrations/cost_snapshots.py",
        "line": 675,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_insert_aggregate' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert_aggregate",
        "signal_data": {
          "function": "_insert_aggregate",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "integrations/cost_snapshots.py",
        "line": 794,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_insert_baseline' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert_baseline",
        "signal_data": {
          "function": "_insert_baseline",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "integrations/cost_snapshots.py",
        "line": 971,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_insert_evaluation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert_evaluation",
        "signal_data": {
          "function": "_insert_evaluation",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "integrations/cost_snapshots.py",
        "line": 1005,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_create_anomaly_from_evaluation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _create_anomaly_from_evaluation",
        "signal_data": {
          "function": "_create_anomaly_from_evaluation",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "integrations/dispatcher.py",
        "line": 516,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_persist_event' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_event",
        "signal_data": {
          "function": "_persist_event",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/dispatcher.py",
        "line": 555,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_persist_loop_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_loop_status",
        "signal_data": {
          "function": "_persist_loop_status",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/dispatcher.py",
        "line": 591,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_persist_checkpoint' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_checkpoint",
        "signal_data": {
          "function": "_persist_checkpoint",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/graduation_engine.py",
        "line": 757,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'persist_graduation_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_graduation_status",
        "signal_data": {
          "function": "persist_graduation_status",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "jobs/graduation_evaluator.py",
        "line": 38,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'evaluate_graduation_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: evaluate_graduation_status",
        "signal_data": {
          "function": "evaluate_graduation_status",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "jobs/storage.py",
        "line": 451,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_record_export_to_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _record_export_to_db",
        "signal_data": {
          "function": "_record_export_to_db",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "jobs/storage.py",
        "line": 491,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_update_export_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update_export_status",
        "signal_data": {
          "function": "_update_export_status",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/memory_service.py",
        "line": 303,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'set' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: set",
        "signal_data": {
          "function": "set",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/memory_service.py",
        "line": 415,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'delete' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete",
        "signal_data": {
          "function": "delete",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/memory_service.py",
        "line": 565,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_audit' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _audit",
        "signal_data": {
          "function": "_audit",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/store.py",
        "line": 64,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'store' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: store",
        "signal_data": {
          "function": "store",
          "write_operation": "session.add"
        }
      },
      {
        "file": "memory/store.py",
        "line": 64,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'store' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: store",
        "signal_data": {
          "function": "store",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/store.py",
        "line": 195,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.delete' in 'delete' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete",
        "signal_data": {
          "function": "delete",
          "write_operation": "session.delete"
        }
      },
      {
        "file": "memory/store.py",
        "line": 195,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'delete' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete",
        "signal_data": {
          "function": "delete",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/vector_store.py",
        "line": 266,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'store' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: store",
        "signal_data": {
          "function": "store",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/vector_store.py",
        "line": 594,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'delete' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete",
        "signal_data": {
          "function": "delete",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/vector_store.py",
        "line": 604,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'backfill_embeddings' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: backfill_embeddings",
        "signal_data": {
          "function": "backfill_embeddings",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "optimization/audit_persistence.py",
        "line": 62,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.add' in 'persist_audit_record' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_audit_record",
        "signal_data": {
          "function": "persist_audit_record",
          "write_operation": "db.add"
        }
      },
      {
        "file": "optimization/audit_persistence.py",
        "line": 62,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'persist_audit_record' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_audit_record",
        "signal_data": {
          "function": "persist_audit_record",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1186,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_persist_evaluation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_evaluation",
        "signal_data": {
          "function": "_persist_evaluation",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1186,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_persist_evaluation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_evaluation",
        "signal_data": {
          "function": "_persist_evaluation",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1417,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'acknowledge_violation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: acknowledge_violation",
        "signal_data": {
          "function": "acknowledge_violation",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1467,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'update_risk_ceiling' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_risk_ceiling",
        "signal_data": {
          "function": "update_risk_ceiling",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1502,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'reset_risk_ceiling' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: reset_risk_ceiling",
        "signal_data": {
          "function": "reset_risk_ceiling",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1543,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'update_safety_rule' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_safety_rule",
        "signal_data": {
          "function": "update_safety_rule",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1723,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'create_policy_version' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_policy_version",
        "signal_data": {
          "function": "create_policy_version",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1790,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'rollback_to_version' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: rollback_to_version",
        "signal_data": {
          "function": "rollback_to_version",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 2007,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'resolve_conflict' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: resolve_conflict",
        "signal_data": {
          "function": "resolve_conflict",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 2076,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'create_temporal_policy' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_temporal_policy",
        "signal_data": {
          "function": "create_temporal_policy",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 2456,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'add_dependency_with_dag_check' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: add_dependency_with_dag_check",
        "signal_data": {
          "function": "add_dependency_with_dag_check",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 2615,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'prune_temporal_metrics' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: prune_temporal_metrics",
        "signal_data": {
          "function": "prune_temporal_metrics",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 2786,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'activate_policy_version' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: activate_policy_version",
        "signal_data": {
          "function": "activate_policy_version",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "predictions/api.py",
        "line": 65,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.add' in 'create_incident_risk_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_incident_risk_prediction",
        "signal_data": {
          "function": "create_incident_risk_prediction",
          "write_operation": "db.add"
        }
      },
      {
        "file": "predictions/api.py",
        "line": 65,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'create_incident_risk_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_incident_risk_prediction",
        "signal_data": {
          "function": "create_incident_risk_prediction",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "predictions/api.py",
        "line": 144,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.add' in 'create_spend_spike_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_spend_spike_prediction",
        "signal_data": {
          "function": "create_spend_spike_prediction",
          "write_operation": "db.add"
        }
      },
      {
        "file": "predictions/api.py",
        "line": 144,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'create_spend_spike_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_spend_spike_prediction",
        "signal_data": {
          "function": "create_spend_spike_prediction",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "predictions/api.py",
        "line": 202,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.add' in 'create_policy_drift_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_policy_drift_prediction",
        "signal_data": {
          "function": "create_policy_drift_prediction",
          "write_operation": "db.add"
        }
      },
      {
        "file": "predictions/api.py",
        "line": 202,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'create_policy_drift_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_policy_drift_prediction",
        "signal_data": {
          "function": "create_policy_drift_prediction",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "routing/care.py",
        "line": 432,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_persist_decision' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_decision",
        "signal_data": {
          "function": "_persist_decision",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "runtime/failure_catalog.py",
        "line": 577,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'persist_failure_match' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_failure_match",
        "signal_data": {
          "function": "persist_failure_match",
          "write_operation": "session.add"
        }
      },
      {
        "file": "runtime/failure_catalog.py",
        "line": 577,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'persist_failure_match' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_failure_match",
        "signal_data": {
          "function": "persist_failure_match",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "runtime/failure_catalog.py",
        "line": 791,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'update_recovery_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_recovery_status",
        "signal_data": {
          "function": "update_recovery_status",
          "write_operation": "session.add"
        }
      },
      {
        "file": "runtime/failure_catalog.py",
        "line": 791,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'update_recovery_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_recovery_status",
        "signal_data": {
          "function": "update_recovery_status",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 676,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_record_breach_and_get_consecutive_count' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _record_breach_and_get_consecutive_count",
        "signal_data": {
          "function": "_record_breach_and_get_consecutive_count",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 784,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_update_drift_tracking' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update_drift_tracking",
        "signal_data": {
          "function": "_update_drift_tracking",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 784,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_update_drift_tracking' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update_drift_tracking",
        "signal_data": {
          "function": "_update_drift_tracking",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 878,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_reset_drift_tracking' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _reset_drift_tracking",
        "signal_data": {
          "function": "_reset_drift_tracking",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 1039,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'persist_anomalies' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_anomalies",
        "signal_data": {
          "function": "persist_anomalies",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 263,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_get_rate_limit_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_rate_limit_incident",
        "signal_data": {
          "function": "_get_rate_limit_incident",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 263,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_get_rate_limit_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_rate_limit_incident",
        "signal_data": {
          "function": "_get_rate_limit_incident",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 263,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_get_rate_limit_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_rate_limit_incident",
        "signal_data": {
          "function": "_get_rate_limit_incident",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 263,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_get_rate_limit_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_rate_limit_incident",
        "signal_data": {
          "function": "_get_rate_limit_incident",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 311,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_create_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _create_incident",
        "signal_data": {
          "function": "_create_incident",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 311,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_create_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _create_incident",
        "signal_data": {
          "function": "_create_incident",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 366,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_add_call_to_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _add_call_to_incident",
        "signal_data": {
          "function": "_add_call_to_incident",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 366,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_add_call_to_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _add_call_to_incident",
        "signal_data": {
          "function": "_add_call_to_incident",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 448,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_add_incident_event' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _add_incident_event",
        "signal_data": {
          "function": "_add_incident_event",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 448,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_add_incident_event' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _add_incident_event",
        "signal_data": {
          "function": "_add_incident_event",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 471,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'resolve_stale_incidents' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: resolve_stale_incidents",
        "signal_data": {
          "function": "resolve_stale_incidents",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 471,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'resolve_stale_incidents' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: resolve_stale_incidents",
        "signal_data": {
          "function": "resolve_stale_incidents",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/llm_failure_service.py",
        "line": 128,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self._session.commit' in 'persist_failure_and_mark_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_failure_and_mark_run",
        "signal_data": {
          "function": "persist_failure_and_mark_run",
          "write_operation": "self._session.commit"
        }
      },
      {
        "file": "services/orphan_recovery.py",
        "line": 114,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'recover_orphaned_runs' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: recover_orphaned_runs",
        "signal_data": {
          "function": "recover_orphaned_runs",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/pattern_detection.py",
        "line": 227,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'emit_feedback' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: emit_feedback",
        "signal_data": {
          "function": "emit_feedback",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/pattern_detection.py",
        "line": 227,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in 'emit_feedback' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: emit_feedback",
        "signal_data": {
          "function": "emit_feedback",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "services/pattern_detection.py",
        "line": 268,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'run_pattern_detection' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: run_pattern_detection",
        "signal_data": {
          "function": "run_pattern_detection",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/policy_proposal.py",
        "line": 115,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'create_policy_proposal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_policy_proposal",
        "signal_data": {
          "function": "create_policy_proposal",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/policy_proposal.py",
        "line": 115,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in 'create_policy_proposal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_policy_proposal",
        "signal_data": {
          "function": "create_policy_proposal",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "services/policy_proposal.py",
        "line": 153,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'review_policy_proposal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: review_policy_proposal",
        "signal_data": {
          "function": "review_policy_proposal",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/policy_proposal.py",
        "line": 153,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in 'review_policy_proposal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: review_policy_proposal",
        "signal_data": {
          "function": "review_policy_proposal",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "services/policy_proposal.py",
        "line": 232,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'generate_proposals_from_feedback' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: generate_proposals_from_feedback",
        "signal_data": {
          "function": "generate_proposals_from_feedback",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/policy_violation_service.py",
        "line": 110,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'persist_violation_fact' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_violation_fact",
        "signal_data": {
          "function": "persist_violation_fact",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/policy_violation_service.py",
        "line": 194,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'persist_evidence' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_evidence",
        "signal_data": {
          "function": "persist_evidence",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/policy_violation_service.py",
        "line": 262,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'sync_session.commit' in 'create_incident_from_violation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_incident_from_violation",
        "signal_data": {
          "function": "create_incident_from_violation",
          "write_operation": "sync_session.commit"
        }
      },
      {
        "file": "services/prediction.py",
        "line": 276,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'emit_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: emit_prediction",
        "signal_data": {
          "function": "emit_prediction",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/prediction.py",
        "line": 276,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in 'emit_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: emit_prediction",
        "signal_data": {
          "function": "emit_prediction",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "services/prediction.py",
        "line": 318,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'run_prediction_cycle' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: run_prediction_cycle",
        "signal_data": {
          "function": "run_prediction_cycle",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/recovery_matcher.py",
        "line": 576,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_upsert_candidate' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _upsert_candidate",
        "signal_data": {
          "function": "_upsert_candidate",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/recovery_matcher.py",
        "line": 814,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'approve_candidate' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: approve_candidate",
        "signal_data": {
          "function": "approve_candidate",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 67,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'create_tenant' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_tenant",
        "signal_data": {
          "function": "create_tenant",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 112,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'update_tenant_plan' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_tenant_plan",
        "signal_data": {
          "function": "update_tenant_plan",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 135,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'suspend_tenant' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: suspend_tenant",
        "signal_data": {
          "function": "suspend_tenant",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 151,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'create_membership_with_default' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_membership_with_default",
        "signal_data": {
          "function": "create_membership_with_default",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 200,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'create_api_key' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_api_key",
        "signal_data": {
          "function": "create_api_key",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 282,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'revoke_api_key' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: revoke_api_key",
        "signal_data": {
          "function": "revoke_api_key",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 367,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'increment_usage' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: increment_usage",
        "signal_data": {
          "function": "increment_usage",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 378,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_maybe_reset_daily_counter' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _maybe_reset_daily_counter",
        "signal_data": {
          "function": "_maybe_reset_daily_counter",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 378,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_maybe_reset_daily_counter' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _maybe_reset_daily_counter",
        "signal_data": {
          "function": "_maybe_reset_daily_counter",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 394,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'record_usage' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_usage",
        "signal_data": {
          "function": "record_usage",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 468,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'create_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_run",
        "signal_data": {
          "function": "create_run",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 503,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'complete_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: complete_run",
        "signal_data": {
          "function": "complete_run",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/worker_registry_service.py",
        "line": 175,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'register_worker' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: register_worker",
        "signal_data": {
          "function": "register_worker",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/worker_registry_service.py",
        "line": 217,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'update_worker_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_worker_status",
        "signal_data": {
          "function": "update_worker_status",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/worker_registry_service.py",
        "line": 245,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'set_tenant_worker_config' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: set_tenant_worker_config",
        "signal_data": {
          "function": "set_tenant_worker_config",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/worker_registry_service.py",
        "line": 245,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'set_tenant_worker_config' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: set_tenant_worker_config",
        "signal_data": {
          "function": "set_tenant_worker_config",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/worker_write_service_async.py",
        "line": 238,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'commit' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: commit",
        "signal_data": {
          "function": "commit",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "skills/base.py",
        "line": 119,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_upsert_state' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _upsert_state",
        "signal_data": {
          "function": "_upsert_state",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "skills/postgres_query.py",
        "line": 113,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: execute",
        "signal_data": {
          "function": "execute",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "skills/registry_v2.py",
        "line": 146,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self._db.commit' in '_init_persistence' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _init_persistence",
        "signal_data": {
          "function": "_init_persistence",
          "write_operation": "self._db.commit"
        }
      },
      {
        "file": "skills/registry_v2.py",
        "line": 213,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self._db.commit' in '_persist_registration' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_registration",
        "signal_data": {
          "function": "_persist_registration",
          "write_operation": "self._db.commit"
        }
      },
      {
        "file": "skills/registry_v2.py",
        "line": 235,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self._db.commit' in 'deregister' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: deregister",
        "signal_data": {
          "function": "deregister",
          "write_operation": "self._db.commit"
        }
      },
      {
        "file": "tasks/recovery_queue_stream.py",
        "line": 682,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'archive_dead_letter_to_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: archive_dead_letter_to_db",
        "signal_data": {
          "function": "archive_dead_letter_to_db",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "tasks/recovery_queue_stream.py",
        "line": 1172,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_record_replay_to_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _record_replay_to_db",
        "signal_data": {
          "function": "_record_replay_to_db",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 111,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_init_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _init_db",
        "signal_data": {
          "function": "_init_db",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 181,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'start_trace' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: start_trace",
        "signal_data": {
          "function": "start_trace",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 211,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'record_step' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_step",
        "signal_data": {
          "function": "record_step",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 255,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'complete_trace' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: complete_trace",
        "signal_data": {
          "function": "complete_trace",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 391,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'delete_trace' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete_trace",
        "signal_data": {
          "function": "delete_trace",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 415,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'cleanup_old_traces' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: cleanup_old_traces",
        "signal_data": {
          "function": "cleanup_old_traces",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 570,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'update_trace_determinism' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_trace_determinism",
        "signal_data": {
          "function": "update_trace_determinism",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 191,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_insert' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert",
        "signal_data": {
          "function": "_insert",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 227,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_insert' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert",
        "signal_data": {
          "function": "_insert",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 263,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_update' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update",
        "signal_data": {
          "function": "_update",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 394,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_delete' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _delete",
        "signal_data": {
          "function": "_delete",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 418,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_cleanup' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _cleanup",
        "signal_data": {
          "function": "_cleanup",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 580,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_update' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update",
        "signal_data": {
          "function": "_update",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "utils/budget_tracker.py",
        "line": 335,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_pause_agent' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _pause_agent",
        "signal_data": {
          "function": "_pause_agent",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "utils/budget_tracker.py",
        "line": 353,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'deduct' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: deduct",
        "signal_data": {
          "function": "deduct",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "utils/budget_tracker.py",
        "line": 414,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'record_cost' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_cost",
        "signal_data": {
          "function": "record_cost",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "utils/db_helpers.py",
        "line": 378,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'get_or_create' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: get_or_create",
        "signal_data": {
          "function": "get_or_create",
          "write_operation": "session.add"
        }
      },
      {
        "file": "utils/db_helpers.py",
        "line": 378,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'get_or_create' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: get_or_create",
        "signal_data": {
          "function": "get_or_create",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/outbox_processor.py",
        "line": 107,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'acquire_lock' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: acquire_lock",
        "signal_data": {
          "function": "acquire_lock",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/outbox_processor.py",
        "line": 132,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'release_lock' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: release_lock",
        "signal_data": {
          "function": "release_lock",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/outbox_processor.py",
        "line": 150,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'extend_lock' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: extend_lock",
        "signal_data": {
          "function": "extend_lock",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/outbox_processor.py",
        "line": 168,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'claim_events' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: claim_events",
        "signal_data": {
          "function": "claim_events",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/outbox_processor.py",
        "line": 341,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'complete_event' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: complete_event",
        "signal_data": {
          "function": "complete_event",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/pool.py",
        "line": 111,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_mark_run_started' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _mark_run_started",
        "signal_data": {
          "function": "_mark_run_started",
          "write_operation": "session.add"
        }
      },
      {
        "file": "worker/pool.py",
        "line": 111,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_mark_run_started' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _mark_run_started",
        "signal_data": {
          "function": "_mark_run_started",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_claim_worker.py",
        "line": 107,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'claim_batch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: claim_batch",
        "signal_data": {
          "function": "claim_batch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_claim_worker.py",
        "line": 235,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'update_candidate' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_candidate",
        "signal_data": {
          "function": "update_candidate",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_claim_worker.py",
        "line": 284,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'release_pending' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: release_pending",
        "signal_data": {
          "function": "release_pending",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_evaluator.py",
        "line": 358,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_select_action' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _select_action",
        "signal_data": {
          "function": "_select_action",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_evaluator.py",
        "line": 409,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_record_provenance' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _record_provenance",
        "signal_data": {
          "function": "_record_provenance",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_evaluator.py",
        "line": 460,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_auto_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _auto_execute",
        "signal_data": {
          "function": "_auto_execute",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_evaluator.py",
        "line": 460,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_auto_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _auto_execute",
        "signal_data": {
          "function": "_auto_execute",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 175,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_update_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update_run",
        "signal_data": {
          "function": "_update_run",
          "write_operation": "session.add"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 175,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_update_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update_run",
        "signal_data": {
          "function": "_update_run",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 236,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute",
        "signal_data": {
          "function": "_execute",
          "write_operation": "session.add"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 236,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute",
        "signal_data": {
          "function": "_execute",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 236,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute",
        "signal_data": {
          "function": "_execute",
          "write_operation": "session.add"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 236,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute",
        "signal_data": {
          "function": "_execute",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 236,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute",
        "signal_data": {
          "function": "_execute",
          "write_operation": "session.add"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 236,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute",
        "signal_data": {
          "function": "_execute",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "workflow/checkpoint.py",
        "line": 227,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'save' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: save",
        "signal_data": {
          "function": "save",
          "write_operation": "session.add"
        }
      },
      {
        "file": "workflow/checkpoint.py",
        "line": 227,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'save' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: save",
        "signal_data": {
          "function": "save",
          "write_operation": "session.add"
        }
      },
      {
        "file": "workflow/checkpoint.py",
        "line": 428,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.delete' in 'delete' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete",
        "signal_data": {
          "function": "delete",
          "write_operation": "session.delete"
        }
      }
    ],
    "MISSING_SEMANTIC_HEADER": [
      {
        "file": "agents/services/blackboard_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 8 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/credit_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 11 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/governance_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 9 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/invoke_audit_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 4 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/job_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 8 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/message_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 5 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 4 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 4 lines",
        "signal_data": null
      },
      {
        "file": "api/legacy_routes.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (api_router) missing semantic header",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "No header comments found",
        "signal_data": null
      },
      {
        "file": "api/rbac_api.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (api_router) missing semantic header",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "No header comments found",
        "signal_data": null
      },
      {
        "file": "api/workers.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (worker) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 2 lines",
        "signal_data": null
      },
      {
        "file": "costsim/alert_worker.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (worker) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 1 lines",
        "signal_data": null
      },
      {
        "file": "memory/memory_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) missing semantic header",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "No header comments found",
        "signal_data": null
      }
    ],
    "LAYER_IMPORT_VIOLATION": [
      {
        "file": "api/costsim.py",
        "line": 59,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.tasks.memory_update",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.tasks.memory_update"
        }
      },
      {
        "file": "api/recovery_ingest.py",
        "line": 313,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.tasks.recovery_queue_stream",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.tasks.recovery_queue_stream"
        }
      },
      {
        "file": "api/workers.py",
        "line": 628,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.workers.business_builder.schemas.brand",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.workers.business_builder.schemas.brand"
        }
      },
      {
        "file": "api/workers.py",
        "line": 695,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.workers.business_builder.worker",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.workers.business_builder.worker"
        }
      },
      {
        "file": "api/workers.py",
        "line": 962,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.workers.business_builder.worker",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.workers.business_builder.worker"
        }
      },
      {
        "file": "api/workers.py",
        "line": 1020,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.workers.business_builder.worker",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.workers.business_builder.worker"
        }
      },
      {
        "file": "api/workers.py",
        "line": 1363,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.workers.business_builder.worker",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.workers.business_builder.worker"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 1151,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L4 imports from L6",
        "declared": "Layer L4 should not import L6",
        "observed": "Import: app.integrations.cost_bridges",
        "signal_data": {
          "source_layer": "L4",
          "target_layer": "L6",
          "import_path": "app.integrations.cost_bridges"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 1154,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L4 imports from L6",
        "declared": "Layer L4 should not import L6",
        "observed": "Import: app.integrations.cost_bridges",
        "signal_data": {
          "source_layer": "L4",
          "target_layer": "L6",
          "import_path": "app.integrations.cost_bridges"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 1157,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L4 imports from L6",
        "declared": "Layer L4 should not import L6",
        "observed": "Import: app.integrations.cost_bridges",
        "signal_data": {
          "source_layer": "L4",
          "target_layer": "L6",
          "import_path": "app.integrations.cost_bridges"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 1160,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L4 imports from L6",
        "declared": "Layer L4 should not import L6",
        "observed": "Import: app.integrations.cost_bridges",
        "signal_data": {
          "source_layer": "L4",
          "target_layer": "L6",
          "import_path": "app.integrations.cost_bridges"
        }
      }
    ],
    "INCOMPLETE_SEMANTIC_HEADER": [
      {
        "file": "api/customer_visibility.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "api/guard.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "api/v1_killswitch.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "optimization/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "optimization/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Layer",
        "declared": "# Layer: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "optimization/envelopes/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "optimization/envelopes/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Layer",
        "declared": "# Layer: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "routing/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "routing/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Layer",
        "declared": "# Layer: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "security/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/certificate.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/email_verification.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/event_emitter.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/evidence_report.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/pattern_detection.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/policy_proposal.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/prediction.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/recovery_matcher.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/recovery_rule_engine.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      }
    ],
    "ASYNC_BLOCKING_CALL": [
      {
        "file": "api/status_history.py",
        "line": 295,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function 'create_export' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "create_export",
          "blocking_call": "open"
        }
      },
      {
        "file": "api/status_history.py",
        "line": 295,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function 'create_export' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "create_export",
          "blocking_call": "open"
        }
      },
      {
        "file": "api/status_history.py",
        "line": 362,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function 'download_export' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "download_export",
          "blocking_call": "open"
        }
      },
      {
        "file": "costsim/canary.py",
        "line": 574,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function '_save_artifacts' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "_save_artifacts",
          "blocking_call": "open"
        }
      },
      {
        "file": "costsim/canary.py",
        "line": 574,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function '_save_artifacts' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "_save_artifacts",
          "blocking_call": "open"
        }
      },
      {
        "file": "costsim/canary.py",
        "line": 574,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function '_save_artifacts' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "_save_artifacts",
          "blocking_call": "open"
        }
      },
      {
        "file": "costsim/provenance.py",
        "line": 268,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function '_write_to_file' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "_write_to_file",
          "blocking_call": "open"
        }
      },
      {
        "file": "costsim/provenance.py",
        "line": 300,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function 'query' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "query",
          "blocking_call": "open"
        }
      },
      {
        "file": "stores/checkpoint_offload.py",
        "line": 369,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function 'restore_checkpoint_from_r2' calls blocking 'read'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: read",
        "signal_data": {
          "function": "restore_checkpoint_from_r2",
          "blocking_call": "read"
        }
      },
      {
        "file": "stores/checkpoint_offload.py",
        "line": 369,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function 'restore_checkpoint_from_r2' calls blocking 'read'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: read",
        "signal_data": {
          "function": "restore_checkpoint_from_r2",
          "blocking_call": "read"
        }
      },
      {
        "file": "workflow/golden.py",
        "line": 316,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function '_append' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "_append",
          "blocking_call": "open"
        }
      }
    ]
  },
  "findings_by_severity": {
    "INFO": [
      {
        "file": "api/customer_visibility.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "api/guard.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "api/v1_killswitch.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "optimization/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "optimization/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Layer",
        "declared": "# Layer: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "optimization/envelopes/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "optimization/envelopes/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Layer",
        "declared": "# Layer: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "routing/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "routing/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Layer",
        "declared": "# Layer: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "security/__init__.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/certificate.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/email_verification.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/event_emitter.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/evidence_report.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/pattern_detection.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/policy_proposal.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/prediction.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/recovery_matcher.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      },
      {
        "file": "services/recovery_rule_engine.py",
        "line": 1,
        "type": "INCOMPLETE_SEMANTIC_HEADER",
        "severity": "INFO",
        "message": "Semantic header missing required field: Role",
        "declared": "# Role: <value>",
        "observed": "Field not present",
        "signal_data": null
      }
    ],
    "WARNING": [
      {
        "file": "agents/services/blackboard_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 8 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/credit_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 11 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/governance_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 9 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/invoke_audit_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 4 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/job_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 8 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/message_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 5 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 4 lines",
        "signal_data": null
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 4 lines",
        "signal_data": null
      },
      {
        "file": "api/costsim.py",
        "line": 59,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.tasks.memory_update",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.tasks.memory_update"
        }
      },
      {
        "file": "api/legacy_routes.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (api_router) missing semantic header",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "No header comments found",
        "signal_data": null
      },
      {
        "file": "api/rbac_api.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (api_router) missing semantic header",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "No header comments found",
        "signal_data": null
      },
      {
        "file": "api/recovery_ingest.py",
        "line": 313,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.tasks.recovery_queue_stream",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.tasks.recovery_queue_stream"
        }
      },
      {
        "file": "api/workers.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (worker) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 2 lines",
        "signal_data": null
      },
      {
        "file": "api/workers.py",
        "line": 628,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.workers.business_builder.schemas.brand",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.workers.business_builder.schemas.brand"
        }
      },
      {
        "file": "api/workers.py",
        "line": 695,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.workers.business_builder.worker",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.workers.business_builder.worker"
        }
      },
      {
        "file": "api/workers.py",
        "line": 962,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.workers.business_builder.worker",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.workers.business_builder.worker"
        }
      },
      {
        "file": "api/workers.py",
        "line": 1020,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.workers.business_builder.worker",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.workers.business_builder.worker"
        }
      },
      {
        "file": "api/workers.py",
        "line": 1363,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L5 imports from L7",
        "declared": "Layer L5 should not import L7",
        "observed": "Import: app.workers.business_builder.worker",
        "signal_data": {
          "source_layer": "L5",
          "target_layer": "L7",
          "import_path": "app.workers.business_builder.worker"
        }
      },
      {
        "file": "costsim/alert_worker.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (worker) has comments but no semantic header fields",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "Comments found: 1 lines",
        "signal_data": null
      },
      {
        "file": "memory/memory_service.py",
        "line": 1,
        "type": "MISSING_SEMANTIC_HEADER",
        "severity": "WARNING",
        "message": "Boundary file (service) missing semantic header",
        "declared": "Semantic header with Layer, Role, etc.",
        "observed": "No header comments found",
        "signal_data": null
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 1151,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L4 imports from L6",
        "declared": "Layer L4 should not import L6",
        "observed": "Import: app.integrations.cost_bridges",
        "signal_data": {
          "source_layer": "L4",
          "target_layer": "L6",
          "import_path": "app.integrations.cost_bridges"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 1154,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L4 imports from L6",
        "declared": "Layer L4 should not import L6",
        "observed": "Import: app.integrations.cost_bridges",
        "signal_data": {
          "source_layer": "L4",
          "target_layer": "L6",
          "import_path": "app.integrations.cost_bridges"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 1157,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L4 imports from L6",
        "declared": "Layer L4 should not import L6",
        "observed": "Import: app.integrations.cost_bridges",
        "signal_data": {
          "source_layer": "L4",
          "target_layer": "L6",
          "import_path": "app.integrations.cost_bridges"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 1160,
        "type": "LAYER_IMPORT_VIOLATION",
        "severity": "WARNING",
        "message": "L4 imports from L6",
        "declared": "Layer L4 should not import L6",
        "observed": "Import: app.integrations.cost_bridges",
        "signal_data": {
          "source_layer": "L4",
          "target_layer": "L6",
          "import_path": "app.integrations.cost_bridges"
        }
      }
    ],
    "HIGH_RISK": [
      {
        "file": "cli.py",
        "line": 70,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'create_agent' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_agent",
        "signal_data": {
          "function": "create_agent",
          "write_operation": "session.add"
        }
      },
      {
        "file": "cli.py",
        "line": 70,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'create_agent' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_agent",
        "signal_data": {
          "function": "create_agent",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "cli.py",
        "line": 122,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'create_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_run",
        "signal_data": {
          "function": "create_run",
          "write_operation": "session.add"
        }
      },
      {
        "file": "cli.py",
        "line": 122,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'create_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_run",
        "signal_data": {
          "function": "create_run",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "cli.py",
        "line": 168,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'run_goal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: run_goal",
        "signal_data": {
          "function": "run_goal",
          "write_operation": "session.add"
        }
      },
      {
        "file": "cli.py",
        "line": 168,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'run_goal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: run_goal",
        "signal_data": {
          "function": "run_goal",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "db.py",
        "line": 938,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'log_status_change' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: log_status_change",
        "signal_data": {
          "function": "log_status_change",
          "write_operation": "session.add"
        }
      },
      {
        "file": "db.py",
        "line": 938,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'log_status_change' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: log_status_change",
        "signal_data": {
          "function": "log_status_change",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 562,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute_run_inner",
        "signal_data": {
          "function": "_execute_run_inner",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 852,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'create_agent' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_agent",
        "signal_data": {
          "function": "create_agent",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 852,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'create_agent' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_agent",
        "signal_data": {
          "function": "create_agent",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 885,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'post_goal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: post_goal",
        "signal_data": {
          "function": "post_goal",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 885,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'post_goal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: post_goal",
        "signal_data": {
          "function": "post_goal",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "main.py",
        "line": 1190,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'retry_failed_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: retry_failed_run",
        "signal_data": {
          "function": "retry_failed_run",
          "write_operation": "session.add"
        }
      },
      {
        "file": "main.py",
        "line": 1190,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'retry_failed_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: retry_failed_run",
        "signal_data": {
          "function": "retry_failed_run",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/sba/evolution.py",
        "line": 273,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_persist_violation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_violation",
        "signal_data": {
          "function": "_persist_violation",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "agents/sba/evolution.py",
        "line": 458,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_persist_drift_signal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_drift_signal",
        "signal_data": {
          "function": "_persist_drift_signal",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "agents/sba/evolution.py",
        "line": 582,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'apply_adjustment' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: apply_adjustment",
        "signal_data": {
          "function": "apply_adjustment",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "agents/sba/evolution.py",
        "line": 651,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_persist_adjustment' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_adjustment",
        "signal_data": {
          "function": "_persist_adjustment",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "agents/sba/service.py",
        "line": 87,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'register_agent' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: register_agent",
        "signal_data": {
          "function": "register_agent",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/sba/service.py",
        "line": 369,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'update_sba' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_sba",
        "signal_data": {
          "function": "update_sba",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/sba/service.py",
        "line": 408,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'update_fulfillment_metric' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_fulfillment_metric",
        "signal_data": {
          "function": "update_fulfillment_metric",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/sba/service.py",
        "line": 579,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'retrofit_missing_sba' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: retrofit_missing_sba",
        "signal_data": {
          "function": "retrofit_missing_sba",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/credit_service.py",
        "line": 187,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'log_reservation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: log_reservation",
        "signal_data": {
          "function": "log_reservation",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/credit_service.py",
        "line": 276,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'spend_for_item' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: spend_for_item",
        "signal_data": {
          "function": "spend_for_item",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/credit_service.py",
        "line": 324,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'refund_for_item' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: refund_for_item",
        "signal_data": {
          "function": "refund_for_item",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/credit_service.py",
        "line": 381,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'charge_skill' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: charge_skill",
        "signal_data": {
          "function": "charge_skill",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/governance_service.py",
        "line": 220,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'update_job_budget' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_job_budget",
        "signal_data": {
          "function": "update_job_budget",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/governance_service.py",
        "line": 315,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'allocate_worker_budget' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: allocate_worker_budget",
        "signal_data": {
          "function": "allocate_worker_budget",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/governance_service.py",
        "line": 436,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'record_item_llm_usage' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_item_llm_usage",
        "signal_data": {
          "function": "record_item_llm_usage",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/invoke_audit_service.py",
        "line": 63,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'start_invoke' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: start_invoke",
        "signal_data": {
          "function": "start_invoke",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/invoke_audit_service.py",
        "line": 131,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'complete_invoke' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: complete_invoke",
        "signal_data": {
          "function": "complete_invoke",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/invoke_audit_service.py",
        "line": 185,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'fail_invoke' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: fail_invoke",
        "signal_data": {
          "function": "fail_invoke",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/job_service.py",
        "line": 127,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'create_job' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_job",
        "signal_data": {
          "function": "create_job",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/job_service.py",
        "line": 406,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'check_job_completion' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: check_job_completion",
        "signal_data": {
          "function": "check_job_completion",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/job_service.py",
        "line": 468,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'cancel_job' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: cancel_job",
        "signal_data": {
          "function": "cancel_job",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/message_service.py",
        "line": 97,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'send' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: send",
        "signal_data": {
          "function": "send",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/message_service.py",
        "line": 289,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'mark_delivered' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: mark_delivered",
        "signal_data": {
          "function": "mark_delivered",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/message_service.py",
        "line": 312,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'mark_read' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: mark_read",
        "signal_data": {
          "function": "mark_read",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/message_service.py",
        "line": 512,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'cleanup_old_messages' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: cleanup_old_messages",
        "signal_data": {
          "function": "cleanup_old_messages",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 81,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'register' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: register",
        "signal_data": {
          "function": "register",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 157,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'heartbeat' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: heartbeat",
        "signal_data": {
          "function": "heartbeat",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 198,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'deregister' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: deregister",
        "signal_data": {
          "function": "deregister",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 336,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'mark_instance_stale' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: mark_instance_stale",
        "signal_data": {
          "function": "mark_instance_stale",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 376,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'mark_stale' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: mark_stale",
        "signal_data": {
          "function": "mark_stale",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 376,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'mark_stale' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: mark_stale",
        "signal_data": {
          "function": "mark_stale",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 428,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'reclaim_stale_items' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: reclaim_stale_items",
        "signal_data": {
          "function": "reclaim_stale_items",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/registry_service.py",
        "line": 428,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'reclaim_stale_items' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: reclaim_stale_items",
        "signal_data": {
          "function": "reclaim_stale_items",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 76,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'claim_item' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: claim_item",
        "signal_data": {
          "function": "claim_item",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 172,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_claim_item_raw' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _claim_item_raw",
        "signal_data": {
          "function": "_claim_item_raw",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 277,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'start_item' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: start_item",
        "signal_data": {
          "function": "start_item",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 308,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'complete_item' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: complete_item",
        "signal_data": {
          "function": "complete_item",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 436,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'fail_item' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: fail_item",
        "signal_data": {
          "function": "fail_item",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/services/worker_service.py",
        "line": 557,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'release_claimed' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: release_claimed",
        "signal_data": {
          "function": "release_claimed",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/skills/agent_invoke.py",
        "line": 253,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_create_invocation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _create_invocation",
        "signal_data": {
          "function": "_create_invocation",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/skills/agent_invoke.py",
        "line": 407,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_fail_invocation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _fail_invocation",
        "signal_data": {
          "function": "_fail_invocation",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/skills/agent_invoke.py",
        "line": 425,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_timeout_invocation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _timeout_invocation",
        "signal_data": {
          "function": "_timeout_invocation",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/skills/agent_invoke.py",
        "line": 444,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'respond_to_invoke' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: respond_to_invoke",
        "signal_data": {
          "function": "respond_to_invoke",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "agents/skills/llm_invoke_governed.py",
        "line": 370,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_record_governance_data' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _record_governance_data",
        "signal_data": {
          "function": "_record_governance_data",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/agents.py",
        "line": 2101,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'update_agent_strategy' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_agent_strategy",
        "signal_data": {
          "function": "update_agent_strategy",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "api/founder_actions.py",
        "line": 259,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in 'execute_action' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: execute_action",
        "signal_data": {
          "function": "execute_action",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/founder_actions.py",
        "line": 517,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in 'execute_reversal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: execute_reversal",
        "signal_data": {
          "function": "execute_reversal",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/integration.py",
        "line": 900,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'simulate_prevention' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: simulate_prevention",
        "signal_data": {
          "function": "simulate_prevention",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/integration.py",
        "line": 978,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'simulate_regret' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: simulate_regret",
        "signal_data": {
          "function": "simulate_regret",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/integration.py",
        "line": 1070,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'simulate_timeline_view' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: simulate_timeline_view",
        "signal_data": {
          "function": "simulate_timeline_view",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/integration.py",
        "line": 1132,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'record_timeline_view' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_timeline_view",
        "signal_data": {
          "function": "record_timeline_view",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/integration.py",
        "line": 1198,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'trigger_graduation_re_evaluation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: trigger_graduation_re_evaluation",
        "signal_data": {
          "function": "trigger_graduation_re_evaluation",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/memory_pins.py",
        "line": 135,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'write_memory_audit' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: write_memory_audit",
        "signal_data": {
          "function": "write_memory_audit",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "api/memory_pins.py",
        "line": 192,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'create_or_upsert_pin' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_or_upsert_pin",
        "signal_data": {
          "function": "create_or_upsert_pin",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "api/memory_pins.py",
        "line": 448,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'delete_pin' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete_pin",
        "signal_data": {
          "function": "delete_pin",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "api/memory_pins.py",
        "line": 505,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'cleanup_expired_pins' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: cleanup_expired_pins",
        "signal_data": {
          "function": "cleanup_expired_pins",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 627,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'create_approval_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_approval_request",
        "signal_data": {
          "function": "create_approval_request",
          "write_operation": "session.add"
        }
      },
      {
        "file": "api/policy.py",
        "line": 627,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'create_approval_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_approval_request",
        "signal_data": {
          "function": "create_approval_request",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 704,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'get_approval_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: get_approval_request",
        "signal_data": {
          "function": "get_approval_request",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 825,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'approve_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: approve_request",
        "signal_data": {
          "function": "approve_request",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 825,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'approve_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: approve_request",
        "signal_data": {
          "function": "approve_request",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 892,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'reject_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: reject_request",
        "signal_data": {
          "function": "reject_request",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 939,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'list_approval_requests' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: list_approval_requests",
        "signal_data": {
          "function": "list_approval_requests",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/policy.py",
        "line": 1011,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'run_escalation_check' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: run_escalation_check",
        "signal_data": {
          "function": "run_escalation_check",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/rbac_api.py",
        "line": 291,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'cleanup_audit_logs' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: cleanup_audit_logs",
        "signal_data": {
          "function": "cleanup_audit_logs",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "api/recovery.py",
        "line": 576,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in 'update_candidate' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_candidate",
        "signal_data": {
          "function": "update_candidate",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/recovery_ingest.py",
        "line": 117,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in 'ingest_failure' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: ingest_failure",
        "signal_data": {
          "function": "ingest_failure",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/recovery_ingest.py",
        "line": 286,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in '_enqueue_evaluation_async' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _enqueue_evaluation_async",
        "signal_data": {
          "function": "_enqueue_evaluation_async",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/status_history.py",
        "line": 295,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function 'create_export' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "create_export",
          "blocking_call": "open"
        }
      },
      {
        "file": "api/status_history.py",
        "line": 295,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function 'create_export' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "create_export",
          "blocking_call": "open"
        }
      },
      {
        "file": "api/status_history.py",
        "line": 362,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function 'download_export' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "download_export",
          "blocking_call": "open"
        }
      },
      {
        "file": "api/traces.py",
        "line": 653,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'bulk_report_mismatches' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: bulk_report_mismatches",
        "signal_data": {
          "function": "bulk_report_mismatches",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/traces.py",
        "line": 778,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'report_mismatch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: report_mismatch",
        "signal_data": {
          "function": "report_mismatch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/traces.py",
        "line": 778,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'report_mismatch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: report_mismatch",
        "signal_data": {
          "function": "report_mismatch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/traces.py",
        "line": 778,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'report_mismatch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: report_mismatch",
        "signal_data": {
          "function": "report_mismatch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/traces.py",
        "line": 1015,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'resolve_mismatch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: resolve_mismatch",
        "signal_data": {
          "function": "resolve_mismatch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/v1_proxy.py",
        "line": 248,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'record_usage_after_killswitch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_usage_after_killswitch",
        "signal_data": {
          "function": "record_usage_after_killswitch",
          "write_operation": "session.add"
        }
      },
      {
        "file": "api/v1_proxy.py",
        "line": 248,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'record_usage_after_killswitch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_usage_after_killswitch",
        "signal_data": {
          "function": "record_usage_after_killswitch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/v1_proxy.py",
        "line": 430,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'log_proxy_call' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: log_proxy_call",
        "signal_data": {
          "function": "log_proxy_call",
          "write_operation": "session.add"
        }
      },
      {
        "file": "api/v1_proxy.py",
        "line": 430,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'log_proxy_call' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: log_proxy_call",
        "signal_data": {
          "function": "log_proxy_call",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "api/workers.py",
        "line": 194,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in '_store_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _store_run",
        "signal_data": {
          "function": "_store_run",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/workers.py",
        "line": 235,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in '_insert_cost_record' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert_cost_record",
        "signal_data": {
          "function": "_insert_cost_record",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/workers.py",
        "line": 273,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in '_check_and_emit_cost_advisory' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _check_and_emit_cost_advisory",
        "signal_data": {
          "function": "_check_and_emit_cost_advisory",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "api/workers.py",
        "line": 1208,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'write_service.commit' in 'delete_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete_run",
        "signal_data": {
          "function": "delete_run",
          "write_operation": "write_service.commit"
        }
      },
      {
        "file": "auth/rbac_engine.py",
        "line": 396,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_audit' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _audit",
        "signal_data": {
          "function": "_audit",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "auth/tenant_auth.py",
        "line": 145,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'validate_api_key_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: validate_api_key_db",
        "signal_data": {
          "function": "validate_api_key_db",
          "write_operation": "session.add"
        }
      },
      {
        "file": "auth/tenant_auth.py",
        "line": 145,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'validate_api_key_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: validate_api_key_db",
        "signal_data": {
          "function": "validate_api_key_db",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "config/flag_sync.py",
        "line": 109,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'sync_file_to_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: sync_file_to_db",
        "signal_data": {
          "function": "sync_file_to_db",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "config/flag_sync.py",
        "line": 109,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'sync_file_to_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: sync_file_to_db",
        "signal_data": {
          "function": "sync_file_to_db",
          "write_operation": "session.add"
        }
      },
      {
        "file": "contracts/decisions.py",
        "line": 949,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'backfill_run_id_for_request' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: backfill_run_id_for_request",
        "signal_data": {
          "function": "backfill_run_id_for_request",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "contracts/decisions.py",
        "line": 182,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'emit' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: emit",
        "signal_data": {
          "function": "emit",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "contracts/decisions.py",
        "line": 264,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_emit_sync_impl' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _emit_sync_impl",
        "signal_data": {
          "function": "_emit_sync_impl",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "costsim/alert_worker.py",
        "line": 303,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'enqueue_alert' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: enqueue_alert",
        "signal_data": {
          "function": "enqueue_alert",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/alert_worker.py",
        "line": 303,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'enqueue_alert' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: enqueue_alert",
        "signal_data": {
          "function": "enqueue_alert",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/alert_worker.py",
        "line": 357,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'retry_failed_alerts' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: retry_failed_alerts",
        "signal_data": {
          "function": "retry_failed_alerts",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/alert_worker.py",
        "line": 395,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'purge_old_alerts' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: purge_old_alerts",
        "signal_data": {
          "function": "purge_old_alerts",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/alert_worker.py",
        "line": 95,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'process_batch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: process_batch",
        "signal_data": {
          "function": "process_batch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/canary.py",
        "line": 574,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function '_save_artifacts' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "_save_artifacts",
          "blocking_call": "open"
        }
      },
      {
        "file": "costsim/canary.py",
        "line": 574,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function '_save_artifacts' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "_save_artifacts",
          "blocking_call": "open"
        }
      },
      {
        "file": "costsim/canary.py",
        "line": 574,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function '_save_artifacts' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "_save_artifacts",
          "blocking_call": "open"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 206,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_get_or_create_state' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_or_create_state",
        "signal_data": {
          "function": "_get_or_create_state",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 206,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_get_or_create_state' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_or_create_state",
        "signal_data": {
          "function": "_get_or_create_state",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 271,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_auto_recover' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _auto_recover",
        "signal_data": {
          "function": "_auto_recover",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 350,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'report_drift' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: report_drift",
        "signal_data": {
          "function": "report_drift",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 350,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'report_drift' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: report_drift",
        "signal_data": {
          "function": "report_drift",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 498,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'reset' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: reset",
        "signal_data": {
          "function": "reset",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 573,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_trip' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _trip",
        "signal_data": {
          "function": "_trip",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 573,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_trip' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _trip",
        "signal_data": {
          "function": "_trip",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 573,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_trip' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _trip",
        "signal_data": {
          "function": "_trip",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker.py",
        "line": 683,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_resolve_incident_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _resolve_incident_db",
        "signal_data": {
          "function": "_resolve_incident_db",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 130,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_get_or_create_state' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_or_create_state",
        "signal_data": {
          "function": "_get_or_create_state",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 130,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in '_get_or_create_state' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_or_create_state",
        "signal_data": {
          "function": "_get_or_create_state",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 229,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in '_try_auto_recover' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _try_auto_recover",
        "signal_data": {
          "function": "_try_auto_recover",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 321,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_auto_recover' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _auto_recover",
        "signal_data": {
          "function": "_auto_recover",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 598,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_trip' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _trip",
        "signal_data": {
          "function": "_trip",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 598,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in '_trip' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _trip",
        "signal_data": {
          "function": "_trip",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 694,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_resolve_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _resolve_incident",
        "signal_data": {
          "function": "_resolve_incident",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 762,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_enqueue_alert' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _enqueue_alert",
        "signal_data": {
          "function": "_enqueue_alert",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/circuit_breaker_async.py",
        "line": 762,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in '_enqueue_alert' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _enqueue_alert",
        "signal_data": {
          "function": "_enqueue_alert",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "costsim/provenance.py",
        "line": 268,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function '_write_to_file' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "_write_to_file",
          "blocking_call": "open"
        }
      },
      {
        "file": "costsim/provenance.py",
        "line": 300,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function 'query' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "query",
          "blocking_call": "open"
        }
      },
      {
        "file": "costsim/provenance_async.py",
        "line": 61,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'write_provenance' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: write_provenance",
        "signal_data": {
          "function": "write_provenance",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/provenance_async.py",
        "line": 61,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'write_provenance' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: write_provenance",
        "signal_data": {
          "function": "write_provenance",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "costsim/provenance_async.py",
        "line": 146,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'write_provenance_batch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: write_provenance_batch",
        "signal_data": {
          "function": "write_provenance_batch",
          "write_operation": "session.add"
        }
      },
      {
        "file": "costsim/provenance_async.py",
        "line": 146,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'write_provenance_batch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: write_provenance_batch",
        "signal_data": {
          "function": "write_provenance_batch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "discovery/ledger.py",
        "line": 50,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'emit_signal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: emit_signal",
        "signal_data": {
          "function": "emit_signal",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "integrations/bridges.py",
        "line": 111,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'record_policy_activation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_policy_activation",
        "signal_data": {
          "function": "record_policy_activation",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/bridges.py",
        "line": 415,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_increment_pattern_count' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _increment_pattern_count",
        "signal_data": {
          "function": "_increment_pattern_count",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/bridges.py",
        "line": 432,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_create_pattern' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _create_pattern",
        "signal_data": {
          "function": "_create_pattern",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/bridges.py",
        "line": 668,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_persist_recovery' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_recovery",
        "signal_data": {
          "function": "_persist_recovery",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/bridges.py",
        "line": 867,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_persist_policy' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_policy",
        "signal_data": {
          "function": "_persist_policy",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/bridges.py",
        "line": 1142,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_persist_adjustment' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_adjustment",
        "signal_data": {
          "function": "_persist_adjustment",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/cost_snapshots.py",
        "line": 623,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_insert_snapshot' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert_snapshot",
        "signal_data": {
          "function": "_insert_snapshot",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "integrations/cost_snapshots.py",
        "line": 651,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_update_snapshot' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update_snapshot",
        "signal_data": {
          "function": "_update_snapshot",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "integrations/cost_snapshots.py",
        "line": 675,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_insert_aggregate' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert_aggregate",
        "signal_data": {
          "function": "_insert_aggregate",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "integrations/cost_snapshots.py",
        "line": 794,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_insert_baseline' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert_baseline",
        "signal_data": {
          "function": "_insert_baseline",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "integrations/cost_snapshots.py",
        "line": 971,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_insert_evaluation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert_evaluation",
        "signal_data": {
          "function": "_insert_evaluation",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "integrations/cost_snapshots.py",
        "line": 1005,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_create_anomaly_from_evaluation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _create_anomaly_from_evaluation",
        "signal_data": {
          "function": "_create_anomaly_from_evaluation",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "integrations/dispatcher.py",
        "line": 516,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_persist_event' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_event",
        "signal_data": {
          "function": "_persist_event",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/dispatcher.py",
        "line": 555,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_persist_loop_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_loop_status",
        "signal_data": {
          "function": "_persist_loop_status",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/dispatcher.py",
        "line": 591,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_persist_checkpoint' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_checkpoint",
        "signal_data": {
          "function": "_persist_checkpoint",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "integrations/graduation_engine.py",
        "line": 757,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'persist_graduation_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_graduation_status",
        "signal_data": {
          "function": "persist_graduation_status",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "jobs/graduation_evaluator.py",
        "line": 38,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'evaluate_graduation_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: evaluate_graduation_status",
        "signal_data": {
          "function": "evaluate_graduation_status",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "jobs/storage.py",
        "line": 451,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_record_export_to_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _record_export_to_db",
        "signal_data": {
          "function": "_record_export_to_db",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "jobs/storage.py",
        "line": 491,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_update_export_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update_export_status",
        "signal_data": {
          "function": "_update_export_status",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/memory_service.py",
        "line": 303,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'set' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: set",
        "signal_data": {
          "function": "set",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/memory_service.py",
        "line": 415,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'delete' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete",
        "signal_data": {
          "function": "delete",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/memory_service.py",
        "line": 565,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_audit' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _audit",
        "signal_data": {
          "function": "_audit",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/store.py",
        "line": 64,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'store' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: store",
        "signal_data": {
          "function": "store",
          "write_operation": "session.add"
        }
      },
      {
        "file": "memory/store.py",
        "line": 64,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'store' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: store",
        "signal_data": {
          "function": "store",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/store.py",
        "line": 195,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.delete' in 'delete' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete",
        "signal_data": {
          "function": "delete",
          "write_operation": "session.delete"
        }
      },
      {
        "file": "memory/store.py",
        "line": 195,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'delete' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete",
        "signal_data": {
          "function": "delete",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/vector_store.py",
        "line": 266,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'store' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: store",
        "signal_data": {
          "function": "store",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/vector_store.py",
        "line": 594,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'delete' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete",
        "signal_data": {
          "function": "delete",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "memory/vector_store.py",
        "line": 604,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'backfill_embeddings' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: backfill_embeddings",
        "signal_data": {
          "function": "backfill_embeddings",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "optimization/audit_persistence.py",
        "line": 62,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.add' in 'persist_audit_record' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_audit_record",
        "signal_data": {
          "function": "persist_audit_record",
          "write_operation": "db.add"
        }
      },
      {
        "file": "optimization/audit_persistence.py",
        "line": 62,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'persist_audit_record' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_audit_record",
        "signal_data": {
          "function": "persist_audit_record",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1186,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_persist_evaluation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_evaluation",
        "signal_data": {
          "function": "_persist_evaluation",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1186,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_persist_evaluation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_evaluation",
        "signal_data": {
          "function": "_persist_evaluation",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1417,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'acknowledge_violation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: acknowledge_violation",
        "signal_data": {
          "function": "acknowledge_violation",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1467,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'update_risk_ceiling' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_risk_ceiling",
        "signal_data": {
          "function": "update_risk_ceiling",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1502,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'reset_risk_ceiling' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: reset_risk_ceiling",
        "signal_data": {
          "function": "reset_risk_ceiling",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1543,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'update_safety_rule' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_safety_rule",
        "signal_data": {
          "function": "update_safety_rule",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1723,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'create_policy_version' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_policy_version",
        "signal_data": {
          "function": "create_policy_version",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 1790,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'rollback_to_version' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: rollback_to_version",
        "signal_data": {
          "function": "rollback_to_version",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 2007,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'resolve_conflict' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: resolve_conflict",
        "signal_data": {
          "function": "resolve_conflict",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 2076,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'create_temporal_policy' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_temporal_policy",
        "signal_data": {
          "function": "create_temporal_policy",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 2456,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'add_dependency_with_dag_check' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: add_dependency_with_dag_check",
        "signal_data": {
          "function": "add_dependency_with_dag_check",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 2615,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'prune_temporal_metrics' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: prune_temporal_metrics",
        "signal_data": {
          "function": "prune_temporal_metrics",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "policy/engine.py",
        "line": 2786,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'activate_policy_version' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: activate_policy_version",
        "signal_data": {
          "function": "activate_policy_version",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "predictions/api.py",
        "line": 65,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.add' in 'create_incident_risk_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_incident_risk_prediction",
        "signal_data": {
          "function": "create_incident_risk_prediction",
          "write_operation": "db.add"
        }
      },
      {
        "file": "predictions/api.py",
        "line": 65,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'create_incident_risk_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_incident_risk_prediction",
        "signal_data": {
          "function": "create_incident_risk_prediction",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "predictions/api.py",
        "line": 144,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.add' in 'create_spend_spike_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_spend_spike_prediction",
        "signal_data": {
          "function": "create_spend_spike_prediction",
          "write_operation": "db.add"
        }
      },
      {
        "file": "predictions/api.py",
        "line": 144,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'create_spend_spike_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_spend_spike_prediction",
        "signal_data": {
          "function": "create_spend_spike_prediction",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "predictions/api.py",
        "line": 202,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.add' in 'create_policy_drift_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_policy_drift_prediction",
        "signal_data": {
          "function": "create_policy_drift_prediction",
          "write_operation": "db.add"
        }
      },
      {
        "file": "predictions/api.py",
        "line": 202,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'db.commit' in 'create_policy_drift_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_policy_drift_prediction",
        "signal_data": {
          "function": "create_policy_drift_prediction",
          "write_operation": "db.commit"
        }
      },
      {
        "file": "routing/care.py",
        "line": 432,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_persist_decision' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_decision",
        "signal_data": {
          "function": "_persist_decision",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "runtime/failure_catalog.py",
        "line": 577,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'persist_failure_match' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_failure_match",
        "signal_data": {
          "function": "persist_failure_match",
          "write_operation": "session.add"
        }
      },
      {
        "file": "runtime/failure_catalog.py",
        "line": 577,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'persist_failure_match' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_failure_match",
        "signal_data": {
          "function": "persist_failure_match",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "runtime/failure_catalog.py",
        "line": 791,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'update_recovery_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_recovery_status",
        "signal_data": {
          "function": "update_recovery_status",
          "write_operation": "session.add"
        }
      },
      {
        "file": "runtime/failure_catalog.py",
        "line": 791,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'update_recovery_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_recovery_status",
        "signal_data": {
          "function": "update_recovery_status",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 676,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_record_breach_and_get_consecutive_count' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _record_breach_and_get_consecutive_count",
        "signal_data": {
          "function": "_record_breach_and_get_consecutive_count",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 784,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_update_drift_tracking' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update_drift_tracking",
        "signal_data": {
          "function": "_update_drift_tracking",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 784,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_update_drift_tracking' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update_drift_tracking",
        "signal_data": {
          "function": "_update_drift_tracking",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 878,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_reset_drift_tracking' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _reset_drift_tracking",
        "signal_data": {
          "function": "_reset_drift_tracking",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/cost_anomaly_detector.py",
        "line": 1039,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'persist_anomalies' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_anomalies",
        "signal_data": {
          "function": "persist_anomalies",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 263,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_get_rate_limit_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_rate_limit_incident",
        "signal_data": {
          "function": "_get_rate_limit_incident",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 263,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_get_rate_limit_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_rate_limit_incident",
        "signal_data": {
          "function": "_get_rate_limit_incident",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 263,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_get_rate_limit_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_rate_limit_incident",
        "signal_data": {
          "function": "_get_rate_limit_incident",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 263,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_get_rate_limit_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _get_rate_limit_incident",
        "signal_data": {
          "function": "_get_rate_limit_incident",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 311,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_create_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _create_incident",
        "signal_data": {
          "function": "_create_incident",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 311,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_create_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _create_incident",
        "signal_data": {
          "function": "_create_incident",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 366,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_add_call_to_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _add_call_to_incident",
        "signal_data": {
          "function": "_add_call_to_incident",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 366,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_add_call_to_incident' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _add_call_to_incident",
        "signal_data": {
          "function": "_add_call_to_incident",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 448,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_add_incident_event' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _add_incident_event",
        "signal_data": {
          "function": "_add_incident_event",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 448,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_add_incident_event' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _add_incident_event",
        "signal_data": {
          "function": "_add_incident_event",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 471,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'resolve_stale_incidents' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: resolve_stale_incidents",
        "signal_data": {
          "function": "resolve_stale_incidents",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/incident_aggregator.py",
        "line": 471,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'resolve_stale_incidents' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: resolve_stale_incidents",
        "signal_data": {
          "function": "resolve_stale_incidents",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/llm_failure_service.py",
        "line": 128,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self._session.commit' in 'persist_failure_and_mark_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_failure_and_mark_run",
        "signal_data": {
          "function": "persist_failure_and_mark_run",
          "write_operation": "self._session.commit"
        }
      },
      {
        "file": "services/orphan_recovery.py",
        "line": 114,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'recover_orphaned_runs' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: recover_orphaned_runs",
        "signal_data": {
          "function": "recover_orphaned_runs",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/pattern_detection.py",
        "line": 227,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'emit_feedback' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: emit_feedback",
        "signal_data": {
          "function": "emit_feedback",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/pattern_detection.py",
        "line": 227,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in 'emit_feedback' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: emit_feedback",
        "signal_data": {
          "function": "emit_feedback",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "services/pattern_detection.py",
        "line": 268,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'run_pattern_detection' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: run_pattern_detection",
        "signal_data": {
          "function": "run_pattern_detection",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/policy_proposal.py",
        "line": 115,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'create_policy_proposal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_policy_proposal",
        "signal_data": {
          "function": "create_policy_proposal",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/policy_proposal.py",
        "line": 115,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in 'create_policy_proposal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_policy_proposal",
        "signal_data": {
          "function": "create_policy_proposal",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "services/policy_proposal.py",
        "line": 153,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'review_policy_proposal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: review_policy_proposal",
        "signal_data": {
          "function": "review_policy_proposal",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/policy_proposal.py",
        "line": 153,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in 'review_policy_proposal' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: review_policy_proposal",
        "signal_data": {
          "function": "review_policy_proposal",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "services/policy_proposal.py",
        "line": 232,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'generate_proposals_from_feedback' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: generate_proposals_from_feedback",
        "signal_data": {
          "function": "generate_proposals_from_feedback",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/policy_violation_service.py",
        "line": 110,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'persist_violation_fact' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_violation_fact",
        "signal_data": {
          "function": "persist_violation_fact",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/policy_violation_service.py",
        "line": 194,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'persist_evidence' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: persist_evidence",
        "signal_data": {
          "function": "persist_evidence",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/policy_violation_service.py",
        "line": 262,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'sync_session.commit' in 'create_incident_from_violation' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_incident_from_violation",
        "signal_data": {
          "function": "create_incident_from_violation",
          "write_operation": "sync_session.commit"
        }
      },
      {
        "file": "services/prediction.py",
        "line": 276,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'emit_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: emit_prediction",
        "signal_data": {
          "function": "emit_prediction",
          "write_operation": "session.add"
        }
      },
      {
        "file": "services/prediction.py",
        "line": 276,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.flush' in 'emit_prediction' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: emit_prediction",
        "signal_data": {
          "function": "emit_prediction",
          "write_operation": "session.flush"
        }
      },
      {
        "file": "services/prediction.py",
        "line": 318,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'run_prediction_cycle' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: run_prediction_cycle",
        "signal_data": {
          "function": "run_prediction_cycle",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/recovery_matcher.py",
        "line": 576,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_upsert_candidate' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _upsert_candidate",
        "signal_data": {
          "function": "_upsert_candidate",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/recovery_matcher.py",
        "line": 814,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'approve_candidate' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: approve_candidate",
        "signal_data": {
          "function": "approve_candidate",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 67,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'create_tenant' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_tenant",
        "signal_data": {
          "function": "create_tenant",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 112,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'update_tenant_plan' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_tenant_plan",
        "signal_data": {
          "function": "update_tenant_plan",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 135,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'suspend_tenant' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: suspend_tenant",
        "signal_data": {
          "function": "suspend_tenant",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 151,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'create_membership_with_default' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_membership_with_default",
        "signal_data": {
          "function": "create_membership_with_default",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 200,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'create_api_key' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_api_key",
        "signal_data": {
          "function": "create_api_key",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 282,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'revoke_api_key' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: revoke_api_key",
        "signal_data": {
          "function": "revoke_api_key",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 367,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'increment_usage' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: increment_usage",
        "signal_data": {
          "function": "increment_usage",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 378,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_maybe_reset_daily_counter' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _maybe_reset_daily_counter",
        "signal_data": {
          "function": "_maybe_reset_daily_counter",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 378,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in '_maybe_reset_daily_counter' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _maybe_reset_daily_counter",
        "signal_data": {
          "function": "_maybe_reset_daily_counter",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 394,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'record_usage' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_usage",
        "signal_data": {
          "function": "record_usage",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 468,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'create_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: create_run",
        "signal_data": {
          "function": "create_run",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/tenant_service.py",
        "line": 503,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'complete_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: complete_run",
        "signal_data": {
          "function": "complete_run",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/worker_registry_service.py",
        "line": 175,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'register_worker' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: register_worker",
        "signal_data": {
          "function": "register_worker",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/worker_registry_service.py",
        "line": 217,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'update_worker_status' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_worker_status",
        "signal_data": {
          "function": "update_worker_status",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/worker_registry_service.py",
        "line": 245,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'set_tenant_worker_config' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: set_tenant_worker_config",
        "signal_data": {
          "function": "set_tenant_worker_config",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/worker_registry_service.py",
        "line": 245,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'set_tenant_worker_config' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: set_tenant_worker_config",
        "signal_data": {
          "function": "set_tenant_worker_config",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "services/worker_write_service_async.py",
        "line": 238,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self.session.commit' in 'commit' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: commit",
        "signal_data": {
          "function": "commit",
          "write_operation": "self.session.commit"
        }
      },
      {
        "file": "skills/base.py",
        "line": 119,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_upsert_state' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _upsert_state",
        "signal_data": {
          "function": "_upsert_state",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "skills/postgres_query.py",
        "line": 113,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: execute",
        "signal_data": {
          "function": "execute",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "skills/registry_v2.py",
        "line": 146,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self._db.commit' in '_init_persistence' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _init_persistence",
        "signal_data": {
          "function": "_init_persistence",
          "write_operation": "self._db.commit"
        }
      },
      {
        "file": "skills/registry_v2.py",
        "line": 213,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self._db.commit' in '_persist_registration' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _persist_registration",
        "signal_data": {
          "function": "_persist_registration",
          "write_operation": "self._db.commit"
        }
      },
      {
        "file": "skills/registry_v2.py",
        "line": 235,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'self._db.commit' in 'deregister' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: deregister",
        "signal_data": {
          "function": "deregister",
          "write_operation": "self._db.commit"
        }
      },
      {
        "file": "stores/checkpoint_offload.py",
        "line": 369,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function 'restore_checkpoint_from_r2' calls blocking 'read'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: read",
        "signal_data": {
          "function": "restore_checkpoint_from_r2",
          "blocking_call": "read"
        }
      },
      {
        "file": "stores/checkpoint_offload.py",
        "line": 369,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function 'restore_checkpoint_from_r2' calls blocking 'read'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: read",
        "signal_data": {
          "function": "restore_checkpoint_from_r2",
          "blocking_call": "read"
        }
      },
      {
        "file": "tasks/recovery_queue_stream.py",
        "line": 682,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'archive_dead_letter_to_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: archive_dead_letter_to_db",
        "signal_data": {
          "function": "archive_dead_letter_to_db",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "tasks/recovery_queue_stream.py",
        "line": 1172,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_record_replay_to_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _record_replay_to_db",
        "signal_data": {
          "function": "_record_replay_to_db",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 111,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_init_db' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _init_db",
        "signal_data": {
          "function": "_init_db",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 181,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'start_trace' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: start_trace",
        "signal_data": {
          "function": "start_trace",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 211,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'record_step' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_step",
        "signal_data": {
          "function": "record_step",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 255,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'complete_trace' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: complete_trace",
        "signal_data": {
          "function": "complete_trace",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 391,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'delete_trace' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete_trace",
        "signal_data": {
          "function": "delete_trace",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 415,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'cleanup_old_traces' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: cleanup_old_traces",
        "signal_data": {
          "function": "cleanup_old_traces",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 570,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in 'update_trace_determinism' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_trace_determinism",
        "signal_data": {
          "function": "update_trace_determinism",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 191,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_insert' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert",
        "signal_data": {
          "function": "_insert",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 227,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_insert' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _insert",
        "signal_data": {
          "function": "_insert",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 263,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_update' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update",
        "signal_data": {
          "function": "_update",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 394,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_delete' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _delete",
        "signal_data": {
          "function": "_delete",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 418,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_cleanup' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _cleanup",
        "signal_data": {
          "function": "_cleanup",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "traces/store.py",
        "line": 580,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'conn.commit' in '_update' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update",
        "signal_data": {
          "function": "_update",
          "write_operation": "conn.commit"
        }
      },
      {
        "file": "utils/budget_tracker.py",
        "line": 335,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_pause_agent' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _pause_agent",
        "signal_data": {
          "function": "_pause_agent",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "utils/budget_tracker.py",
        "line": 353,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'deduct' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: deduct",
        "signal_data": {
          "function": "deduct",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "utils/budget_tracker.py",
        "line": 414,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'record_cost' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: record_cost",
        "signal_data": {
          "function": "record_cost",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "utils/db_helpers.py",
        "line": 378,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'get_or_create' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: get_or_create",
        "signal_data": {
          "function": "get_or_create",
          "write_operation": "session.add"
        }
      },
      {
        "file": "utils/db_helpers.py",
        "line": 378,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'get_or_create' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: get_or_create",
        "signal_data": {
          "function": "get_or_create",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/outbox_processor.py",
        "line": 107,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'acquire_lock' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: acquire_lock",
        "signal_data": {
          "function": "acquire_lock",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/outbox_processor.py",
        "line": 132,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'release_lock' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: release_lock",
        "signal_data": {
          "function": "release_lock",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/outbox_processor.py",
        "line": 150,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'extend_lock' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: extend_lock",
        "signal_data": {
          "function": "extend_lock",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/outbox_processor.py",
        "line": 168,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'claim_events' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: claim_events",
        "signal_data": {
          "function": "claim_events",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/outbox_processor.py",
        "line": 341,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'complete_event' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: complete_event",
        "signal_data": {
          "function": "complete_event",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/pool.py",
        "line": 111,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_mark_run_started' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _mark_run_started",
        "signal_data": {
          "function": "_mark_run_started",
          "write_operation": "session.add"
        }
      },
      {
        "file": "worker/pool.py",
        "line": 111,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_mark_run_started' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _mark_run_started",
        "signal_data": {
          "function": "_mark_run_started",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_claim_worker.py",
        "line": 107,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'claim_batch' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: claim_batch",
        "signal_data": {
          "function": "claim_batch",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_claim_worker.py",
        "line": 235,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'update_candidate' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: update_candidate",
        "signal_data": {
          "function": "update_candidate",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_claim_worker.py",
        "line": 284,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in 'release_pending' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: release_pending",
        "signal_data": {
          "function": "release_pending",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_evaluator.py",
        "line": 358,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_select_action' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _select_action",
        "signal_data": {
          "function": "_select_action",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_evaluator.py",
        "line": 409,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_record_provenance' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _record_provenance",
        "signal_data": {
          "function": "_record_provenance",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_evaluator.py",
        "line": 460,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_auto_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _auto_execute",
        "signal_data": {
          "function": "_auto_execute",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/recovery_evaluator.py",
        "line": 460,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_auto_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _auto_execute",
        "signal_data": {
          "function": "_auto_execute",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 175,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_update_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update_run",
        "signal_data": {
          "function": "_update_run",
          "write_operation": "session.add"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 175,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_update_run' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _update_run",
        "signal_data": {
          "function": "_update_run",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 236,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute",
        "signal_data": {
          "function": "_execute",
          "write_operation": "session.add"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 236,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute",
        "signal_data": {
          "function": "_execute",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 236,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute",
        "signal_data": {
          "function": "_execute",
          "write_operation": "session.add"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 236,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute",
        "signal_data": {
          "function": "_execute",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 236,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in '_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute",
        "signal_data": {
          "function": "_execute",
          "write_operation": "session.add"
        }
      },
      {
        "file": "worker/runner.py",
        "line": 236,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.commit' in '_execute' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: _execute",
        "signal_data": {
          "function": "_execute",
          "write_operation": "session.commit"
        }
      },
      {
        "file": "workflow/checkpoint.py",
        "line": 227,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'save' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: save",
        "signal_data": {
          "function": "save",
          "write_operation": "session.add"
        }
      },
      {
        "file": "workflow/checkpoint.py",
        "line": 227,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.add' in 'save' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: save",
        "signal_data": {
          "function": "save",
          "write_operation": "session.add"
        }
      },
      {
        "file": "workflow/checkpoint.py",
        "line": 428,
        "type": "WRITE_OUTSIDE_WRITE_SERVICE",
        "severity": "HIGH_RISK",
        "message": "DB write 'session.delete' in 'delete' outside write service",
        "declared": "DB writes should be in *_write_service.py",
        "observed": "Write operation in: delete",
        "signal_data": {
          "function": "delete",
          "write_operation": "session.delete"
        }
      },
      {
        "file": "workflow/golden.py",
        "line": 316,
        "type": "ASYNC_BLOCKING_CALL",
        "severity": "HIGH_RISK",
        "message": "Async function '_append' calls blocking 'open'",
        "declared": "Async function should use async I/O",
        "observed": "Uses blocking call: open",
        "signal_data": {
          "function": "_append",
          "blocking_call": "open"
        }
      }
    ]
  },
  "findings_by_domain": {
    "/": {
      "count": 352,
      "high_risk_count": 308,
      "findings": [
        {
          "file": "cli.py",
          "line": 70,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'create_agent' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_agent",
          "signal_data": {
            "function": "create_agent",
            "write_operation": "session.add"
          }
        },
        {
          "file": "cli.py",
          "line": 70,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'create_agent' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_agent",
          "signal_data": {
            "function": "create_agent",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "cli.py",
          "line": 122,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'create_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_run",
          "signal_data": {
            "function": "create_run",
            "write_operation": "session.add"
          }
        },
        {
          "file": "cli.py",
          "line": 122,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'create_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_run",
          "signal_data": {
            "function": "create_run",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "cli.py",
          "line": 168,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'run_goal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: run_goal",
          "signal_data": {
            "function": "run_goal",
            "write_operation": "session.add"
          }
        },
        {
          "file": "cli.py",
          "line": 168,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'run_goal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: run_goal",
          "signal_data": {
            "function": "run_goal",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "db.py",
          "line": 938,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'log_status_change' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: log_status_change",
          "signal_data": {
            "function": "log_status_change",
            "write_operation": "session.add"
          }
        },
        {
          "file": "db.py",
          "line": 938,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'log_status_change' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: log_status_change",
          "signal_data": {
            "function": "log_status_change",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 852,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'create_agent' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_agent",
          "signal_data": {
            "function": "create_agent",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 852,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'create_agent' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_agent",
          "signal_data": {
            "function": "create_agent",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 885,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'post_goal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: post_goal",
          "signal_data": {
            "function": "post_goal",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 885,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'post_goal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: post_goal",
          "signal_data": {
            "function": "post_goal",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 1190,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'retry_failed_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: retry_failed_run",
          "signal_data": {
            "function": "retry_failed_run",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 1190,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'retry_failed_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: retry_failed_run",
          "signal_data": {
            "function": "retry_failed_run",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/sba/evolution.py",
          "line": 273,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_persist_violation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_violation",
          "signal_data": {
            "function": "_persist_violation",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "agents/sba/evolution.py",
          "line": 458,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_persist_drift_signal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_drift_signal",
          "signal_data": {
            "function": "_persist_drift_signal",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "agents/sba/evolution.py",
          "line": 582,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'apply_adjustment' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: apply_adjustment",
          "signal_data": {
            "function": "apply_adjustment",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "agents/sba/evolution.py",
          "line": 651,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_persist_adjustment' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_adjustment",
          "signal_data": {
            "function": "_persist_adjustment",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "agents/sba/service.py",
          "line": 87,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'register_agent' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: register_agent",
          "signal_data": {
            "function": "register_agent",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/sba/service.py",
          "line": 369,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'update_sba' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_sba",
          "signal_data": {
            "function": "update_sba",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/sba/service.py",
          "line": 408,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'update_fulfillment_metric' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_fulfillment_metric",
          "signal_data": {
            "function": "update_fulfillment_metric",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/sba/service.py",
          "line": 579,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'retrofit_missing_sba' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: retrofit_missing_sba",
          "signal_data": {
            "function": "retrofit_missing_sba",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/blackboard_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 8 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/credit_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 11 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/credit_service.py",
          "line": 187,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'log_reservation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: log_reservation",
          "signal_data": {
            "function": "log_reservation",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/credit_service.py",
          "line": 276,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'spend_for_item' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: spend_for_item",
          "signal_data": {
            "function": "spend_for_item",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/credit_service.py",
          "line": 324,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'refund_for_item' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: refund_for_item",
          "signal_data": {
            "function": "refund_for_item",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/credit_service.py",
          "line": 381,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'charge_skill' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: charge_skill",
          "signal_data": {
            "function": "charge_skill",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/governance_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 9 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/governance_service.py",
          "line": 220,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'update_job_budget' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_job_budget",
          "signal_data": {
            "function": "update_job_budget",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/governance_service.py",
          "line": 315,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'allocate_worker_budget' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: allocate_worker_budget",
          "signal_data": {
            "function": "allocate_worker_budget",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/governance_service.py",
          "line": 436,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'record_item_llm_usage' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_item_llm_usage",
          "signal_data": {
            "function": "record_item_llm_usage",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/invoke_audit_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 4 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/invoke_audit_service.py",
          "line": 63,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'start_invoke' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: start_invoke",
          "signal_data": {
            "function": "start_invoke",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/invoke_audit_service.py",
          "line": 131,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'complete_invoke' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: complete_invoke",
          "signal_data": {
            "function": "complete_invoke",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/invoke_audit_service.py",
          "line": 185,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'fail_invoke' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: fail_invoke",
          "signal_data": {
            "function": "fail_invoke",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/job_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 8 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/job_service.py",
          "line": 127,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'create_job' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_job",
          "signal_data": {
            "function": "create_job",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/job_service.py",
          "line": 406,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'check_job_completion' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: check_job_completion",
          "signal_data": {
            "function": "check_job_completion",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/job_service.py",
          "line": 468,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'cancel_job' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: cancel_job",
          "signal_data": {
            "function": "cancel_job",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/message_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 5 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/message_service.py",
          "line": 97,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'send' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: send",
          "signal_data": {
            "function": "send",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/message_service.py",
          "line": 289,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'mark_delivered' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: mark_delivered",
          "signal_data": {
            "function": "mark_delivered",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/message_service.py",
          "line": 312,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'mark_read' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: mark_read",
          "signal_data": {
            "function": "mark_read",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/message_service.py",
          "line": 512,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'cleanup_old_messages' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: cleanup_old_messages",
          "signal_data": {
            "function": "cleanup_old_messages",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 4 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 81,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'register' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: register",
          "signal_data": {
            "function": "register",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 157,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'heartbeat' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: heartbeat",
          "signal_data": {
            "function": "heartbeat",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 198,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'deregister' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: deregister",
          "signal_data": {
            "function": "deregister",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 336,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'mark_instance_stale' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: mark_instance_stale",
          "signal_data": {
            "function": "mark_instance_stale",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 376,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'mark_stale' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: mark_stale",
          "signal_data": {
            "function": "mark_stale",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 376,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'mark_stale' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: mark_stale",
          "signal_data": {
            "function": "mark_stale",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 428,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'reclaim_stale_items' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: reclaim_stale_items",
          "signal_data": {
            "function": "reclaim_stale_items",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 428,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'reclaim_stale_items' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: reclaim_stale_items",
          "signal_data": {
            "function": "reclaim_stale_items",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 4 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 76,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'claim_item' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: claim_item",
          "signal_data": {
            "function": "claim_item",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 172,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_claim_item_raw' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _claim_item_raw",
          "signal_data": {
            "function": "_claim_item_raw",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 277,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'start_item' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: start_item",
          "signal_data": {
            "function": "start_item",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 308,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'complete_item' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: complete_item",
          "signal_data": {
            "function": "complete_item",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 436,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'fail_item' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: fail_item",
          "signal_data": {
            "function": "fail_item",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 557,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'release_claimed' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: release_claimed",
          "signal_data": {
            "function": "release_claimed",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/skills/agent_invoke.py",
          "line": 253,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_create_invocation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _create_invocation",
          "signal_data": {
            "function": "_create_invocation",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/skills/agent_invoke.py",
          "line": 407,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_fail_invocation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _fail_invocation",
          "signal_data": {
            "function": "_fail_invocation",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/skills/agent_invoke.py",
          "line": 425,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_timeout_invocation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _timeout_invocation",
          "signal_data": {
            "function": "_timeout_invocation",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/skills/agent_invoke.py",
          "line": 444,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'respond_to_invoke' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: respond_to_invoke",
          "signal_data": {
            "function": "respond_to_invoke",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/skills/llm_invoke_governed.py",
          "line": 370,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_record_governance_data' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _record_governance_data",
          "signal_data": {
            "function": "_record_governance_data",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/agents.py",
          "line": 2101,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'update_agent_strategy' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_agent_strategy",
          "signal_data": {
            "function": "update_agent_strategy",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "api/costsim.py",
          "line": 59,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.tasks.memory_update",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.tasks.memory_update"
          }
        },
        {
          "file": "api/customer_visibility.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "api/founder_actions.py",
          "line": 259,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in 'execute_action' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: execute_action",
          "signal_data": {
            "function": "execute_action",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/founder_actions.py",
          "line": 517,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in 'execute_reversal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: execute_reversal",
          "signal_data": {
            "function": "execute_reversal",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/guard.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "api/integration.py",
          "line": 900,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'simulate_prevention' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: simulate_prevention",
          "signal_data": {
            "function": "simulate_prevention",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/integration.py",
          "line": 978,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'simulate_regret' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: simulate_regret",
          "signal_data": {
            "function": "simulate_regret",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/integration.py",
          "line": 1070,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'simulate_timeline_view' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: simulate_timeline_view",
          "signal_data": {
            "function": "simulate_timeline_view",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/integration.py",
          "line": 1132,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'record_timeline_view' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_timeline_view",
          "signal_data": {
            "function": "record_timeline_view",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/integration.py",
          "line": 1198,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'trigger_graduation_re_evaluation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: trigger_graduation_re_evaluation",
          "signal_data": {
            "function": "trigger_graduation_re_evaluation",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/legacy_routes.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (api_router) missing semantic header",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "No header comments found",
          "signal_data": null
        },
        {
          "file": "api/memory_pins.py",
          "line": 135,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'write_memory_audit' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: write_memory_audit",
          "signal_data": {
            "function": "write_memory_audit",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "api/memory_pins.py",
          "line": 192,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'create_or_upsert_pin' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_or_upsert_pin",
          "signal_data": {
            "function": "create_or_upsert_pin",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "api/memory_pins.py",
          "line": 448,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'delete_pin' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete_pin",
          "signal_data": {
            "function": "delete_pin",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "api/memory_pins.py",
          "line": 505,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'cleanup_expired_pins' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: cleanup_expired_pins",
          "signal_data": {
            "function": "cleanup_expired_pins",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 627,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'create_approval_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_approval_request",
          "signal_data": {
            "function": "create_approval_request",
            "write_operation": "session.add"
          }
        },
        {
          "file": "api/policy.py",
          "line": 627,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'create_approval_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_approval_request",
          "signal_data": {
            "function": "create_approval_request",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 704,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'get_approval_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: get_approval_request",
          "signal_data": {
            "function": "get_approval_request",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 825,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'approve_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: approve_request",
          "signal_data": {
            "function": "approve_request",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 825,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'approve_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: approve_request",
          "signal_data": {
            "function": "approve_request",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 892,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'reject_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: reject_request",
          "signal_data": {
            "function": "reject_request",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 939,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'list_approval_requests' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: list_approval_requests",
          "signal_data": {
            "function": "list_approval_requests",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 1011,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'run_escalation_check' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: run_escalation_check",
          "signal_data": {
            "function": "run_escalation_check",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/rbac_api.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (api_router) missing semantic header",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "No header comments found",
          "signal_data": null
        },
        {
          "file": "api/rbac_api.py",
          "line": 291,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'cleanup_audit_logs' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: cleanup_audit_logs",
          "signal_data": {
            "function": "cleanup_audit_logs",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "api/recovery.py",
          "line": 576,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in 'update_candidate' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_candidate",
          "signal_data": {
            "function": "update_candidate",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/recovery_ingest.py",
          "line": 117,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in 'ingest_failure' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: ingest_failure",
          "signal_data": {
            "function": "ingest_failure",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/recovery_ingest.py",
          "line": 286,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in '_enqueue_evaluation_async' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _enqueue_evaluation_async",
          "signal_data": {
            "function": "_enqueue_evaluation_async",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/recovery_ingest.py",
          "line": 313,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.tasks.recovery_queue_stream",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.tasks.recovery_queue_stream"
          }
        },
        {
          "file": "api/status_history.py",
          "line": 295,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function 'create_export' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "create_export",
            "blocking_call": "open"
          }
        },
        {
          "file": "api/status_history.py",
          "line": 295,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function 'create_export' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "create_export",
            "blocking_call": "open"
          }
        },
        {
          "file": "api/status_history.py",
          "line": 362,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function 'download_export' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "download_export",
            "blocking_call": "open"
          }
        },
        {
          "file": "api/traces.py",
          "line": 653,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'bulk_report_mismatches' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: bulk_report_mismatches",
          "signal_data": {
            "function": "bulk_report_mismatches",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/traces.py",
          "line": 778,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'report_mismatch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: report_mismatch",
          "signal_data": {
            "function": "report_mismatch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/traces.py",
          "line": 778,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'report_mismatch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: report_mismatch",
          "signal_data": {
            "function": "report_mismatch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/traces.py",
          "line": 778,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'report_mismatch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: report_mismatch",
          "signal_data": {
            "function": "report_mismatch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/traces.py",
          "line": 1015,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'resolve_mismatch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: resolve_mismatch",
          "signal_data": {
            "function": "resolve_mismatch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/v1_killswitch.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "api/v1_proxy.py",
          "line": 248,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'record_usage_after_killswitch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_usage_after_killswitch",
          "signal_data": {
            "function": "record_usage_after_killswitch",
            "write_operation": "session.add"
          }
        },
        {
          "file": "api/v1_proxy.py",
          "line": 248,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'record_usage_after_killswitch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_usage_after_killswitch",
          "signal_data": {
            "function": "record_usage_after_killswitch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/v1_proxy.py",
          "line": 430,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'log_proxy_call' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: log_proxy_call",
          "signal_data": {
            "function": "log_proxy_call",
            "write_operation": "session.add"
          }
        },
        {
          "file": "api/v1_proxy.py",
          "line": 430,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'log_proxy_call' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: log_proxy_call",
          "signal_data": {
            "function": "log_proxy_call",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/workers.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (worker) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 2 lines",
          "signal_data": null
        },
        {
          "file": "api/workers.py",
          "line": 194,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in '_store_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _store_run",
          "signal_data": {
            "function": "_store_run",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/workers.py",
          "line": 235,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in '_insert_cost_record' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert_cost_record",
          "signal_data": {
            "function": "_insert_cost_record",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/workers.py",
          "line": 273,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in '_check_and_emit_cost_advisory' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _check_and_emit_cost_advisory",
          "signal_data": {
            "function": "_check_and_emit_cost_advisory",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/workers.py",
          "line": 1208,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in 'delete_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete_run",
          "signal_data": {
            "function": "delete_run",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/workers.py",
          "line": 628,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.workers.business_builder.schemas.brand",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.workers.business_builder.schemas.brand"
          }
        },
        {
          "file": "api/workers.py",
          "line": 695,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.workers.business_builder.worker",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.workers.business_builder.worker"
          }
        },
        {
          "file": "api/workers.py",
          "line": 962,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.workers.business_builder.worker",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.workers.business_builder.worker"
          }
        },
        {
          "file": "api/workers.py",
          "line": 1020,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.workers.business_builder.worker",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.workers.business_builder.worker"
          }
        },
        {
          "file": "api/workers.py",
          "line": 1363,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.workers.business_builder.worker",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.workers.business_builder.worker"
          }
        },
        {
          "file": "auth/rbac_engine.py",
          "line": 396,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_audit' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _audit",
          "signal_data": {
            "function": "_audit",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "auth/tenant_auth.py",
          "line": 145,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'validate_api_key_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: validate_api_key_db",
          "signal_data": {
            "function": "validate_api_key_db",
            "write_operation": "session.add"
          }
        },
        {
          "file": "auth/tenant_auth.py",
          "line": 145,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'validate_api_key_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: validate_api_key_db",
          "signal_data": {
            "function": "validate_api_key_db",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "config/flag_sync.py",
          "line": 109,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'sync_file_to_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: sync_file_to_db",
          "signal_data": {
            "function": "sync_file_to_db",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "config/flag_sync.py",
          "line": 109,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'sync_file_to_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: sync_file_to_db",
          "signal_data": {
            "function": "sync_file_to_db",
            "write_operation": "session.add"
          }
        },
        {
          "file": "contracts/decisions.py",
          "line": 949,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'backfill_run_id_for_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: backfill_run_id_for_request",
          "signal_data": {
            "function": "backfill_run_id_for_request",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "contracts/decisions.py",
          "line": 182,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'emit' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: emit",
          "signal_data": {
            "function": "emit",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "contracts/decisions.py",
          "line": 264,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_emit_sync_impl' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _emit_sync_impl",
          "signal_data": {
            "function": "_emit_sync_impl",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "costsim/alert_worker.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (worker) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 1 lines",
          "signal_data": null
        },
        {
          "file": "costsim/alert_worker.py",
          "line": 303,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'enqueue_alert' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: enqueue_alert",
          "signal_data": {
            "function": "enqueue_alert",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/alert_worker.py",
          "line": 303,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'enqueue_alert' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: enqueue_alert",
          "signal_data": {
            "function": "enqueue_alert",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/alert_worker.py",
          "line": 357,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'retry_failed_alerts' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: retry_failed_alerts",
          "signal_data": {
            "function": "retry_failed_alerts",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/alert_worker.py",
          "line": 395,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'purge_old_alerts' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: purge_old_alerts",
          "signal_data": {
            "function": "purge_old_alerts",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/alert_worker.py",
          "line": 95,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'process_batch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: process_batch",
          "signal_data": {
            "function": "process_batch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/canary.py",
          "line": 574,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function '_save_artifacts' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "_save_artifacts",
            "blocking_call": "open"
          }
        },
        {
          "file": "costsim/canary.py",
          "line": 574,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function '_save_artifacts' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "_save_artifacts",
            "blocking_call": "open"
          }
        },
        {
          "file": "costsim/canary.py",
          "line": 574,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function '_save_artifacts' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "_save_artifacts",
            "blocking_call": "open"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 206,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_get_or_create_state' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_or_create_state",
          "signal_data": {
            "function": "_get_or_create_state",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 206,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_get_or_create_state' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_or_create_state",
          "signal_data": {
            "function": "_get_or_create_state",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 271,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_auto_recover' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _auto_recover",
          "signal_data": {
            "function": "_auto_recover",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 350,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'report_drift' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: report_drift",
          "signal_data": {
            "function": "report_drift",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 350,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'report_drift' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: report_drift",
          "signal_data": {
            "function": "report_drift",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 498,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'reset' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: reset",
          "signal_data": {
            "function": "reset",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 573,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_trip' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _trip",
          "signal_data": {
            "function": "_trip",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 573,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_trip' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _trip",
          "signal_data": {
            "function": "_trip",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 573,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_trip' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _trip",
          "signal_data": {
            "function": "_trip",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 683,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_resolve_incident_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _resolve_incident_db",
          "signal_data": {
            "function": "_resolve_incident_db",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 130,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_get_or_create_state' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_or_create_state",
          "signal_data": {
            "function": "_get_or_create_state",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 130,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in '_get_or_create_state' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_or_create_state",
          "signal_data": {
            "function": "_get_or_create_state",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 229,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in '_try_auto_recover' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _try_auto_recover",
          "signal_data": {
            "function": "_try_auto_recover",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 321,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_auto_recover' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _auto_recover",
          "signal_data": {
            "function": "_auto_recover",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 598,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_trip' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _trip",
          "signal_data": {
            "function": "_trip",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 598,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in '_trip' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _trip",
          "signal_data": {
            "function": "_trip",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 694,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_resolve_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _resolve_incident",
          "signal_data": {
            "function": "_resolve_incident",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 762,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_enqueue_alert' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _enqueue_alert",
          "signal_data": {
            "function": "_enqueue_alert",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 762,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in '_enqueue_alert' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _enqueue_alert",
          "signal_data": {
            "function": "_enqueue_alert",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "costsim/provenance.py",
          "line": 268,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function '_write_to_file' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "_write_to_file",
            "blocking_call": "open"
          }
        },
        {
          "file": "costsim/provenance.py",
          "line": 300,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function 'query' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "query",
            "blocking_call": "open"
          }
        },
        {
          "file": "costsim/provenance_async.py",
          "line": 61,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'write_provenance' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: write_provenance",
          "signal_data": {
            "function": "write_provenance",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/provenance_async.py",
          "line": 61,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'write_provenance' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: write_provenance",
          "signal_data": {
            "function": "write_provenance",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/provenance_async.py",
          "line": 146,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'write_provenance_batch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: write_provenance_batch",
          "signal_data": {
            "function": "write_provenance_batch",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/provenance_async.py",
          "line": 146,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'write_provenance_batch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: write_provenance_batch",
          "signal_data": {
            "function": "write_provenance_batch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "discovery/ledger.py",
          "line": 50,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'emit_signal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: emit_signal",
          "signal_data": {
            "function": "emit_signal",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "integrations/bridges.py",
          "line": 111,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'record_policy_activation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_policy_activation",
          "signal_data": {
            "function": "record_policy_activation",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/bridges.py",
          "line": 415,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_increment_pattern_count' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _increment_pattern_count",
          "signal_data": {
            "function": "_increment_pattern_count",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/bridges.py",
          "line": 432,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_create_pattern' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _create_pattern",
          "signal_data": {
            "function": "_create_pattern",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/bridges.py",
          "line": 668,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_persist_recovery' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_recovery",
          "signal_data": {
            "function": "_persist_recovery",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/bridges.py",
          "line": 867,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_persist_policy' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_policy",
          "signal_data": {
            "function": "_persist_policy",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/bridges.py",
          "line": 1142,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_persist_adjustment' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_adjustment",
          "signal_data": {
            "function": "_persist_adjustment",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/cost_snapshots.py",
          "line": 623,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_insert_snapshot' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert_snapshot",
          "signal_data": {
            "function": "_insert_snapshot",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "integrations/cost_snapshots.py",
          "line": 651,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_update_snapshot' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update_snapshot",
          "signal_data": {
            "function": "_update_snapshot",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "integrations/cost_snapshots.py",
          "line": 675,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_insert_aggregate' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert_aggregate",
          "signal_data": {
            "function": "_insert_aggregate",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "integrations/cost_snapshots.py",
          "line": 794,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_insert_baseline' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert_baseline",
          "signal_data": {
            "function": "_insert_baseline",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "integrations/cost_snapshots.py",
          "line": 971,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_insert_evaluation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert_evaluation",
          "signal_data": {
            "function": "_insert_evaluation",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "integrations/cost_snapshots.py",
          "line": 1005,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_create_anomaly_from_evaluation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _create_anomaly_from_evaluation",
          "signal_data": {
            "function": "_create_anomaly_from_evaluation",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "integrations/dispatcher.py",
          "line": 516,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_persist_event' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_event",
          "signal_data": {
            "function": "_persist_event",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/dispatcher.py",
          "line": 555,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_persist_loop_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_loop_status",
          "signal_data": {
            "function": "_persist_loop_status",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/dispatcher.py",
          "line": 591,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_persist_checkpoint' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_checkpoint",
          "signal_data": {
            "function": "_persist_checkpoint",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/graduation_engine.py",
          "line": 757,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'persist_graduation_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_graduation_status",
          "signal_data": {
            "function": "persist_graduation_status",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "jobs/graduation_evaluator.py",
          "line": 38,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'evaluate_graduation_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: evaluate_graduation_status",
          "signal_data": {
            "function": "evaluate_graduation_status",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "jobs/storage.py",
          "line": 451,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_record_export_to_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _record_export_to_db",
          "signal_data": {
            "function": "_record_export_to_db",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "jobs/storage.py",
          "line": 491,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_update_export_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update_export_status",
          "signal_data": {
            "function": "_update_export_status",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/memory_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) missing semantic header",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "No header comments found",
          "signal_data": null
        },
        {
          "file": "memory/memory_service.py",
          "line": 303,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'set' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: set",
          "signal_data": {
            "function": "set",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/memory_service.py",
          "line": 415,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'delete' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete",
          "signal_data": {
            "function": "delete",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/memory_service.py",
          "line": 565,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_audit' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _audit",
          "signal_data": {
            "function": "_audit",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/store.py",
          "line": 64,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'store' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: store",
          "signal_data": {
            "function": "store",
            "write_operation": "session.add"
          }
        },
        {
          "file": "memory/store.py",
          "line": 64,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'store' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: store",
          "signal_data": {
            "function": "store",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/store.py",
          "line": 195,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.delete' in 'delete' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete",
          "signal_data": {
            "function": "delete",
            "write_operation": "session.delete"
          }
        },
        {
          "file": "memory/store.py",
          "line": 195,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'delete' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete",
          "signal_data": {
            "function": "delete",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/vector_store.py",
          "line": 266,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'store' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: store",
          "signal_data": {
            "function": "store",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/vector_store.py",
          "line": 594,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'delete' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete",
          "signal_data": {
            "function": "delete",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/vector_store.py",
          "line": 604,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'backfill_embeddings' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: backfill_embeddings",
          "signal_data": {
            "function": "backfill_embeddings",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "optimization/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "optimization/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Layer",
          "declared": "# Layer: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "optimization/audit_persistence.py",
          "line": 62,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.add' in 'persist_audit_record' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_audit_record",
          "signal_data": {
            "function": "persist_audit_record",
            "write_operation": "db.add"
          }
        },
        {
          "file": "optimization/audit_persistence.py",
          "line": 62,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'persist_audit_record' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_audit_record",
          "signal_data": {
            "function": "persist_audit_record",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "optimization/envelopes/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "optimization/envelopes/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Layer",
          "declared": "# Layer: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "policy/engine.py",
          "line": 1186,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_persist_evaluation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_evaluation",
          "signal_data": {
            "function": "_persist_evaluation",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1186,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_persist_evaluation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_evaluation",
          "signal_data": {
            "function": "_persist_evaluation",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1417,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'acknowledge_violation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: acknowledge_violation",
          "signal_data": {
            "function": "acknowledge_violation",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1467,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'update_risk_ceiling' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_risk_ceiling",
          "signal_data": {
            "function": "update_risk_ceiling",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1502,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'reset_risk_ceiling' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: reset_risk_ceiling",
          "signal_data": {
            "function": "reset_risk_ceiling",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1543,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'update_safety_rule' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_safety_rule",
          "signal_data": {
            "function": "update_safety_rule",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1723,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'create_policy_version' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_policy_version",
          "signal_data": {
            "function": "create_policy_version",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1790,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'rollback_to_version' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: rollback_to_version",
          "signal_data": {
            "function": "rollback_to_version",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 2007,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'resolve_conflict' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: resolve_conflict",
          "signal_data": {
            "function": "resolve_conflict",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 2076,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'create_temporal_policy' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_temporal_policy",
          "signal_data": {
            "function": "create_temporal_policy",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 2456,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'add_dependency_with_dag_check' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: add_dependency_with_dag_check",
          "signal_data": {
            "function": "add_dependency_with_dag_check",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 2615,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'prune_temporal_metrics' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: prune_temporal_metrics",
          "signal_data": {
            "function": "prune_temporal_metrics",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 2786,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'activate_policy_version' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: activate_policy_version",
          "signal_data": {
            "function": "activate_policy_version",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "predictions/api.py",
          "line": 65,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.add' in 'create_incident_risk_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_incident_risk_prediction",
          "signal_data": {
            "function": "create_incident_risk_prediction",
            "write_operation": "db.add"
          }
        },
        {
          "file": "predictions/api.py",
          "line": 65,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'create_incident_risk_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_incident_risk_prediction",
          "signal_data": {
            "function": "create_incident_risk_prediction",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "predictions/api.py",
          "line": 144,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.add' in 'create_spend_spike_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_spend_spike_prediction",
          "signal_data": {
            "function": "create_spend_spike_prediction",
            "write_operation": "db.add"
          }
        },
        {
          "file": "predictions/api.py",
          "line": 144,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'create_spend_spike_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_spend_spike_prediction",
          "signal_data": {
            "function": "create_spend_spike_prediction",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "predictions/api.py",
          "line": 202,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.add' in 'create_policy_drift_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_policy_drift_prediction",
          "signal_data": {
            "function": "create_policy_drift_prediction",
            "write_operation": "db.add"
          }
        },
        {
          "file": "predictions/api.py",
          "line": 202,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'create_policy_drift_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_policy_drift_prediction",
          "signal_data": {
            "function": "create_policy_drift_prediction",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "routing/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "routing/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Layer",
          "declared": "# Layer: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "routing/care.py",
          "line": 432,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_persist_decision' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_decision",
          "signal_data": {
            "function": "_persist_decision",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "runtime/failure_catalog.py",
          "line": 577,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'persist_failure_match' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_failure_match",
          "signal_data": {
            "function": "persist_failure_match",
            "write_operation": "session.add"
          }
        },
        {
          "file": "runtime/failure_catalog.py",
          "line": 577,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'persist_failure_match' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_failure_match",
          "signal_data": {
            "function": "persist_failure_match",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "runtime/failure_catalog.py",
          "line": 791,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'update_recovery_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_recovery_status",
          "signal_data": {
            "function": "update_recovery_status",
            "write_operation": "session.add"
          }
        },
        {
          "file": "runtime/failure_catalog.py",
          "line": 791,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'update_recovery_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_recovery_status",
          "signal_data": {
            "function": "update_recovery_status",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "security/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/certificate.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 676,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_record_breach_and_get_consecutive_count' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _record_breach_and_get_consecutive_count",
          "signal_data": {
            "function": "_record_breach_and_get_consecutive_count",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 784,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_update_drift_tracking' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update_drift_tracking",
          "signal_data": {
            "function": "_update_drift_tracking",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 784,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_update_drift_tracking' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update_drift_tracking",
          "signal_data": {
            "function": "_update_drift_tracking",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 878,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_reset_drift_tracking' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _reset_drift_tracking",
          "signal_data": {
            "function": "_reset_drift_tracking",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 1039,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'persist_anomalies' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_anomalies",
          "signal_data": {
            "function": "persist_anomalies",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 1151,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L4 imports from L6",
          "declared": "Layer L4 should not import L6",
          "observed": "Import: app.integrations.cost_bridges",
          "signal_data": {
            "source_layer": "L4",
            "target_layer": "L6",
            "import_path": "app.integrations.cost_bridges"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 1154,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L4 imports from L6",
          "declared": "Layer L4 should not import L6",
          "observed": "Import: app.integrations.cost_bridges",
          "signal_data": {
            "source_layer": "L4",
            "target_layer": "L6",
            "import_path": "app.integrations.cost_bridges"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 1157,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L4 imports from L6",
          "declared": "Layer L4 should not import L6",
          "observed": "Import: app.integrations.cost_bridges",
          "signal_data": {
            "source_layer": "L4",
            "target_layer": "L6",
            "import_path": "app.integrations.cost_bridges"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 1160,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L4 imports from L6",
          "declared": "Layer L4 should not import L6",
          "observed": "Import: app.integrations.cost_bridges",
          "signal_data": {
            "source_layer": "L4",
            "target_layer": "L6",
            "import_path": "app.integrations.cost_bridges"
          }
        },
        {
          "file": "services/email_verification.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/event_emitter.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/evidence_report.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 263,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_get_rate_limit_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_rate_limit_incident",
          "signal_data": {
            "function": "_get_rate_limit_incident",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 263,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_get_rate_limit_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_rate_limit_incident",
          "signal_data": {
            "function": "_get_rate_limit_incident",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 263,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_get_rate_limit_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_rate_limit_incident",
          "signal_data": {
            "function": "_get_rate_limit_incident",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 263,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_get_rate_limit_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_rate_limit_incident",
          "signal_data": {
            "function": "_get_rate_limit_incident",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 311,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_create_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _create_incident",
          "signal_data": {
            "function": "_create_incident",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 311,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_create_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _create_incident",
          "signal_data": {
            "function": "_create_incident",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 366,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_add_call_to_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _add_call_to_incident",
          "signal_data": {
            "function": "_add_call_to_incident",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 366,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_add_call_to_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _add_call_to_incident",
          "signal_data": {
            "function": "_add_call_to_incident",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 448,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_add_incident_event' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _add_incident_event",
          "signal_data": {
            "function": "_add_incident_event",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 448,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_add_incident_event' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _add_incident_event",
          "signal_data": {
            "function": "_add_incident_event",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 471,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'resolve_stale_incidents' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: resolve_stale_incidents",
          "signal_data": {
            "function": "resolve_stale_incidents",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 471,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'resolve_stale_incidents' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: resolve_stale_incidents",
          "signal_data": {
            "function": "resolve_stale_incidents",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/llm_failure_service.py",
          "line": 128,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self._session.commit' in 'persist_failure_and_mark_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_failure_and_mark_run",
          "signal_data": {
            "function": "persist_failure_and_mark_run",
            "write_operation": "self._session.commit"
          }
        },
        {
          "file": "services/orphan_recovery.py",
          "line": 114,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'recover_orphaned_runs' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: recover_orphaned_runs",
          "signal_data": {
            "function": "recover_orphaned_runs",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/pattern_detection.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/pattern_detection.py",
          "line": 227,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'emit_feedback' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: emit_feedback",
          "signal_data": {
            "function": "emit_feedback",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/pattern_detection.py",
          "line": 227,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in 'emit_feedback' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: emit_feedback",
          "signal_data": {
            "function": "emit_feedback",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "services/pattern_detection.py",
          "line": 268,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'run_pattern_detection' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: run_pattern_detection",
          "signal_data": {
            "function": "run_pattern_detection",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/policy_proposal.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/policy_proposal.py",
          "line": 115,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'create_policy_proposal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_policy_proposal",
          "signal_data": {
            "function": "create_policy_proposal",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/policy_proposal.py",
          "line": 115,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in 'create_policy_proposal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_policy_proposal",
          "signal_data": {
            "function": "create_policy_proposal",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "services/policy_proposal.py",
          "line": 153,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'review_policy_proposal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: review_policy_proposal",
          "signal_data": {
            "function": "review_policy_proposal",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/policy_proposal.py",
          "line": 153,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in 'review_policy_proposal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: review_policy_proposal",
          "signal_data": {
            "function": "review_policy_proposal",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "services/policy_proposal.py",
          "line": 232,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'generate_proposals_from_feedback' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: generate_proposals_from_feedback",
          "signal_data": {
            "function": "generate_proposals_from_feedback",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/policy_violation_service.py",
          "line": 110,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'persist_violation_fact' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_violation_fact",
          "signal_data": {
            "function": "persist_violation_fact",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/policy_violation_service.py",
          "line": 194,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'persist_evidence' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_evidence",
          "signal_data": {
            "function": "persist_evidence",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/policy_violation_service.py",
          "line": 262,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'sync_session.commit' in 'create_incident_from_violation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_incident_from_violation",
          "signal_data": {
            "function": "create_incident_from_violation",
            "write_operation": "sync_session.commit"
          }
        },
        {
          "file": "services/prediction.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/prediction.py",
          "line": 276,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'emit_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: emit_prediction",
          "signal_data": {
            "function": "emit_prediction",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/prediction.py",
          "line": 276,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in 'emit_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: emit_prediction",
          "signal_data": {
            "function": "emit_prediction",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "services/prediction.py",
          "line": 318,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'run_prediction_cycle' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: run_prediction_cycle",
          "signal_data": {
            "function": "run_prediction_cycle",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/recovery_matcher.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/recovery_matcher.py",
          "line": 576,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_upsert_candidate' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _upsert_candidate",
          "signal_data": {
            "function": "_upsert_candidate",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/recovery_matcher.py",
          "line": 814,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'approve_candidate' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: approve_candidate",
          "signal_data": {
            "function": "approve_candidate",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/recovery_rule_engine.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/tenant_service.py",
          "line": 67,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'create_tenant' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_tenant",
          "signal_data": {
            "function": "create_tenant",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 112,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'update_tenant_plan' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_tenant_plan",
          "signal_data": {
            "function": "update_tenant_plan",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 135,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'suspend_tenant' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: suspend_tenant",
          "signal_data": {
            "function": "suspend_tenant",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 151,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'create_membership_with_default' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_membership_with_default",
          "signal_data": {
            "function": "create_membership_with_default",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 200,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'create_api_key' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_api_key",
          "signal_data": {
            "function": "create_api_key",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 282,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'revoke_api_key' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: revoke_api_key",
          "signal_data": {
            "function": "revoke_api_key",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 367,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'increment_usage' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: increment_usage",
          "signal_data": {
            "function": "increment_usage",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 378,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_maybe_reset_daily_counter' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _maybe_reset_daily_counter",
          "signal_data": {
            "function": "_maybe_reset_daily_counter",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 378,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_maybe_reset_daily_counter' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _maybe_reset_daily_counter",
          "signal_data": {
            "function": "_maybe_reset_daily_counter",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 394,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'record_usage' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_usage",
          "signal_data": {
            "function": "record_usage",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 468,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'create_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_run",
          "signal_data": {
            "function": "create_run",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 503,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'complete_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: complete_run",
          "signal_data": {
            "function": "complete_run",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/worker_registry_service.py",
          "line": 175,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'register_worker' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: register_worker",
          "signal_data": {
            "function": "register_worker",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/worker_registry_service.py",
          "line": 217,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'update_worker_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_worker_status",
          "signal_data": {
            "function": "update_worker_status",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/worker_registry_service.py",
          "line": 245,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'set_tenant_worker_config' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: set_tenant_worker_config",
          "signal_data": {
            "function": "set_tenant_worker_config",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/worker_registry_service.py",
          "line": 245,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'set_tenant_worker_config' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: set_tenant_worker_config",
          "signal_data": {
            "function": "set_tenant_worker_config",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/worker_write_service_async.py",
          "line": 238,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'commit' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: commit",
          "signal_data": {
            "function": "commit",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "skills/base.py",
          "line": 119,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_upsert_state' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _upsert_state",
          "signal_data": {
            "function": "_upsert_state",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "skills/postgres_query.py",
          "line": 113,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: execute",
          "signal_data": {
            "function": "execute",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "skills/registry_v2.py",
          "line": 146,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self._db.commit' in '_init_persistence' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _init_persistence",
          "signal_data": {
            "function": "_init_persistence",
            "write_operation": "self._db.commit"
          }
        },
        {
          "file": "skills/registry_v2.py",
          "line": 213,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self._db.commit' in '_persist_registration' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_registration",
          "signal_data": {
            "function": "_persist_registration",
            "write_operation": "self._db.commit"
          }
        },
        {
          "file": "skills/registry_v2.py",
          "line": 235,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self._db.commit' in 'deregister' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: deregister",
          "signal_data": {
            "function": "deregister",
            "write_operation": "self._db.commit"
          }
        },
        {
          "file": "stores/checkpoint_offload.py",
          "line": 369,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function 'restore_checkpoint_from_r2' calls blocking 'read'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: read",
          "signal_data": {
            "function": "restore_checkpoint_from_r2",
            "blocking_call": "read"
          }
        },
        {
          "file": "stores/checkpoint_offload.py",
          "line": 369,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function 'restore_checkpoint_from_r2' calls blocking 'read'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: read",
          "signal_data": {
            "function": "restore_checkpoint_from_r2",
            "blocking_call": "read"
          }
        },
        {
          "file": "tasks/recovery_queue_stream.py",
          "line": 682,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'archive_dead_letter_to_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: archive_dead_letter_to_db",
          "signal_data": {
            "function": "archive_dead_letter_to_db",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "tasks/recovery_queue_stream.py",
          "line": 1172,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_record_replay_to_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _record_replay_to_db",
          "signal_data": {
            "function": "_record_replay_to_db",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 111,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_init_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _init_db",
          "signal_data": {
            "function": "_init_db",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 181,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'start_trace' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: start_trace",
          "signal_data": {
            "function": "start_trace",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 211,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'record_step' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_step",
          "signal_data": {
            "function": "record_step",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 255,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'complete_trace' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: complete_trace",
          "signal_data": {
            "function": "complete_trace",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 391,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'delete_trace' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete_trace",
          "signal_data": {
            "function": "delete_trace",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 415,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'cleanup_old_traces' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: cleanup_old_traces",
          "signal_data": {
            "function": "cleanup_old_traces",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 570,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'update_trace_determinism' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_trace_determinism",
          "signal_data": {
            "function": "update_trace_determinism",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 191,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_insert' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert",
          "signal_data": {
            "function": "_insert",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 227,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_insert' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert",
          "signal_data": {
            "function": "_insert",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 263,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_update' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update",
          "signal_data": {
            "function": "_update",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 394,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_delete' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _delete",
          "signal_data": {
            "function": "_delete",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 418,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_cleanup' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _cleanup",
          "signal_data": {
            "function": "_cleanup",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 580,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_update' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update",
          "signal_data": {
            "function": "_update",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "utils/budget_tracker.py",
          "line": 335,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_pause_agent' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _pause_agent",
          "signal_data": {
            "function": "_pause_agent",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "utils/budget_tracker.py",
          "line": 353,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'deduct' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: deduct",
          "signal_data": {
            "function": "deduct",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "utils/budget_tracker.py",
          "line": 414,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'record_cost' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_cost",
          "signal_data": {
            "function": "record_cost",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "utils/db_helpers.py",
          "line": 378,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'get_or_create' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: get_or_create",
          "signal_data": {
            "function": "get_or_create",
            "write_operation": "session.add"
          }
        },
        {
          "file": "utils/db_helpers.py",
          "line": 378,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'get_or_create' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: get_or_create",
          "signal_data": {
            "function": "get_or_create",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/outbox_processor.py",
          "line": 107,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'acquire_lock' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: acquire_lock",
          "signal_data": {
            "function": "acquire_lock",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/outbox_processor.py",
          "line": 132,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'release_lock' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: release_lock",
          "signal_data": {
            "function": "release_lock",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/outbox_processor.py",
          "line": 150,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'extend_lock' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: extend_lock",
          "signal_data": {
            "function": "extend_lock",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/outbox_processor.py",
          "line": 168,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'claim_events' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: claim_events",
          "signal_data": {
            "function": "claim_events",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/outbox_processor.py",
          "line": 341,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'complete_event' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: complete_event",
          "signal_data": {
            "function": "complete_event",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/pool.py",
          "line": 111,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_mark_run_started' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _mark_run_started",
          "signal_data": {
            "function": "_mark_run_started",
            "write_operation": "session.add"
          }
        },
        {
          "file": "worker/pool.py",
          "line": 111,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_mark_run_started' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _mark_run_started",
          "signal_data": {
            "function": "_mark_run_started",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_claim_worker.py",
          "line": 107,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'claim_batch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: claim_batch",
          "signal_data": {
            "function": "claim_batch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_claim_worker.py",
          "line": 235,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'update_candidate' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_candidate",
          "signal_data": {
            "function": "update_candidate",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_claim_worker.py",
          "line": 284,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'release_pending' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: release_pending",
          "signal_data": {
            "function": "release_pending",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_evaluator.py",
          "line": 358,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_select_action' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _select_action",
          "signal_data": {
            "function": "_select_action",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_evaluator.py",
          "line": 409,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_record_provenance' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _record_provenance",
          "signal_data": {
            "function": "_record_provenance",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_evaluator.py",
          "line": 460,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_auto_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _auto_execute",
          "signal_data": {
            "function": "_auto_execute",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_evaluator.py",
          "line": 460,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_auto_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _auto_execute",
          "signal_data": {
            "function": "_auto_execute",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 175,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_update_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update_run",
          "signal_data": {
            "function": "_update_run",
            "write_operation": "session.add"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 175,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_update_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update_run",
          "signal_data": {
            "function": "_update_run",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 236,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute",
          "signal_data": {
            "function": "_execute",
            "write_operation": "session.add"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 236,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute",
          "signal_data": {
            "function": "_execute",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 236,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute",
          "signal_data": {
            "function": "_execute",
            "write_operation": "session.add"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 236,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute",
          "signal_data": {
            "function": "_execute",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 236,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute",
          "signal_data": {
            "function": "_execute",
            "write_operation": "session.add"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 236,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute",
          "signal_data": {
            "function": "_execute",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "workflow/checkpoint.py",
          "line": 227,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'save' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: save",
          "signal_data": {
            "function": "save",
            "write_operation": "session.add"
          }
        },
        {
          "file": "workflow/checkpoint.py",
          "line": 227,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'save' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: save",
          "signal_data": {
            "function": "save",
            "write_operation": "session.add"
          }
        },
        {
          "file": "workflow/checkpoint.py",
          "line": 428,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.delete' in 'delete' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete",
          "signal_data": {
            "function": "delete",
            "write_operation": "session.delete"
          }
        },
        {
          "file": "workflow/golden.py",
          "line": 316,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function '_append' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "_append",
            "blocking_call": "open"
          }
        }
      ]
    }
  },
  "findings_by_layer": {
    "UNKNOWN": {
      "count": 188,
      "high_risk_count": 179,
      "findings": [
        {
          "file": "cli.py",
          "line": 70,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'create_agent' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_agent",
          "signal_data": {
            "function": "create_agent",
            "write_operation": "session.add"
          }
        },
        {
          "file": "cli.py",
          "line": 70,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'create_agent' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_agent",
          "signal_data": {
            "function": "create_agent",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "cli.py",
          "line": 122,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'create_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_run",
          "signal_data": {
            "function": "create_run",
            "write_operation": "session.add"
          }
        },
        {
          "file": "cli.py",
          "line": 122,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'create_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_run",
          "signal_data": {
            "function": "create_run",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "cli.py",
          "line": 168,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'run_goal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: run_goal",
          "signal_data": {
            "function": "run_goal",
            "write_operation": "session.add"
          }
        },
        {
          "file": "cli.py",
          "line": 168,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'run_goal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: run_goal",
          "signal_data": {
            "function": "run_goal",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "db.py",
          "line": 938,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'log_status_change' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: log_status_change",
          "signal_data": {
            "function": "log_status_change",
            "write_operation": "session.add"
          }
        },
        {
          "file": "db.py",
          "line": 938,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'log_status_change' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: log_status_change",
          "signal_data": {
            "function": "log_status_change",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 562,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute_run_inner' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute_run_inner",
          "signal_data": {
            "function": "_execute_run_inner",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 852,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'create_agent' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_agent",
          "signal_data": {
            "function": "create_agent",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 852,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'create_agent' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_agent",
          "signal_data": {
            "function": "create_agent",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 885,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'post_goal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: post_goal",
          "signal_data": {
            "function": "post_goal",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 885,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'post_goal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: post_goal",
          "signal_data": {
            "function": "post_goal",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "main.py",
          "line": 1190,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'retry_failed_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: retry_failed_run",
          "signal_data": {
            "function": "retry_failed_run",
            "write_operation": "session.add"
          }
        },
        {
          "file": "main.py",
          "line": 1190,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'retry_failed_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: retry_failed_run",
          "signal_data": {
            "function": "retry_failed_run",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/sba/evolution.py",
          "line": 273,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_persist_violation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_violation",
          "signal_data": {
            "function": "_persist_violation",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "agents/sba/evolution.py",
          "line": 458,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_persist_drift_signal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_drift_signal",
          "signal_data": {
            "function": "_persist_drift_signal",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "agents/sba/evolution.py",
          "line": 582,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'apply_adjustment' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: apply_adjustment",
          "signal_data": {
            "function": "apply_adjustment",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "agents/sba/evolution.py",
          "line": 651,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_persist_adjustment' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_adjustment",
          "signal_data": {
            "function": "_persist_adjustment",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "agents/sba/service.py",
          "line": 87,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'register_agent' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: register_agent",
          "signal_data": {
            "function": "register_agent",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/sba/service.py",
          "line": 369,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'update_sba' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_sba",
          "signal_data": {
            "function": "update_sba",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/sba/service.py",
          "line": 408,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'update_fulfillment_metric' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_fulfillment_metric",
          "signal_data": {
            "function": "update_fulfillment_metric",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/sba/service.py",
          "line": 579,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'retrofit_missing_sba' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: retrofit_missing_sba",
          "signal_data": {
            "function": "retrofit_missing_sba",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/skills/agent_invoke.py",
          "line": 253,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_create_invocation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _create_invocation",
          "signal_data": {
            "function": "_create_invocation",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/skills/agent_invoke.py",
          "line": 407,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_fail_invocation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _fail_invocation",
          "signal_data": {
            "function": "_fail_invocation",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/skills/agent_invoke.py",
          "line": 425,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_timeout_invocation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _timeout_invocation",
          "signal_data": {
            "function": "_timeout_invocation",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/skills/agent_invoke.py",
          "line": 444,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'respond_to_invoke' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: respond_to_invoke",
          "signal_data": {
            "function": "respond_to_invoke",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/skills/llm_invoke_governed.py",
          "line": 370,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_record_governance_data' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _record_governance_data",
          "signal_data": {
            "function": "_record_governance_data",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "auth/rbac_engine.py",
          "line": 396,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_audit' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _audit",
          "signal_data": {
            "function": "_audit",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "auth/tenant_auth.py",
          "line": 145,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'validate_api_key_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: validate_api_key_db",
          "signal_data": {
            "function": "validate_api_key_db",
            "write_operation": "session.add"
          }
        },
        {
          "file": "auth/tenant_auth.py",
          "line": 145,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'validate_api_key_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: validate_api_key_db",
          "signal_data": {
            "function": "validate_api_key_db",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "config/flag_sync.py",
          "line": 109,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'sync_file_to_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: sync_file_to_db",
          "signal_data": {
            "function": "sync_file_to_db",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "config/flag_sync.py",
          "line": 109,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'sync_file_to_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: sync_file_to_db",
          "signal_data": {
            "function": "sync_file_to_db",
            "write_operation": "session.add"
          }
        },
        {
          "file": "contracts/decisions.py",
          "line": 949,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'backfill_run_id_for_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: backfill_run_id_for_request",
          "signal_data": {
            "function": "backfill_run_id_for_request",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "contracts/decisions.py",
          "line": 182,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'emit' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: emit",
          "signal_data": {
            "function": "emit",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "contracts/decisions.py",
          "line": 264,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_emit_sync_impl' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _emit_sync_impl",
          "signal_data": {
            "function": "_emit_sync_impl",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "costsim/alert_worker.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (worker) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 1 lines",
          "signal_data": null
        },
        {
          "file": "costsim/alert_worker.py",
          "line": 303,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'enqueue_alert' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: enqueue_alert",
          "signal_data": {
            "function": "enqueue_alert",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/alert_worker.py",
          "line": 303,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'enqueue_alert' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: enqueue_alert",
          "signal_data": {
            "function": "enqueue_alert",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/alert_worker.py",
          "line": 357,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'retry_failed_alerts' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: retry_failed_alerts",
          "signal_data": {
            "function": "retry_failed_alerts",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/alert_worker.py",
          "line": 395,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'purge_old_alerts' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: purge_old_alerts",
          "signal_data": {
            "function": "purge_old_alerts",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/alert_worker.py",
          "line": 95,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'process_batch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: process_batch",
          "signal_data": {
            "function": "process_batch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/canary.py",
          "line": 574,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function '_save_artifacts' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "_save_artifacts",
            "blocking_call": "open"
          }
        },
        {
          "file": "costsim/canary.py",
          "line": 574,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function '_save_artifacts' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "_save_artifacts",
            "blocking_call": "open"
          }
        },
        {
          "file": "costsim/canary.py",
          "line": 574,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function '_save_artifacts' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "_save_artifacts",
            "blocking_call": "open"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 206,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_get_or_create_state' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_or_create_state",
          "signal_data": {
            "function": "_get_or_create_state",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 206,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_get_or_create_state' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_or_create_state",
          "signal_data": {
            "function": "_get_or_create_state",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 271,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_auto_recover' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _auto_recover",
          "signal_data": {
            "function": "_auto_recover",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 350,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'report_drift' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: report_drift",
          "signal_data": {
            "function": "report_drift",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 350,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'report_drift' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: report_drift",
          "signal_data": {
            "function": "report_drift",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 498,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'reset' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: reset",
          "signal_data": {
            "function": "reset",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 573,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_trip' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _trip",
          "signal_data": {
            "function": "_trip",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 573,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_trip' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _trip",
          "signal_data": {
            "function": "_trip",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 573,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_trip' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _trip",
          "signal_data": {
            "function": "_trip",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker.py",
          "line": 683,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_resolve_incident_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _resolve_incident_db",
          "signal_data": {
            "function": "_resolve_incident_db",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 130,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_get_or_create_state' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_or_create_state",
          "signal_data": {
            "function": "_get_or_create_state",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 130,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in '_get_or_create_state' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_or_create_state",
          "signal_data": {
            "function": "_get_or_create_state",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 229,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in '_try_auto_recover' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _try_auto_recover",
          "signal_data": {
            "function": "_try_auto_recover",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 321,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_auto_recover' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _auto_recover",
          "signal_data": {
            "function": "_auto_recover",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 598,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_trip' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _trip",
          "signal_data": {
            "function": "_trip",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 598,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in '_trip' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _trip",
          "signal_data": {
            "function": "_trip",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 694,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_resolve_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _resolve_incident",
          "signal_data": {
            "function": "_resolve_incident",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 762,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_enqueue_alert' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _enqueue_alert",
          "signal_data": {
            "function": "_enqueue_alert",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/circuit_breaker_async.py",
          "line": 762,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in '_enqueue_alert' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _enqueue_alert",
          "signal_data": {
            "function": "_enqueue_alert",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "costsim/provenance.py",
          "line": 268,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function '_write_to_file' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "_write_to_file",
            "blocking_call": "open"
          }
        },
        {
          "file": "costsim/provenance.py",
          "line": 300,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function 'query' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "query",
            "blocking_call": "open"
          }
        },
        {
          "file": "costsim/provenance_async.py",
          "line": 61,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'write_provenance' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: write_provenance",
          "signal_data": {
            "function": "write_provenance",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/provenance_async.py",
          "line": 61,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'write_provenance' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: write_provenance",
          "signal_data": {
            "function": "write_provenance",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "costsim/provenance_async.py",
          "line": 146,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'write_provenance_batch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: write_provenance_batch",
          "signal_data": {
            "function": "write_provenance_batch",
            "write_operation": "session.add"
          }
        },
        {
          "file": "costsim/provenance_async.py",
          "line": 146,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'write_provenance_batch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: write_provenance_batch",
          "signal_data": {
            "function": "write_provenance_batch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "discovery/ledger.py",
          "line": 50,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'emit_signal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: emit_signal",
          "signal_data": {
            "function": "emit_signal",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "integrations/bridges.py",
          "line": 111,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'record_policy_activation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_policy_activation",
          "signal_data": {
            "function": "record_policy_activation",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/bridges.py",
          "line": 415,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_increment_pattern_count' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _increment_pattern_count",
          "signal_data": {
            "function": "_increment_pattern_count",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/bridges.py",
          "line": 432,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_create_pattern' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _create_pattern",
          "signal_data": {
            "function": "_create_pattern",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/bridges.py",
          "line": 668,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_persist_recovery' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_recovery",
          "signal_data": {
            "function": "_persist_recovery",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/bridges.py",
          "line": 867,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_persist_policy' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_policy",
          "signal_data": {
            "function": "_persist_policy",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/bridges.py",
          "line": 1142,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_persist_adjustment' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_adjustment",
          "signal_data": {
            "function": "_persist_adjustment",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/cost_snapshots.py",
          "line": 623,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_insert_snapshot' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert_snapshot",
          "signal_data": {
            "function": "_insert_snapshot",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "integrations/cost_snapshots.py",
          "line": 651,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_update_snapshot' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update_snapshot",
          "signal_data": {
            "function": "_update_snapshot",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "integrations/cost_snapshots.py",
          "line": 675,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_insert_aggregate' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert_aggregate",
          "signal_data": {
            "function": "_insert_aggregate",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "integrations/cost_snapshots.py",
          "line": 794,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_insert_baseline' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert_baseline",
          "signal_data": {
            "function": "_insert_baseline",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "integrations/cost_snapshots.py",
          "line": 971,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_insert_evaluation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert_evaluation",
          "signal_data": {
            "function": "_insert_evaluation",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "integrations/cost_snapshots.py",
          "line": 1005,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_create_anomaly_from_evaluation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _create_anomaly_from_evaluation",
          "signal_data": {
            "function": "_create_anomaly_from_evaluation",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "integrations/dispatcher.py",
          "line": 516,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_persist_event' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_event",
          "signal_data": {
            "function": "_persist_event",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/dispatcher.py",
          "line": 555,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_persist_loop_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_loop_status",
          "signal_data": {
            "function": "_persist_loop_status",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/dispatcher.py",
          "line": 591,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_persist_checkpoint' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_checkpoint",
          "signal_data": {
            "function": "_persist_checkpoint",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "integrations/graduation_engine.py",
          "line": 757,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'persist_graduation_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_graduation_status",
          "signal_data": {
            "function": "persist_graduation_status",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "jobs/graduation_evaluator.py",
          "line": 38,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'evaluate_graduation_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: evaluate_graduation_status",
          "signal_data": {
            "function": "evaluate_graduation_status",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "jobs/storage.py",
          "line": 451,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_record_export_to_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _record_export_to_db",
          "signal_data": {
            "function": "_record_export_to_db",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "jobs/storage.py",
          "line": 491,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_update_export_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update_export_status",
          "signal_data": {
            "function": "_update_export_status",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/memory_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) missing semantic header",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "No header comments found",
          "signal_data": null
        },
        {
          "file": "memory/memory_service.py",
          "line": 303,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'set' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: set",
          "signal_data": {
            "function": "set",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/memory_service.py",
          "line": 415,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'delete' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete",
          "signal_data": {
            "function": "delete",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/memory_service.py",
          "line": 565,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_audit' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _audit",
          "signal_data": {
            "function": "_audit",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/store.py",
          "line": 64,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'store' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: store",
          "signal_data": {
            "function": "store",
            "write_operation": "session.add"
          }
        },
        {
          "file": "memory/store.py",
          "line": 64,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'store' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: store",
          "signal_data": {
            "function": "store",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/store.py",
          "line": 195,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.delete' in 'delete' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete",
          "signal_data": {
            "function": "delete",
            "write_operation": "session.delete"
          }
        },
        {
          "file": "memory/store.py",
          "line": 195,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'delete' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete",
          "signal_data": {
            "function": "delete",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/vector_store.py",
          "line": 266,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'store' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: store",
          "signal_data": {
            "function": "store",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/vector_store.py",
          "line": 594,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'delete' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete",
          "signal_data": {
            "function": "delete",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "memory/vector_store.py",
          "line": 604,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'backfill_embeddings' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: backfill_embeddings",
          "signal_data": {
            "function": "backfill_embeddings",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "optimization/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "optimization/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Layer",
          "declared": "# Layer: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "optimization/audit_persistence.py",
          "line": 62,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.add' in 'persist_audit_record' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_audit_record",
          "signal_data": {
            "function": "persist_audit_record",
            "write_operation": "db.add"
          }
        },
        {
          "file": "optimization/audit_persistence.py",
          "line": 62,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'persist_audit_record' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_audit_record",
          "signal_data": {
            "function": "persist_audit_record",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "optimization/envelopes/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "optimization/envelopes/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Layer",
          "declared": "# Layer: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "policy/engine.py",
          "line": 1186,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_persist_evaluation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_evaluation",
          "signal_data": {
            "function": "_persist_evaluation",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1186,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_persist_evaluation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_evaluation",
          "signal_data": {
            "function": "_persist_evaluation",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1417,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'acknowledge_violation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: acknowledge_violation",
          "signal_data": {
            "function": "acknowledge_violation",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1467,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'update_risk_ceiling' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_risk_ceiling",
          "signal_data": {
            "function": "update_risk_ceiling",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1502,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'reset_risk_ceiling' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: reset_risk_ceiling",
          "signal_data": {
            "function": "reset_risk_ceiling",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1543,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'update_safety_rule' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_safety_rule",
          "signal_data": {
            "function": "update_safety_rule",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1723,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'create_policy_version' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_policy_version",
          "signal_data": {
            "function": "create_policy_version",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 1790,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'rollback_to_version' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: rollback_to_version",
          "signal_data": {
            "function": "rollback_to_version",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 2007,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'resolve_conflict' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: resolve_conflict",
          "signal_data": {
            "function": "resolve_conflict",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 2076,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'create_temporal_policy' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_temporal_policy",
          "signal_data": {
            "function": "create_temporal_policy",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 2456,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'add_dependency_with_dag_check' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: add_dependency_with_dag_check",
          "signal_data": {
            "function": "add_dependency_with_dag_check",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 2615,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'prune_temporal_metrics' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: prune_temporal_metrics",
          "signal_data": {
            "function": "prune_temporal_metrics",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "policy/engine.py",
          "line": 2786,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'activate_policy_version' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: activate_policy_version",
          "signal_data": {
            "function": "activate_policy_version",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "routing/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "routing/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Layer",
          "declared": "# Layer: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "routing/care.py",
          "line": 432,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_persist_decision' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_decision",
          "signal_data": {
            "function": "_persist_decision",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "runtime/failure_catalog.py",
          "line": 577,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'persist_failure_match' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_failure_match",
          "signal_data": {
            "function": "persist_failure_match",
            "write_operation": "session.add"
          }
        },
        {
          "file": "runtime/failure_catalog.py",
          "line": 577,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'persist_failure_match' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_failure_match",
          "signal_data": {
            "function": "persist_failure_match",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "runtime/failure_catalog.py",
          "line": 791,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'update_recovery_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_recovery_status",
          "signal_data": {
            "function": "update_recovery_status",
            "write_operation": "session.add"
          }
        },
        {
          "file": "runtime/failure_catalog.py",
          "line": 791,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'update_recovery_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_recovery_status",
          "signal_data": {
            "function": "update_recovery_status",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "security/__init__.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "skills/base.py",
          "line": 119,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_upsert_state' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _upsert_state",
          "signal_data": {
            "function": "_upsert_state",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "skills/postgres_query.py",
          "line": 113,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: execute",
          "signal_data": {
            "function": "execute",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "skills/registry_v2.py",
          "line": 146,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self._db.commit' in '_init_persistence' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _init_persistence",
          "signal_data": {
            "function": "_init_persistence",
            "write_operation": "self._db.commit"
          }
        },
        {
          "file": "skills/registry_v2.py",
          "line": 213,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self._db.commit' in '_persist_registration' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _persist_registration",
          "signal_data": {
            "function": "_persist_registration",
            "write_operation": "self._db.commit"
          }
        },
        {
          "file": "skills/registry_v2.py",
          "line": 235,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self._db.commit' in 'deregister' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: deregister",
          "signal_data": {
            "function": "deregister",
            "write_operation": "self._db.commit"
          }
        },
        {
          "file": "stores/checkpoint_offload.py",
          "line": 369,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function 'restore_checkpoint_from_r2' calls blocking 'read'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: read",
          "signal_data": {
            "function": "restore_checkpoint_from_r2",
            "blocking_call": "read"
          }
        },
        {
          "file": "stores/checkpoint_offload.py",
          "line": 369,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function 'restore_checkpoint_from_r2' calls blocking 'read'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: read",
          "signal_data": {
            "function": "restore_checkpoint_from_r2",
            "blocking_call": "read"
          }
        },
        {
          "file": "tasks/recovery_queue_stream.py",
          "line": 682,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'archive_dead_letter_to_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: archive_dead_letter_to_db",
          "signal_data": {
            "function": "archive_dead_letter_to_db",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "tasks/recovery_queue_stream.py",
          "line": 1172,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_record_replay_to_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _record_replay_to_db",
          "signal_data": {
            "function": "_record_replay_to_db",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 111,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_init_db' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _init_db",
          "signal_data": {
            "function": "_init_db",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 181,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'start_trace' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: start_trace",
          "signal_data": {
            "function": "start_trace",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 211,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'record_step' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_step",
          "signal_data": {
            "function": "record_step",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 255,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'complete_trace' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: complete_trace",
          "signal_data": {
            "function": "complete_trace",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 391,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'delete_trace' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete_trace",
          "signal_data": {
            "function": "delete_trace",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 415,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'cleanup_old_traces' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: cleanup_old_traces",
          "signal_data": {
            "function": "cleanup_old_traces",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 570,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'update_trace_determinism' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_trace_determinism",
          "signal_data": {
            "function": "update_trace_determinism",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 191,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_insert' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert",
          "signal_data": {
            "function": "_insert",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 227,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_insert' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert",
          "signal_data": {
            "function": "_insert",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 263,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_update' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update",
          "signal_data": {
            "function": "_update",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 394,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_delete' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _delete",
          "signal_data": {
            "function": "_delete",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 418,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_cleanup' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _cleanup",
          "signal_data": {
            "function": "_cleanup",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "traces/store.py",
          "line": 580,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in '_update' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update",
          "signal_data": {
            "function": "_update",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "utils/budget_tracker.py",
          "line": 335,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_pause_agent' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _pause_agent",
          "signal_data": {
            "function": "_pause_agent",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "utils/budget_tracker.py",
          "line": 353,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'deduct' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: deduct",
          "signal_data": {
            "function": "deduct",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "utils/budget_tracker.py",
          "line": 414,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'record_cost' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_cost",
          "signal_data": {
            "function": "record_cost",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "utils/db_helpers.py",
          "line": 378,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'get_or_create' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: get_or_create",
          "signal_data": {
            "function": "get_or_create",
            "write_operation": "session.add"
          }
        },
        {
          "file": "utils/db_helpers.py",
          "line": 378,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'get_or_create' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: get_or_create",
          "signal_data": {
            "function": "get_or_create",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/outbox_processor.py",
          "line": 107,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'acquire_lock' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: acquire_lock",
          "signal_data": {
            "function": "acquire_lock",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/outbox_processor.py",
          "line": 132,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'release_lock' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: release_lock",
          "signal_data": {
            "function": "release_lock",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/outbox_processor.py",
          "line": 150,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'extend_lock' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: extend_lock",
          "signal_data": {
            "function": "extend_lock",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/outbox_processor.py",
          "line": 168,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'claim_events' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: claim_events",
          "signal_data": {
            "function": "claim_events",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/outbox_processor.py",
          "line": 341,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'complete_event' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: complete_event",
          "signal_data": {
            "function": "complete_event",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/pool.py",
          "line": 111,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_mark_run_started' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _mark_run_started",
          "signal_data": {
            "function": "_mark_run_started",
            "write_operation": "session.add"
          }
        },
        {
          "file": "worker/pool.py",
          "line": 111,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_mark_run_started' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _mark_run_started",
          "signal_data": {
            "function": "_mark_run_started",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_claim_worker.py",
          "line": 107,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'claim_batch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: claim_batch",
          "signal_data": {
            "function": "claim_batch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_claim_worker.py",
          "line": 235,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'update_candidate' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_candidate",
          "signal_data": {
            "function": "update_candidate",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_claim_worker.py",
          "line": 284,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'release_pending' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: release_pending",
          "signal_data": {
            "function": "release_pending",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_evaluator.py",
          "line": 358,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_select_action' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _select_action",
          "signal_data": {
            "function": "_select_action",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_evaluator.py",
          "line": 409,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_record_provenance' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _record_provenance",
          "signal_data": {
            "function": "_record_provenance",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_evaluator.py",
          "line": 460,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_auto_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _auto_execute",
          "signal_data": {
            "function": "_auto_execute",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/recovery_evaluator.py",
          "line": 460,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_auto_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _auto_execute",
          "signal_data": {
            "function": "_auto_execute",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 175,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_update_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update_run",
          "signal_data": {
            "function": "_update_run",
            "write_operation": "session.add"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 175,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_update_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update_run",
          "signal_data": {
            "function": "_update_run",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 236,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute",
          "signal_data": {
            "function": "_execute",
            "write_operation": "session.add"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 236,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute",
          "signal_data": {
            "function": "_execute",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 236,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute",
          "signal_data": {
            "function": "_execute",
            "write_operation": "session.add"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 236,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute",
          "signal_data": {
            "function": "_execute",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 236,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute",
          "signal_data": {
            "function": "_execute",
            "write_operation": "session.add"
          }
        },
        {
          "file": "worker/runner.py",
          "line": 236,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_execute' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _execute",
          "signal_data": {
            "function": "_execute",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "workflow/checkpoint.py",
          "line": 227,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'save' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: save",
          "signal_data": {
            "function": "save",
            "write_operation": "session.add"
          }
        },
        {
          "file": "workflow/checkpoint.py",
          "line": 227,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'save' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: save",
          "signal_data": {
            "function": "save",
            "write_operation": "session.add"
          }
        },
        {
          "file": "workflow/checkpoint.py",
          "line": 428,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.delete' in 'delete' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete",
          "signal_data": {
            "function": "delete",
            "write_operation": "session.delete"
          }
        },
        {
          "file": "workflow/golden.py",
          "line": 316,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function '_append' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "_append",
            "blocking_call": "open"
          }
        }
      ]
    },
    "L4": {
      "count": 105,
      "high_risk_count": 83,
      "findings": [
        {
          "file": "agents/services/blackboard_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 8 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/credit_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 11 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/credit_service.py",
          "line": 187,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'log_reservation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: log_reservation",
          "signal_data": {
            "function": "log_reservation",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/credit_service.py",
          "line": 276,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'spend_for_item' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: spend_for_item",
          "signal_data": {
            "function": "spend_for_item",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/credit_service.py",
          "line": 324,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'refund_for_item' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: refund_for_item",
          "signal_data": {
            "function": "refund_for_item",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/credit_service.py",
          "line": 381,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'charge_skill' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: charge_skill",
          "signal_data": {
            "function": "charge_skill",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/governance_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 9 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/governance_service.py",
          "line": 220,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'update_job_budget' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_job_budget",
          "signal_data": {
            "function": "update_job_budget",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/governance_service.py",
          "line": 315,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'allocate_worker_budget' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: allocate_worker_budget",
          "signal_data": {
            "function": "allocate_worker_budget",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/governance_service.py",
          "line": 436,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'record_item_llm_usage' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_item_llm_usage",
          "signal_data": {
            "function": "record_item_llm_usage",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/invoke_audit_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 4 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/invoke_audit_service.py",
          "line": 63,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'start_invoke' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: start_invoke",
          "signal_data": {
            "function": "start_invoke",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/invoke_audit_service.py",
          "line": 131,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'complete_invoke' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: complete_invoke",
          "signal_data": {
            "function": "complete_invoke",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/invoke_audit_service.py",
          "line": 185,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'fail_invoke' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: fail_invoke",
          "signal_data": {
            "function": "fail_invoke",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/job_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 8 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/job_service.py",
          "line": 127,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'create_job' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_job",
          "signal_data": {
            "function": "create_job",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/job_service.py",
          "line": 406,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'check_job_completion' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: check_job_completion",
          "signal_data": {
            "function": "check_job_completion",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/job_service.py",
          "line": 468,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'cancel_job' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: cancel_job",
          "signal_data": {
            "function": "cancel_job",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/message_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 5 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/message_service.py",
          "line": 97,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'send' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: send",
          "signal_data": {
            "function": "send",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/message_service.py",
          "line": 289,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'mark_delivered' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: mark_delivered",
          "signal_data": {
            "function": "mark_delivered",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/message_service.py",
          "line": 312,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'mark_read' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: mark_read",
          "signal_data": {
            "function": "mark_read",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/message_service.py",
          "line": 512,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'cleanup_old_messages' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: cleanup_old_messages",
          "signal_data": {
            "function": "cleanup_old_messages",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 4 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 81,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'register' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: register",
          "signal_data": {
            "function": "register",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 157,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'heartbeat' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: heartbeat",
          "signal_data": {
            "function": "heartbeat",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 198,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'deregister' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: deregister",
          "signal_data": {
            "function": "deregister",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 336,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'mark_instance_stale' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: mark_instance_stale",
          "signal_data": {
            "function": "mark_instance_stale",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 376,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'mark_stale' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: mark_stale",
          "signal_data": {
            "function": "mark_stale",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 376,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'mark_stale' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: mark_stale",
          "signal_data": {
            "function": "mark_stale",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 428,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'reclaim_stale_items' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: reclaim_stale_items",
          "signal_data": {
            "function": "reclaim_stale_items",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/registry_service.py",
          "line": 428,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'reclaim_stale_items' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: reclaim_stale_items",
          "signal_data": {
            "function": "reclaim_stale_items",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (service) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 4 lines",
          "signal_data": null
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 76,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'claim_item' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: claim_item",
          "signal_data": {
            "function": "claim_item",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 172,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_claim_item_raw' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _claim_item_raw",
          "signal_data": {
            "function": "_claim_item_raw",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 277,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'start_item' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: start_item",
          "signal_data": {
            "function": "start_item",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 308,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'complete_item' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: complete_item",
          "signal_data": {
            "function": "complete_item",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 436,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'fail_item' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: fail_item",
          "signal_data": {
            "function": "fail_item",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "agents/services/worker_service.py",
          "line": 557,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'release_claimed' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: release_claimed",
          "signal_data": {
            "function": "release_claimed",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/certificate.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 676,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_record_breach_and_get_consecutive_count' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _record_breach_and_get_consecutive_count",
          "signal_data": {
            "function": "_record_breach_and_get_consecutive_count",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 784,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_update_drift_tracking' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update_drift_tracking",
          "signal_data": {
            "function": "_update_drift_tracking",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 784,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_update_drift_tracking' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _update_drift_tracking",
          "signal_data": {
            "function": "_update_drift_tracking",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 878,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_reset_drift_tracking' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _reset_drift_tracking",
          "signal_data": {
            "function": "_reset_drift_tracking",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 1039,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'persist_anomalies' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_anomalies",
          "signal_data": {
            "function": "persist_anomalies",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 1151,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L4 imports from L6",
          "declared": "Layer L4 should not import L6",
          "observed": "Import: app.integrations.cost_bridges",
          "signal_data": {
            "source_layer": "L4",
            "target_layer": "L6",
            "import_path": "app.integrations.cost_bridges"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 1154,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L4 imports from L6",
          "declared": "Layer L4 should not import L6",
          "observed": "Import: app.integrations.cost_bridges",
          "signal_data": {
            "source_layer": "L4",
            "target_layer": "L6",
            "import_path": "app.integrations.cost_bridges"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 1157,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L4 imports from L6",
          "declared": "Layer L4 should not import L6",
          "observed": "Import: app.integrations.cost_bridges",
          "signal_data": {
            "source_layer": "L4",
            "target_layer": "L6",
            "import_path": "app.integrations.cost_bridges"
          }
        },
        {
          "file": "services/cost_anomaly_detector.py",
          "line": 1160,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L4 imports from L6",
          "declared": "Layer L4 should not import L6",
          "observed": "Import: app.integrations.cost_bridges",
          "signal_data": {
            "source_layer": "L4",
            "target_layer": "L6",
            "import_path": "app.integrations.cost_bridges"
          }
        },
        {
          "file": "services/email_verification.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/event_emitter.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/evidence_report.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 263,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_get_rate_limit_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_rate_limit_incident",
          "signal_data": {
            "function": "_get_rate_limit_incident",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 263,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_get_rate_limit_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_rate_limit_incident",
          "signal_data": {
            "function": "_get_rate_limit_incident",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 263,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_get_rate_limit_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_rate_limit_incident",
          "signal_data": {
            "function": "_get_rate_limit_incident",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 263,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_get_rate_limit_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _get_rate_limit_incident",
          "signal_data": {
            "function": "_get_rate_limit_incident",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 311,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_create_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _create_incident",
          "signal_data": {
            "function": "_create_incident",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 311,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_create_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _create_incident",
          "signal_data": {
            "function": "_create_incident",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 366,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_add_call_to_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _add_call_to_incident",
          "signal_data": {
            "function": "_add_call_to_incident",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 366,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_add_call_to_incident' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _add_call_to_incident",
          "signal_data": {
            "function": "_add_call_to_incident",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 448,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in '_add_incident_event' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _add_incident_event",
          "signal_data": {
            "function": "_add_incident_event",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 448,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_add_incident_event' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _add_incident_event",
          "signal_data": {
            "function": "_add_incident_event",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 471,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'resolve_stale_incidents' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: resolve_stale_incidents",
          "signal_data": {
            "function": "resolve_stale_incidents",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/incident_aggregator.py",
          "line": 471,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'resolve_stale_incidents' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: resolve_stale_incidents",
          "signal_data": {
            "function": "resolve_stale_incidents",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/llm_failure_service.py",
          "line": 128,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self._session.commit' in 'persist_failure_and_mark_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_failure_and_mark_run",
          "signal_data": {
            "function": "persist_failure_and_mark_run",
            "write_operation": "self._session.commit"
          }
        },
        {
          "file": "services/orphan_recovery.py",
          "line": 114,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'recover_orphaned_runs' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: recover_orphaned_runs",
          "signal_data": {
            "function": "recover_orphaned_runs",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/pattern_detection.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/pattern_detection.py",
          "line": 227,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'emit_feedback' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: emit_feedback",
          "signal_data": {
            "function": "emit_feedback",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/pattern_detection.py",
          "line": 227,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in 'emit_feedback' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: emit_feedback",
          "signal_data": {
            "function": "emit_feedback",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "services/pattern_detection.py",
          "line": 268,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'run_pattern_detection' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: run_pattern_detection",
          "signal_data": {
            "function": "run_pattern_detection",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/policy_proposal.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/policy_proposal.py",
          "line": 115,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'create_policy_proposal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_policy_proposal",
          "signal_data": {
            "function": "create_policy_proposal",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/policy_proposal.py",
          "line": 115,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in 'create_policy_proposal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_policy_proposal",
          "signal_data": {
            "function": "create_policy_proposal",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "services/policy_proposal.py",
          "line": 153,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'review_policy_proposal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: review_policy_proposal",
          "signal_data": {
            "function": "review_policy_proposal",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/policy_proposal.py",
          "line": 153,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in 'review_policy_proposal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: review_policy_proposal",
          "signal_data": {
            "function": "review_policy_proposal",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "services/policy_proposal.py",
          "line": 232,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'generate_proposals_from_feedback' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: generate_proposals_from_feedback",
          "signal_data": {
            "function": "generate_proposals_from_feedback",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/policy_violation_service.py",
          "line": 110,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'persist_violation_fact' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_violation_fact",
          "signal_data": {
            "function": "persist_violation_fact",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/policy_violation_service.py",
          "line": 194,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'persist_evidence' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: persist_evidence",
          "signal_data": {
            "function": "persist_evidence",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/policy_violation_service.py",
          "line": 262,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'sync_session.commit' in 'create_incident_from_violation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_incident_from_violation",
          "signal_data": {
            "function": "create_incident_from_violation",
            "write_operation": "sync_session.commit"
          }
        },
        {
          "file": "services/prediction.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/prediction.py",
          "line": 276,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'emit_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: emit_prediction",
          "signal_data": {
            "function": "emit_prediction",
            "write_operation": "session.add"
          }
        },
        {
          "file": "services/prediction.py",
          "line": 276,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.flush' in 'emit_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: emit_prediction",
          "signal_data": {
            "function": "emit_prediction",
            "write_operation": "session.flush"
          }
        },
        {
          "file": "services/prediction.py",
          "line": 318,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'run_prediction_cycle' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: run_prediction_cycle",
          "signal_data": {
            "function": "run_prediction_cycle",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/recovery_matcher.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/recovery_matcher.py",
          "line": 576,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in '_upsert_candidate' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _upsert_candidate",
          "signal_data": {
            "function": "_upsert_candidate",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/recovery_matcher.py",
          "line": 814,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'approve_candidate' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: approve_candidate",
          "signal_data": {
            "function": "approve_candidate",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "services/recovery_rule_engine.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "services/tenant_service.py",
          "line": 67,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'create_tenant' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_tenant",
          "signal_data": {
            "function": "create_tenant",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 112,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'update_tenant_plan' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_tenant_plan",
          "signal_data": {
            "function": "update_tenant_plan",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 135,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'suspend_tenant' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: suspend_tenant",
          "signal_data": {
            "function": "suspend_tenant",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 151,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'create_membership_with_default' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_membership_with_default",
          "signal_data": {
            "function": "create_membership_with_default",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 200,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'create_api_key' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_api_key",
          "signal_data": {
            "function": "create_api_key",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 282,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'revoke_api_key' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: revoke_api_key",
          "signal_data": {
            "function": "revoke_api_key",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 367,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'increment_usage' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: increment_usage",
          "signal_data": {
            "function": "increment_usage",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 378,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_maybe_reset_daily_counter' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _maybe_reset_daily_counter",
          "signal_data": {
            "function": "_maybe_reset_daily_counter",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 378,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in '_maybe_reset_daily_counter' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _maybe_reset_daily_counter",
          "signal_data": {
            "function": "_maybe_reset_daily_counter",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 394,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'record_usage' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_usage",
          "signal_data": {
            "function": "record_usage",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 468,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'create_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_run",
          "signal_data": {
            "function": "create_run",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/tenant_service.py",
          "line": 503,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'complete_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: complete_run",
          "signal_data": {
            "function": "complete_run",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/worker_registry_service.py",
          "line": 175,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'register_worker' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: register_worker",
          "signal_data": {
            "function": "register_worker",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/worker_registry_service.py",
          "line": 217,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'update_worker_status' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_worker_status",
          "signal_data": {
            "function": "update_worker_status",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/worker_registry_service.py",
          "line": 245,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'set_tenant_worker_config' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: set_tenant_worker_config",
          "signal_data": {
            "function": "set_tenant_worker_config",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/worker_registry_service.py",
          "line": 245,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'set_tenant_worker_config' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: set_tenant_worker_config",
          "signal_data": {
            "function": "set_tenant_worker_config",
            "write_operation": "self.session.commit"
          }
        },
        {
          "file": "services/worker_write_service_async.py",
          "line": 238,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'self.session.commit' in 'commit' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: commit",
          "signal_data": {
            "function": "commit",
            "write_operation": "self.session.commit"
          }
        }
      ]
    },
    "L5": {
      "count": 59,
      "high_risk_count": 46,
      "findings": [
        {
          "file": "api/agents.py",
          "line": 2101,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'conn.commit' in 'update_agent_strategy' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_agent_strategy",
          "signal_data": {
            "function": "update_agent_strategy",
            "write_operation": "conn.commit"
          }
        },
        {
          "file": "api/costsim.py",
          "line": 59,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.tasks.memory_update",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.tasks.memory_update"
          }
        },
        {
          "file": "api/customer_visibility.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "api/founder_actions.py",
          "line": 259,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in 'execute_action' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: execute_action",
          "signal_data": {
            "function": "execute_action",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/founder_actions.py",
          "line": 517,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in 'execute_reversal' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: execute_reversal",
          "signal_data": {
            "function": "execute_reversal",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/guard.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "api/integration.py",
          "line": 900,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'simulate_prevention' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: simulate_prevention",
          "signal_data": {
            "function": "simulate_prevention",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/integration.py",
          "line": 978,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'simulate_regret' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: simulate_regret",
          "signal_data": {
            "function": "simulate_regret",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/integration.py",
          "line": 1070,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'simulate_timeline_view' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: simulate_timeline_view",
          "signal_data": {
            "function": "simulate_timeline_view",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/integration.py",
          "line": 1132,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'record_timeline_view' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_timeline_view",
          "signal_data": {
            "function": "record_timeline_view",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/integration.py",
          "line": 1198,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'trigger_graduation_re_evaluation' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: trigger_graduation_re_evaluation",
          "signal_data": {
            "function": "trigger_graduation_re_evaluation",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/legacy_routes.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (api_router) missing semantic header",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "No header comments found",
          "signal_data": null
        },
        {
          "file": "api/memory_pins.py",
          "line": 135,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'write_memory_audit' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: write_memory_audit",
          "signal_data": {
            "function": "write_memory_audit",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "api/memory_pins.py",
          "line": 192,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'create_or_upsert_pin' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_or_upsert_pin",
          "signal_data": {
            "function": "create_or_upsert_pin",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "api/memory_pins.py",
          "line": 448,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'delete_pin' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete_pin",
          "signal_data": {
            "function": "delete_pin",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "api/memory_pins.py",
          "line": 505,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'cleanup_expired_pins' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: cleanup_expired_pins",
          "signal_data": {
            "function": "cleanup_expired_pins",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 627,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'create_approval_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_approval_request",
          "signal_data": {
            "function": "create_approval_request",
            "write_operation": "session.add"
          }
        },
        {
          "file": "api/policy.py",
          "line": 627,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'create_approval_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_approval_request",
          "signal_data": {
            "function": "create_approval_request",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 704,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'get_approval_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: get_approval_request",
          "signal_data": {
            "function": "get_approval_request",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 825,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'approve_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: approve_request",
          "signal_data": {
            "function": "approve_request",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 825,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'approve_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: approve_request",
          "signal_data": {
            "function": "approve_request",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 892,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'reject_request' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: reject_request",
          "signal_data": {
            "function": "reject_request",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 939,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'list_approval_requests' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: list_approval_requests",
          "signal_data": {
            "function": "list_approval_requests",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/policy.py",
          "line": 1011,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'run_escalation_check' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: run_escalation_check",
          "signal_data": {
            "function": "run_escalation_check",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/rbac_api.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (api_router) missing semantic header",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "No header comments found",
          "signal_data": null
        },
        {
          "file": "api/rbac_api.py",
          "line": 291,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'cleanup_audit_logs' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: cleanup_audit_logs",
          "signal_data": {
            "function": "cleanup_audit_logs",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "api/recovery.py",
          "line": 576,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in 'update_candidate' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: update_candidate",
          "signal_data": {
            "function": "update_candidate",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/recovery_ingest.py",
          "line": 117,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in 'ingest_failure' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: ingest_failure",
          "signal_data": {
            "function": "ingest_failure",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/recovery_ingest.py",
          "line": 286,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in '_enqueue_evaluation_async' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _enqueue_evaluation_async",
          "signal_data": {
            "function": "_enqueue_evaluation_async",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/recovery_ingest.py",
          "line": 313,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.tasks.recovery_queue_stream",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.tasks.recovery_queue_stream"
          }
        },
        {
          "file": "api/status_history.py",
          "line": 295,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function 'create_export' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "create_export",
            "blocking_call": "open"
          }
        },
        {
          "file": "api/status_history.py",
          "line": 295,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function 'create_export' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "create_export",
            "blocking_call": "open"
          }
        },
        {
          "file": "api/status_history.py",
          "line": 362,
          "type": "ASYNC_BLOCKING_CALL",
          "severity": "HIGH_RISK",
          "message": "Async function 'download_export' calls blocking 'open'",
          "declared": "Async function should use async I/O",
          "observed": "Uses blocking call: open",
          "signal_data": {
            "function": "download_export",
            "blocking_call": "open"
          }
        },
        {
          "file": "api/traces.py",
          "line": 653,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'bulk_report_mismatches' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: bulk_report_mismatches",
          "signal_data": {
            "function": "bulk_report_mismatches",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/traces.py",
          "line": 778,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'report_mismatch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: report_mismatch",
          "signal_data": {
            "function": "report_mismatch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/traces.py",
          "line": 778,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'report_mismatch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: report_mismatch",
          "signal_data": {
            "function": "report_mismatch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/traces.py",
          "line": 778,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'report_mismatch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: report_mismatch",
          "signal_data": {
            "function": "report_mismatch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/traces.py",
          "line": 1015,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'resolve_mismatch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: resolve_mismatch",
          "signal_data": {
            "function": "resolve_mismatch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/v1_killswitch.py",
          "line": 1,
          "type": "INCOMPLETE_SEMANTIC_HEADER",
          "severity": "INFO",
          "message": "Semantic header missing required field: Role",
          "declared": "# Role: <value>",
          "observed": "Field not present",
          "signal_data": null
        },
        {
          "file": "api/v1_proxy.py",
          "line": 248,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'record_usage_after_killswitch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_usage_after_killswitch",
          "signal_data": {
            "function": "record_usage_after_killswitch",
            "write_operation": "session.add"
          }
        },
        {
          "file": "api/v1_proxy.py",
          "line": 248,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'record_usage_after_killswitch' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: record_usage_after_killswitch",
          "signal_data": {
            "function": "record_usage_after_killswitch",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/v1_proxy.py",
          "line": 430,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.add' in 'log_proxy_call' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: log_proxy_call",
          "signal_data": {
            "function": "log_proxy_call",
            "write_operation": "session.add"
          }
        },
        {
          "file": "api/v1_proxy.py",
          "line": 430,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'session.commit' in 'log_proxy_call' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: log_proxy_call",
          "signal_data": {
            "function": "log_proxy_call",
            "write_operation": "session.commit"
          }
        },
        {
          "file": "api/workers.py",
          "line": 1,
          "type": "MISSING_SEMANTIC_HEADER",
          "severity": "WARNING",
          "message": "Boundary file (worker) has comments but no semantic header fields",
          "declared": "Semantic header with Layer, Role, etc.",
          "observed": "Comments found: 2 lines",
          "signal_data": null
        },
        {
          "file": "api/workers.py",
          "line": 194,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in '_store_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _store_run",
          "signal_data": {
            "function": "_store_run",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/workers.py",
          "line": 235,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in '_insert_cost_record' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _insert_cost_record",
          "signal_data": {
            "function": "_insert_cost_record",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/workers.py",
          "line": 273,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in '_check_and_emit_cost_advisory' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: _check_and_emit_cost_advisory",
          "signal_data": {
            "function": "_check_and_emit_cost_advisory",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/workers.py",
          "line": 1208,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'write_service.commit' in 'delete_run' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: delete_run",
          "signal_data": {
            "function": "delete_run",
            "write_operation": "write_service.commit"
          }
        },
        {
          "file": "api/workers.py",
          "line": 628,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.workers.business_builder.schemas.brand",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.workers.business_builder.schemas.brand"
          }
        },
        {
          "file": "api/workers.py",
          "line": 695,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.workers.business_builder.worker",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.workers.business_builder.worker"
          }
        },
        {
          "file": "api/workers.py",
          "line": 962,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.workers.business_builder.worker",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.workers.business_builder.worker"
          }
        },
        {
          "file": "api/workers.py",
          "line": 1020,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.workers.business_builder.worker",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.workers.business_builder.worker"
          }
        },
        {
          "file": "api/workers.py",
          "line": 1363,
          "type": "LAYER_IMPORT_VIOLATION",
          "severity": "WARNING",
          "message": "L5 imports from L7",
          "declared": "Layer L5 should not import L7",
          "observed": "Import: app.workers.business_builder.worker",
          "signal_data": {
            "source_layer": "L5",
            "target_layer": "L7",
            "import_path": "app.workers.business_builder.worker"
          }
        },
        {
          "file": "predictions/api.py",
          "line": 65,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.add' in 'create_incident_risk_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_incident_risk_prediction",
          "signal_data": {
            "function": "create_incident_risk_prediction",
            "write_operation": "db.add"
          }
        },
        {
          "file": "predictions/api.py",
          "line": 65,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'create_incident_risk_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_incident_risk_prediction",
          "signal_data": {
            "function": "create_incident_risk_prediction",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "predictions/api.py",
          "line": 144,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.add' in 'create_spend_spike_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_spend_spike_prediction",
          "signal_data": {
            "function": "create_spend_spike_prediction",
            "write_operation": "db.add"
          }
        },
        {
          "file": "predictions/api.py",
          "line": 144,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'create_spend_spike_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_spend_spike_prediction",
          "signal_data": {
            "function": "create_spend_spike_prediction",
            "write_operation": "db.commit"
          }
        },
        {
          "file": "predictions/api.py",
          "line": 202,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.add' in 'create_policy_drift_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_policy_drift_prediction",
          "signal_data": {
            "function": "create_policy_drift_prediction",
            "write_operation": "db.add"
          }
        },
        {
          "file": "predictions/api.py",
          "line": 202,
          "type": "WRITE_OUTSIDE_WRITE_SERVICE",
          "severity": "HIGH_RISK",
          "message": "DB write 'db.commit' in 'create_policy_drift_prediction' outside write service",
          "declared": "DB writes should be in *_write_service.py",
          "observed": "Write operation in: create_policy_drift_prediction",
          "signal_data": {
            "function": "create_policy_drift_prediction",
            "write_operation": "db.commit"
          }
        }
      ]
    }
  }
}
