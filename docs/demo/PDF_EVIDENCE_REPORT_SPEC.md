# PDF Evidence Report Specification

**Document Type: Legal-Grade Evidence Export**
**Version: 1.0**
**Status: Production Ready**

---

## Purpose

This document specifies the structure and content of the PDF Evidence Report generated by the AI Incident Console. The report is designed to survive:

- Legal review
- Audit compliance
- Executive briefing
- Hostile questioning

Assume the reader does not trust you.

---

## Document Metadata (Cover Page)

| Field | Value |
|-------|-------|
| Title | AI Incident Evidence Report |
| Subheading | Deterministic Reconstruction & Policy Evaluation |
| Generated By | AI Incident Console (Agenticverz) |
| Incident ID | `{incident_id}` |
| Generated At | `{timestamp} UTC` |
| Classification | Confidential – Internal / Legal Review |

**Footer (every page):**
> Generated automatically. Do not edit. Any modification invalidates verification.

---

## Section 1 — Executive Summary (1 page)

This is what lawyers read first. Keep it blunt.

### 1.1 Incident Overview

| Field | Value |
|-------|-------|
| Customer | `{tenant_name}` |
| User ID | `{user_id}` |
| Product | `{product_name}` |
| Model | `{model_id}` |
| Timestamp | `{timestamp} UTC` |

### 1.2 Incident Description

> The AI system provided a definitive contractual assertion despite missing required data, resulting in an inaccurate statement to the customer.

### 1.3 Impact Assessment

- Customer misinformation
- Potential contractual misrepresentation
- Elevated legal risk

### 1.4 Root Cause (Machine-Derived)

> Policy enforcement gap: the system asserted a fact when required data was NULL.

### 1.5 Preventability

```
✅ This incident would have been prevented by the active Content Accuracy
   policy if enforcement had been applied.
```

---

## Section 2 — Factual Reconstruction (Evidence)

This section is pure facts. No opinions.

### 2.1 User Input

```
"{user_input}"
```

### 2.2 Retrieved Context (System State)

| Field | Value |
|-------|-------|
| contract_status | active |
| auto_renew | NULL |
| renewal_date | 2026-01-01 |

**⚠️ Note:** Required field `auto_renew` was missing at decision time.

### 2.3 AI Output (As Delivered)

```
"{ai_output}"
```

---

## Section 3 — Policy Evaluation Record

This is where you win credibility.

### 3.1 Policies Applied

| Policy | Result |
|--------|--------|
| SAFETY | PASS |
| BUDGET_LIMIT | PASS |
| CONTENT_ACCURACY | **FAIL** |

### 3.2 Content Accuracy Policy Details

| Field | Value |
|-------|-------|
| Policy Rule | If required contractual data is missing, the system must express uncertainty. |
| Evaluation Result | Required field missing: `auto_renew` |
| Expected Behavior | Uncertainty / escalation |
| Actual Behavior | Definitive assertion |
| Policy Verdict | **FAIL** |

---

## Section 4 — Decision Timeline (Deterministic Trace)

This proves you are not reconstructing by inference.

| Time (UTC) | Event | Details |
|------------|-------|---------|
| 23:47:12.001 | INPUT_RECEIVED | User question received |
| 23:47:12.023 | CONTEXT_RETRIEVED | Contract data loaded |
| 23:47:12.050 | POLICY_EVALUATED | Content accuracy failed |
| 23:47:12.087 | MODEL_CALLED | gpt-4.1 invoked |
| 23:47:12.847 | OUTPUT_GENERATED | Response produced |
| 23:47:12.900 | LOGGED | Incident recorded |

---

## Section 5 — Deterministic Replay Verification

This is your hard moat.

### 5.1 Replay Status

```
✅ Replay successful
```

### 5.2 Hash Verification

| Item | SHA-256 |
|------|---------|
| Original Output | e3b0c442… |
| Replay Output | e3b0c442… |

### 5.3 Conclusion

> The system deterministically reproduced the original output. This evidence is cryptographically verified.

---

## Section 6 — Counterfactual Prevention Proof

This section is rare. It matters.

### 6.1 Prevention Simulation Result

```json
{
  "policy": "CONTENT_ACCURACY",
  "action": "MODIFY",
  "would_prevent_incident": true,
  "safe_output": "I don't have enough information to confirm this. Let me check."
}
```

### 6.2 Conclusion

> The active policy set, if enforced, would have prevented this incident.

---

## Section 7 — Remediation & Controls

### 7.1 Immediate Action

Policy enforcement hook enabled.

### 7.2 Control Status

- Policy remains active
- Enforcement level elevated

### 7.3 Future Risk

> Reduced. Similar incidents now blocked or modified automatically.

---

## Section 8 — Legal Attestation

> This report is automatically generated from deterministic system logs.
> No manual reconstruction or interpretation was performed.

| Field | Value |
|-------|-------|
| Verification Signature | sha256:7f3a2b9c… |
| Verification Timestamp | 2025-12-17 23:52:01 UTC |

---

## Watermark Policy

| Mode | Watermark |
|------|-----------|
| Demo | `DEMO / EVALUATION` diagonal watermark |
| Production | No watermark |

---

## API Usage

### Export Endpoint

```
POST /guard/incidents/{incident_id}/export
```

### Query Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| tenant_id | string | required | Tenant ID |
| include_replay | bool | true | Include replay verification section |
| include_prevention | bool | true | Include prevention proof section |
| is_demo | bool | true | Add demo watermark |

### Response

```
Content-Type: application/pdf
Content-Disposition: attachment; filename="evidence_report_{incident_id}_{timestamp}.pdf"
X-Incident-ID: {incident_id}
X-Generated-At: {iso_timestamp}
```

---

## Implementation

The PDF is generated using ReportLab with:

- Professional typography (Helvetica, Times)
- Color-coded status indicators
- Proper table formatting
- Cryptographic verification hash
- Automatic page numbering
- Legal-grade footer on every page

**Source file:** `backend/app/services/evidence_report.py`

---

## Document Classification

This specification is locked as of 2025-12-19.

Changes require founder approval.
