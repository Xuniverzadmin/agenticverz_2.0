# AOS Backend - Production Environment
# Copy to .env and fill in real values
# Secrets are managed in HashiCorp Vault â€” see scripts/ops/vault/README.md

# ===========================================
# Core Settings
# ===========================================
ENV=production
PORT=8000
HOST=127.0.0.1
AOS_MODE=prod

# ===========================================
# Database (Vault: agenticverz/database, secret/data/user/neon)
# ===========================================
DATABASE_URL=postgresql://VAULT_MANAGED@VAULT_MANAGED/nova_aos
DB_AUTHORITY=neon

# ===========================================
# Redis (Vault: secret/data/user/upstash)
# ===========================================
REDIS_URL=rediss://VAULT_MANAGED@VAULT_MANAGED:6379

# ===========================================
# OIDC / Clerk (Vault: agenticverz/app-prod)
# ===========================================
OIDC_ISSUER_URL=https://auth.xuniverz.com/realms/agentiverz
OIDC_CLIENT_ID=aos-backend
OIDC_VERIFY_SSL=true

# ===========================================
# RBAC
# ===========================================
RBAC_ENABLED=true
RBAC_ENFORCE=true

# ===========================================
# LLM Providers (Vault: agenticverz/external-apis)
# ===========================================
PLANNER_BACKEND=anthropic
LLM_ADAPTER=claude

# ===========================================
# Vault Configuration
# ===========================================
VAULT_ADDR=http://127.0.0.1:8200
# VAULT_TOKEN loaded from /opt/vault/.vault-keys at runtime

# ===========================================
# Multi-Tenancy
# ===========================================
TENANT_HEADER=X-Tenant-Id
ENFORCE_TENANCY=true
CUSTOMER_SANDBOX_ENABLED=false

# ===========================================
# Worker Configuration
# ===========================================
WORKER_CONCURRENCY=4
WORKER_POLL_INTERVAL=2.0
RUN_MAX_ATTEMPTS=5
EVENT_PUBLISHER=logging

# ===========================================
# Webhook
# ===========================================
WEBHOOK_KEY_VERSION=v1

# ===========================================
# Cloudflare R2 Storage (Vault: secret/data/user/r2)
# ===========================================
R2_UPLOAD_PREFIX=failure_patterns
R2_RETENTION_DAYS=90

# ===========================================
# Store Configuration
# ===========================================
BUDGET_STORE=redis
CHECKPOINT_STORE=postgres
CHECKPOINT_RETENTION_DAYS=7
CHECKPOINT_OFFLOAD_OLDER_THAN_DAYS=3

# ===========================================
# GitHub Integration (Vault: agenticverz/external-apis)
# ===========================================
GITHUB_REPO=Xuniverzadmin/agenticverz_2.0

# ===========================================
# Console Modes (Production)
# ===========================================
CONSOLE_MODE=LIVE
DATA_MODE=REAL
ACTION_MODE=EXECUTE

# ===========================================
# Secrets Inventory (ALL in Vault)
# ===========================================
# agenticverz/app-prod:     AOS_API_KEY, MACHINE_SECRET_TOKEN, OIDC_CLIENT_SECRET
# agenticverz/database:     POSTGRES_USER, POSTGRES_PASSWORD, DATABASE_URL
# agenticverz/external-apis: ANTHROPIC_API_KEY, OPENAI_API_KEY, GITHUB_TOKEN
# agenticverz/keycloak-admin: KEYCLOAK_ADMIN, KEYCLOAK_ADMIN_PASSWORD
# secret/data/user/neon:    DATABASE_URL
# secret/data/user/upstash: REDIS_URL
# secret/data/user/r2:      R2_ENDPOINT, R2_BUCKET, R2_ACCESS_KEY_ID, R2_SECRET_ACCESS_KEY
#
# Load: source scripts/ops/vault/vault_env.sh app-prod
