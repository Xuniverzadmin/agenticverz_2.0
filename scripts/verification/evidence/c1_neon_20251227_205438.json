[
  {
    "name": "check-constraint",
    "passed": true,
    "expected": "chk_never_authoritative constraint enforces authoritative=FALSE",
    "actual": "Constraint exists: (authoritative = false)",
    "query": "\n        SELECT constraint_name, check_clause\n        FROM information_schema.check_constraints\n        WHERE constraint_name = 'chk_never_authoritative'\n        ",
    "duration_ms": 1978.3360958099365,
    "error": null
  },
  {
    "name": "no-fk-constraints",
    "passed": true,
    "expected": "0 foreign key constraints on telemetry_event",
    "actual": "0 foreign key constraints (isolation maintained)",
    "query": "\n        SELECT COUNT(*)\n        FROM information_schema.table_constraints\n        WHERE table_name = 'telemetry_event'\n          AND constraint_type = 'FOREIGN KEY'\n        ",
    "duration_ms": 2655.5936336517334,
    "error": null
  },
  {
    "name": "non-authoritative-constraint",
    "passed": true,
    "expected": "0 rows with authoritative=TRUE",
    "actual": "0 authoritative telemetry rows (constraint holds)",
    "query": "\n        SELECT COUNT(*) FROM telemetry_event WHERE authoritative = TRUE\n        ",
    "duration_ms": 2623.3503818511963,
    "error": null
  },
  {
    "name": "replay-isolation",
    "passed": true,
    "expected": "0 telemetry rows from replay engine",
    "actual": "0 replay-sourced telemetry rows (isolation holds)",
    "query": "\n        SELECT COUNT(*) FROM telemetry_event\n        WHERE signal_payload->>'is_replay' = 'true'\n           OR signal_payload->>'source' = 'replay'\n           OR source_module = 'replay'\n        ",
    "duration_ms": 1945.6560611724854,
    "error": null
  },
  {
    "name": "ttl-enforcement",
    "passed": true,
    "expected": "0 or minimal expired telemetry rows",
    "actual": "0 expired telemetry rows (TTL enforced)",
    "query": "\n        SELECT\n            COUNT(*) AS expired_count,\n            MIN(expires_at_utc) AS oldest_expired\n        FROM telemetry_event\n        WHERE expires_at_utc < NOW()\n        ",
    "duration_ms": 1920.154094696045,
    "error": null
  },
  {
    "name": "truth-independence",
    "passed": true,
    "expected": "Incidents exist independently of telemetry",
    "actual": "Incidents independent: 1 total, 0 have telemetry",
    "query": "\n        SELECT\n            (SELECT COUNT(*) FROM costsim_cb_incidents) AS total_incidents,\n            (SELECT COUNT(DISTINCT incident_id) FROM telemetry_event WHERE incident_id IS NOT NULL) AS incid...",
    "duration_ms": 1937.9067420959473,
    "error": null
  },
  {
    "name": "write-order",
    "passed": true,
    "expected": "0 telemetry rows written before their corresponding trace",
    "actual": "0 telemetry rows precede their trace (order correct)",
    "query": "\n        SELECT COUNT(*) FROM telemetry_event te\n        JOIN runs r ON te.trace_id = r.id::uuid\n        WHERE te.created_at_utc < r.created_at\n        ",
    "duration_ms": 1956.355094909668,
    "error": null
  },
  {
    "name": "telemetry-write-failure-safe",
    "passed": true,
    "expected": "0 incidents caused by telemetry failures",
    "actual": "Safe: 0 runs, all have telemetry, 0 telemetry incidents",
    "query": "\n        WITH execution_stats AS (\n            SELECT\n                (SELECT COUNT(*) FROM runs) AS total_runs,\n                (SELECT COUNT(DISTINCT trace_id) FROM telemetry_event WHERE trace_id IS...",
    "duration_ms": 1931.1354160308838,
    "error": null
  },
  {
    "name": "replay-does-not-read-telemetry",
    "passed": true,
    "expected": "0 telemetry rows consumed or hinted for replay",
    "actual": "0 replay consumption/hint indicators (read isolation holds)",
    "query": "\n        SELECT\n            COUNT(*) FILTER (\n                WHERE signal_payload->>'consumed_by' = 'replay'\n                   OR signal_payload->>'read_by' = 'replay'\n                   OR signal_t...",
    "duration_ms": 1910.881757736206,
    "error": null
  },
  {
    "name": "truth-tables-independent",
    "passed": true,
    "expected": "Truth tables have no dependencies on telemetry_event",
    "actual": "Truth tables accessible (runs=0, incidents=1), 0 telemetry dependencies",
    "query": "\n        SELECT\n            (SELECT COUNT(*) FROM runs LIMIT 1) AS runs_accessible,\n            (SELECT COUNT(*) FROM costsim_cb_incidents LIMIT 1) AS incidents_accessible,\n            (SELECT COUNT(*...",
    "duration_ms": 1913.2542610168457,
    "error": null
  }
]
