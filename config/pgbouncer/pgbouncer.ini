[databases]
# Target PostgreSQL database (via host network, db is on 5433)
nova_aos = host=127.0.0.1 port=5433 dbname=nova_aos

[pgbouncer]
# Listen on all interfaces (within container)
listen_addr = 0.0.0.0
listen_port = 6432

# Authentication
auth_type = md5
auth_file = /etc/pgbouncer/userlist.txt

# Pool Mode: transaction = release connection after each transaction
# Recommended for high-concurrency API workloads
pool_mode = transaction

# Pool Sizing
# default_pool_size: connections per database/user pair
# max_client_conn: max simultaneous client connections
# reserve_pool_size: extra connections for superuser
default_pool_size = 20
max_client_conn = 200
reserve_pool_size = 5
reserve_pool_timeout = 3

# Connection limits
max_db_connections = 50
max_user_connections = 50

# Timeouts
server_connect_timeout = 15
server_idle_timeout = 600
server_lifetime = 3600
client_idle_timeout = 0
client_login_timeout = 60
query_timeout = 300
query_wait_timeout = 120

# DNS
dns_max_ttl = 15
dns_zone_check_period = 0

# Logging
log_connections = 0
log_disconnections = 0
log_pooler_errors = 1
stats_period = 60
verbose = 0

# Admin
admin_users = nova
stats_users = nova
