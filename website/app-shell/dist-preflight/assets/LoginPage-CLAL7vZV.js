import{u as G,a as H,b as T,c as W,r as o,t as l,d as x,e as g,j as e}from"./index-BnpC133k.js";const m="",O=()=>e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),R=()=>e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 21 21",children:[e.jsx("rect",{x:"1",y:"1",width:"9",height:"9",fill:"#F25022"}),e.jsx("rect",{x:"11",y:"1",width:"9",height:"9",fill:"#7FBA00"}),e.jsx("rect",{x:"1",y:"11",width:"9",height:"9",fill:"#00A4EF"}),e.jsx("rect",{x:"11",y:"11",width:"9",height:"9",fill:"#FFB900"})]}),U=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})});function Z(){var S,z;const u=G(),A=H(),[f]=T(),{setTokens:b,setUser:v,setTenant:j,isAuthenticated:w,onboardingComplete:y}=W(),[E,N]=o.useState(!1),[n,B]=o.useState(""),[h,k]=o.useState(""),[L,C]=o.useState(!1),[i,r]=o.useState(!1),[c,_]=o.useState(0);(z=(S=A.state)==null?void 0:S.from)!=null&&z.pathname,o.useEffect(()=>{const t=f.get("token"),a=f.get("refresh_token"),s=f.get("error");if(s){l(decodeURIComponent(s));return}t&&a&&(b(t,a),M(t))},[f]),o.useEffect(()=>{w&&(y?u("/guard",{replace:!0}):u("/onboarding/connect",{replace:!0}))},[w,y,u]),o.useEffect(()=>{if(c>0){const t=setTimeout(()=>_(c-1),1e3);return()=>clearTimeout(t)}},[c]);const M=async t=>{try{const s=(await x.get(`${m}/api/v1/auth/me`,{headers:{Authorization:`Bearer ${t}`}})).data;v({id:s.id,email:s.email,name:s.name||s.email.split("@")[0],role:"admin",oauth_provider:s.oauth_provider,email_verified:s.email_verified}),s.default_tenant_id&&j(s.default_tenant_id),g("Welcome to Agenticverz!"),u("/onboarding/connect",{replace:!0})}catch(a){console.error("Failed to fetch user info:",a),l("Failed to load user profile")}},P=async()=>{r(!0);try{const t=await x.post(`${m}/api/v1/auth/login/google`);t.data.authorization_url&&(window.location.href=t.data.authorization_url)}catch(t){console.error("Google login error:",t),l("Failed to initiate Google login"),r(!1)}},I=async()=>{r(!0);try{const t=await x.post(`${m}/api/v1/auth/login/azure`);t.data.authorization_url&&(window.location.href=t.data.authorization_url)}catch(t){console.error("Azure login error:",t),l("Failed to initiate Microsoft login"),r(!1)}},F=async()=>{var t,a;if(!n.trim()||!n.includes("@")){l("Please enter a valid email address");return}r(!0);try{await x.post(`${m}/api/v1/auth/signup/email`,{email:n}),C(!0),_(60),g("Verification code sent to your email")}catch(s){l(((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.detail)||"Failed to send verification code")}finally{r(!1)}},V=async()=>{var t,a;if(!h.trim()||h.length!==6){l("Please enter the 6-digit code");return}r(!0);try{const s=await x.post(`${m}/api/v1/auth/verify/email`,{email:n,otp:h}),{access_token:p,refresh_token:$,user:d}=s.data;b(p,$),v({id:d.id,email:d.email,name:d.name||d.email.split("@")[0],role:"admin",oauth_provider:"email",email_verified:!0}),d.default_tenant_id&&j(d.default_tenant_id),g("Email verified! Welcome to Agenticverz"),u("/onboarding/connect",{replace:!0})}catch(s){l(((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.detail)||"Invalid verification code")}finally{r(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/20",children:e.jsxs("svg",{className:"w-10 h-10 text-white",viewBox:"0 0 32 32",fill:"none",children:[e.jsx("path",{d:"M8 22L16 10L24 22H8Z",fill:"currentColor"}),e.jsx("circle",{cx:"16",cy:"18",r:"3",fill:"rgba(255,255,255,0.3)"})]})})}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Sign in to Agenticverz"}),e.jsx("p",{className:"text-slate-400 mt-2",children:"AI Agent Governance Platform"})]}),e.jsx("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl p-6 shadow-xl",children:E?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:()=>{N(!1),C(!1),k("")},className:"text-slate-400 hover:text-white text-sm flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),L?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("p",{className:"text-slate-300",children:"We sent a 6-digit code to"}),e.jsx("p",{className:"text-white font-medium",children:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Verification code"}),e.jsx("input",{type:"text",value:h,onChange:t=>k(t.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",autoFocus:!0,maxLength:6,className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white text-center text-2xl tracking-widest font-mono placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("button",{onClick:V,disabled:i||h.length!==6,className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Verifying...":"Verify & Continue"}),e.jsx("button",{onClick:F,disabled:i||c>0,className:"w-full text-sm text-slate-400 hover:text-white transition-colors disabled:opacity-50",children:c>0?`Resend code in ${c}s`:"Resend code"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Email address"}),e.jsx("input",{type:"email",value:n,onChange:t=>B(t.target.value),placeholder:"you@company.com",autoFocus:!0,className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("button",{onClick:F,disabled:i||!n.trim(),className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Sending...":"Send verification code"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:P,disabled:i,className:"w-full flex items-center justify-center gap-3 px-4 py-3 bg-white hover:bg-gray-50 text-gray-700 font-medium rounded-xl transition-colors disabled:opacity-50",children:[e.jsx(O,{}),"Continue with Google"]}),e.jsxs("button",{onClick:I,disabled:i,className:"w-full flex items-center justify-center gap-3 px-4 py-3 bg-slate-800 hover:bg-slate-700 text-white font-medium rounded-xl transition-colors border border-slate-700 disabled:opacity-50",children:[e.jsx(R,{}),"Continue with Microsoft"]}),e.jsxs("div",{className:"relative py-4",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-slate-700"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-3 bg-slate-900 text-slate-500",children:"or"})})]}),e.jsxs("button",{onClick:()=>N(!0),disabled:i,className:"w-full flex items-center justify-center gap-3 px-4 py-3 bg-slate-800 hover:bg-slate-700 text-white font-medium rounded-xl transition-colors border border-slate-700 disabled:opacity-50",children:[e.jsx(U,{}),"Continue with Email"]})]})}),e.jsxs("p",{className:"text-center text-slate-500 text-sm mt-6",children:["By continuing, you agree to our"," ",e.jsx("a",{href:"#",className:"text-blue-400 hover:text-blue-300",children:"Terms of Service"})," ","and"," ",e.jsx("a",{href:"#",className:"text-blue-400 hover:text-blue-300",children:"Privacy Policy"})]})]})})}export{Z as default};
