import{b as R,r as i,j as e,I as k,H as w,A as G,L as M}from"./index-Cumb797X.js";import{A as U}from"./activity-QuL4-Ix7.js";import{C as B,T as H,G as q}from"./table-CyXBnsVJ.js";import{F as J}from"./file-text-NODVhE7d.js";import{L as K}from"./layers-ZFUpR_Eg.js";import{L as O,l as Q,b as V,a as W,c as A}from"./ui_projection_loader--e58pCmo.js";import{L as b}from"./list-COFa37dt.js";import{L as X}from"./loader-2-YK5s4lxi.js";import{S as Y}from"./shield-D5PAFrWQ.js";import{u as Z,I as p}from"./RendererContext-BJbYF88q.js";const $={Overview:O,Activity:U,Incidents:k,Policies:Y,Logs:J},I={FLAT:b,TREE:K,GRID:q,TABLE:H,CARD:B,LIST:b};function N(s){const t=new Set;for(const n of s)n.topic&&t.add(n.topic);return Array.from(t).sort()}function ee(s,t){return s.filter(n=>n.topic===t&&n.enabled)}function D(s){return s.order==="O1"}function E(s){return s.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}function se({panel:s}){var r;const t=I[s.render_mode]||b,n=(r=s._normalization)==null?void 0:r.auto_description;return e.jsx(M,{to:s.route,className:"block bg-gray-800 border border-gray-700 rounded-lg p-4 hover:border-primary-600 hover:bg-gray-750 transition-all group",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-700/50 rounded-lg group-hover:bg-primary-900/30 transition-colors",children:e.jsx(t,{size:20,className:"text-gray-400 group-hover:text-primary-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-100 group-hover:text-white mb-1",children:s.panel_name}),s.short_description&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",children:s.short_description}),n&&e.jsx(p,{children:e.jsx("span",{className:"text-xs px-1 py-0.5 bg-amber-900/30 text-amber-500 rounded font-mono flex-shrink-0",children:"AUTO"})})]})]})]})})}function re({panel:s}){var r;const t=I[s.render_mode]||b,n=(r=s._normalization)==null?void 0:r.auto_description;return e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary-900/30 rounded-lg",children:e.jsx(t,{size:20,className:"text-primary-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-100",children:s.panel_name}),s.short_description&&e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx("p",{className:"text-sm text-gray-400",children:s.short_description}),n&&e.jsx(p,{children:e.jsx("span",{className:"text-xs px-1 py-0.5 bg-amber-900/30 text-amber-500 rounded font-mono",children:"AUTO"})})]})]})]}),e.jsx(p,{children:e.jsx("span",{className:"text-xs px-2 py-1 bg-emerald-900/30 text-emerald-400 rounded font-mono",children:"O1"})})]}),e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"bg-gray-900/50 border border-dashed border-gray-600 rounded-lg p-8 text-center",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Content surface â€” awaiting backend binding"}),e.jsx(p,{children:e.jsxs("p",{className:"text-gray-600 text-xs mt-2 font-mono",children:["render_mode: ",s.render_mode," | controls: ",s.control_count]})})]})})]})}function te({topics:s,activeTopic:t,onSelectTopic:n}){return s.length===0?null:e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("div",{className:"flex gap-1 overflow-x-auto",children:s.map(r=>e.jsx("button",{onClick:()=>n(r),className:G("px-4 py-2.5 text-sm font-medium whitespace-nowrap transition-colors border-b-2 -mb-px",t===r?"text-primary-400 border-primary-400 bg-primary-900/10":"text-gray-400 border-transparent hover:text-gray-200 hover:border-gray-600"),children:E(r)},r))})})}function ne({panels:s}){if(s.length===0)return e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No panels in this topic."})});const t=s.filter(D),n=s.filter(r=>!D(r));return e.jsxs("div",{className:"space-y-6",children:[t.length>0&&e.jsx("div",{className:"space-y-4",children:t.map(r=>e.jsx(re,{panel:r},r.panel_id))}),n.length>0&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(r=>e.jsx(se,{panel:r},r.panel_id))})]})}function ae(){return e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(X,{className:"animate-spin text-gray-500 mr-3",size:24}),e.jsx("span",{className:"text-gray-400",children:"Loading projection..."})]})}function ie({error:s,onRetry:t}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(w,{className:"text-red-500 mb-3",size:32}),e.jsx("h3",{className:"text-lg font-medium text-red-400 mb-2",children:"Failed to load"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:s}),e.jsx("button",{onClick:t,className:"px-4 py-2 bg-primary-600 text-white rounded hover:bg-primary-500",children:"Retry"})]})}function oe({domainName:s}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(w,{className:"text-amber-500 mb-3",size:32}),e.jsx("h3",{className:"text-lg font-medium text-amber-400 mb-2",children:"Domain Not Found"}),e.jsxs("p",{className:"text-sm text-gray-400",children:['The domain "',s,'" is not defined in the projection lock.']})]})}function u({domainName:s}){var T;const[t,n]=R();Z();const[r,v]=i.useState(!0),[_,P]=i.useState(null),[c,S]=i.useState(null),[g,h]=i.useState([]),o=t.get("subdomain"),[a,f]=i.useState(null),L=async()=>{v(!0),P(null);try{await Q();const d=V(s);if(d){S(d);const y=W(s);if(o&&y.includes(o)){const m=A(s,o);h(m.filter(j=>j.enabled));const x=N(m);x.length>0&&!a&&f(x[0])}else if(y.length>0){const m=y[0];n({subdomain:m});const x=A(s,m);h(x.filter(F=>F.enabled));const j=N(x);j.length>0&&f(j[0])}else h([])}else S(null),h([])}catch(d){P(d instanceof Error?d.message:"Failed to load projection")}finally{v(!1)}};i.useEffect(()=>{L()},[s,o]);const l=i.useMemo(()=>N(g),[g]);i.useEffect(()=>{l.length>0&&(!a||!l.includes(a))&&f(l[0])},[l,a]);const C=i.useMemo(()=>a?ee(g,a):[],[g,a]),z=$[s]||O;return r?e.jsx(ae,{}):_?e.jsx(ie,{error:_,onRetry:L}):c?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary-900/30 rounded-lg",children:e.jsx(z,{size:24,className:"text-primary-400"})}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-100",children:c.domain})]}),o&&e.jsx("div",{className:"text-lg font-medium text-gray-300",children:E(o)}),c.short_description&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm text-gray-400",children:c.short_description}),((T=c._normalization)==null?void 0:T.auto_description)&&e.jsx(p,{children:e.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-amber-900/30 text-amber-500 rounded font-mono",children:"AUTO"})})]}),e.jsx(te,{topics:l,activeTopic:a,onSelectTopic:f}),a?e.jsx("div",{className:"space-y-4",children:e.jsx(ne,{panels:C})}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Select a topic to view panels."})})]}):e.jsx(oe,{domainName:s})}function je(){return e.jsx(u,{domainName:"Overview"})}function be(){return e.jsx(u,{domainName:"Activity"})}function ye(){return e.jsx(u,{domainName:"Incidents"})}function Ne(){return e.jsx(u,{domainName:"Policies"})}function ve(){return e.jsx(u,{domainName:"Logs"})}export{be as ActivityPage,u as DomainPage,ye as IncidentsPage,ve as LogsPage,je as OverviewPage,Ne as PoliciesPage};
