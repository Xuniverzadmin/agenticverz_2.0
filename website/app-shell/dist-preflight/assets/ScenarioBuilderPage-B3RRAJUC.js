import{e as S,T as q,r as n,j as e,M as A,I as B,Q}from"./index-Cumb797X.js";import{u as K}from"./useQuery-CCaJ6Z3y.js";import{u as f}from"./useMutation-C_rcEF1p.js";import{C as U}from"./chevron-right-BdTgfrGY.js";import{C as V}from"./clock-Jc1DDHJZ.js";import{C as X}from"./copy-hE6ZnnME.js";import{D as Z}from"./dollar-sign-CfL9mPKX.js";import{L as o}from"./loader-2-YK5s4lxi.js";import{P as v}from"./play-YcwUJuE-.js";import{T as H}from"./trending-up-Bz36NpXj.js";import{X as O}from"./x-circle-B69a43uT.js";import{Z as W}from"./zap-DdmUi9RW.js";import{a as u}from"./client-BT2DjEOZ.js";import"./index-B9ygI19o.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=S("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=S("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=S("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);async function J(s=!0){return(await u.get("/api/v1/scenarios",{params:{include_templates:s}})).data}async function Y(s){return(await u.post("/api/v1/scenarios",s)).data}async function ee(s){return(await u.delete(`/api/v1/scenarios/${s}`)).data}async function se(s,t){return(await u.post(`/api/v1/scenarios/${s}/simulate`,null,{params:t!==void 0?{budget_override:t}:void 0})).data}async function te(s){return(await u.post("/api/v1/scenarios/simulate-adhoc",s)).data}function x(s){return`$${(s/100).toFixed(2)}`}function R(s){return s<1e3?`${s}ms`:s<6e4?`${(s/1e3).toFixed(1)}s`:`${(s/6e4).toFixed(1)}m`}function ae(s){switch(s){case"feasible":return"text-green-400";case"budget_exceeded":return"text-red-400";default:return"text-yellow-400"}}function le(s){switch(s){case"high":return"text-red-500 bg-red-900/30";case"medium":return"text-yellow-500 bg-yellow-900/30";case"low":return"text-blue-500 bg-blue-900/30";default:return"text-gray-500 bg-gray-900/30"}}function ie(s){return s>=90?"text-red-400":s>=70?"text-yellow-400":"text-green-400"}const ne=[{id:"api_call",name:"API Call",description:"External API invocation"},{id:"data_fetch",name:"Data Fetch",description:"Retrieve data from storage"},{id:"data_store",name:"Data Store",description:"Persist data to storage"},{id:"llm_call",name:"LLM Call",description:"Language model inference"},{id:"batch_process",name:"Batch Process",description:"Process items in bulk"}];function re({step:s,index:t,onChange:l,onRemove:d}){return e.jsxs("div",{className:"bg-gray-900/50 border border-navy-border rounded-lg p-3 mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm text-gray-400",children:["Step ",t+1]}),e.jsx("button",{onClick:()=>d(t),className:"p-1 hover:bg-red-900/30 rounded text-red-400",title:"Remove step",children:e.jsx(G,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Skill"}),e.jsx("select",{value:s.skill,onChange:i=>l(t,{...s,skill:i.target.value}),className:"w-full bg-gray-800 border border-navy-border rounded px-2 py-1 text-sm text-white",children:ne.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Iterations"}),e.jsx("input",{type:"number",value:s.iterations||1,onChange:i=>l(t,{...s,iterations:Math.max(1,parseInt(i.target.value)||1)}),min:1,max:100,className:"w-full bg-gray-800 border border-navy-border rounded px-2 py-1 text-sm text-white"})]})]})]})}function ce({result:s}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.feasible?e.jsx(Q,{className:"w-6 h-6 text-green-500"}):e.jsx(O,{className:"w-6 h-6 text-red-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-medium ${ae(s.status)}`,children:s.feasible?"Feasible":"Budget Exceeded"}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Confidence: ",(s.confidence_score*100).toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:x(s.estimated_cost_cents)}),e.jsxs("div",{className:"text-sm text-gray-400",children:["of ",x(s.budget_cents)," budget"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-400",children:"Budget Utilization"}),e.jsxs("span",{className:ie(s.budget_utilization_pct),children:[s.budget_utilization_pct.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${s.budget_utilization_pct>=90?"bg-red-500":s.budget_utilization_pct>=70?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(100,s.budget_utilization_pct)}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-900/30 rounded-lg p-3 text-center",children:[e.jsx(Z,{className:"w-5 h-5 mx-auto text-green-400 mb-1"}),e.jsx("div",{className:"text-lg font-medium text-white",children:x(s.budget_remaining_cents)}),e.jsx("div",{className:"text-xs text-gray-400",children:"Remaining"})]}),e.jsxs("div",{className:"bg-gray-900/30 rounded-lg p-3 text-center",children:[e.jsx(V,{className:"w-5 h-5 mx-auto text-blue-400 mb-1"}),e.jsx("div",{className:"text-lg font-medium text-white",children:R(s.estimated_duration_ms)}),e.jsx("div",{className:"text-xs text-gray-400",children:"Duration"})]}),e.jsxs("div",{className:"bg-gray-900/30 rounded-lg p-3 text-center",children:[e.jsx(W,{className:"w-5 h-5 mx-auto text-yellow-400 mb-1"}),e.jsx("div",{className:"text-lg font-medium text-white",children:s.step_estimates.length}),e.jsx("div",{className:"text-xs text-gray-400",children:"Steps"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"Step Breakdown"}),e.jsx("div",{className:"space-y-2",children:s.step_estimates.map(t=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-900/30 rounded px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs bg-gray-700 rounded px-2 py-0.5",children:["#",t.step_index+1]}),e.jsx("span",{className:"text-white text-sm",children:t.skill_id}),e.jsxs("span",{className:"text-gray-500 text-xs",children:["x",t.iterations]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsx("span",{className:"text-gray-400",children:R(t.latency_ms)}),e.jsx("span",{className:"text-green-400 font-medium",children:x(t.cost_cents)})]})]},t.step_index))})]}),s.warnings.length>0&&e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-800 rounded-lg p-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-yellow-400 mb-2 flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),"Warnings"]}),e.jsx("ul",{className:"text-sm text-yellow-300 space-y-1",children:s.warnings.map((t,l)=>e.jsx("li",{children:t},l))})]}),s.risks.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400",children:"Identified Risks"}),s.risks.map((t,l)=>e.jsx("div",{className:`rounded-lg px-3 py-2 ${le(t.severity)}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium uppercase",children:t.severity}),e.jsx("span",{className:"text-sm",children:t.message})]})},l))]}),e.jsxs("div",{className:"bg-blue-900/20 border border-blue-800 rounded-lg p-3 flex items-start gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-300",children:[e.jsx("strong",{children:"Advisory Only:"})," ",s.note]})]})]})}function de({scenario:s,onSelect:t,onDelete:l}){return e.jsxs("div",{className:"bg-gray-900/50 border border-navy-border hover:border-blue-600 rounded-lg p-4 cursor-pointer transition-all",onClick:()=>t(s),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-white font-medium",children:s.name}),s.is_template&&e.jsx("span",{className:"text-xs bg-blue-900/30 text-blue-400 px-2 py-0.5 rounded",children:"Template"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:x(s.budget_cents)}),e.jsx(U,{className:"w-4 h-4 text-gray-500"})]})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[s.plan.length," step",s.plan.length!==1?"s":""]}),!s.is_template&&e.jsx("button",{onClick:d=>{d.stopPropagation(),l(s.id)},className:"text-xs text-red-400 hover:text-red-300",children:"Delete"})]})]})}function Se(){const s=q(),[t,l]=n.useState(null),[d,i]=n.useState([{skill:"api_call",params:{},iterations:1}]),[g,C]=n.useState(1e3),[k,_]=n.useState(""),[b,m]=n.useState(null),[h,j]=n.useState(!1),{data:y,isLoading:F}=K({queryKey:["scenarios"],queryFn:()=>J(!0)}),r=f({mutationFn:async()=>t?se(t.id):te({plan:d,budget_cents:g}),onSuccess:a=>{m(a)}}),N=f({mutationFn:async()=>Y({name:k||`Custom Scenario ${Date.now()}`,plan:d,budget_cents:g}),onSuccess:()=>{s.invalidateQueries({queryKey:["scenarios"]}),_("")}}),I=f({mutationFn:ee,onSuccess:()=>{s.invalidateQueries({queryKey:["scenarios"]}),l(null)}}),L=n.useCallback((a,c)=>{i(M=>{const p=[...M];return p[a]=c,p}),m(null)},[]),$=n.useCallback(a=>{i(c=>c.filter((M,p)=>p!==a)),m(null)},[]),D=n.useCallback(()=>{i(a=>[...a,{skill:"api_call",params:{},iterations:1}]),m(null)},[]),z=n.useCallback(a=>{l(a),j(!1),m(null)},[]),E=n.useCallback(()=>{l(null),j(!0),m(null)},[]),T=n.useCallback(()=>{t&&(i([...t.plan]),C(t.budget_cents),l(null),j(!0))},[t]);return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold text-white mb-2 flex items-center gap-3",children:[e.jsx(P,{className:"w-7 h-7 text-blue-400"}),"Scenario Builder"]}),e.jsx("p",{className:"text-gray-400",children:"Build and simulate cost scenarios. All simulations are advisory only - no real budget changes occur."})]}),e.jsxs("div",{className:"bg-blue-900/20 border border-blue-800 rounded-lg p-3 mb-6 flex items-center gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-blue-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-300 font-medium",children:"Advisory Mode"}),e.jsx("span",{className:"text-blue-400 ml-2 text-sm",children:"Simulations are pure computations. No budgets are modified, no operations are triggered."})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"bg-gray-900/30 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-white font-medium",children:"Scenarios"}),e.jsxs("button",{onClick:E,className:"flex items-center gap-1 text-sm text-blue-400 hover:text-blue-300",children:[e.jsx(w,{className:"w-4 h-4"}),"Custom"]})]}),F?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(o,{className:"w-6 h-6 animate-spin text-blue-500"})}):e.jsx("div",{className:"space-y-3",children:y==null?void 0:y.map(a=>e.jsx(de,{scenario:a,onSelect:z,onDelete:c=>I.mutate(c)},a.id))})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"bg-gray-900/30 rounded-lg p-4",children:[e.jsx("h2",{className:"text-white font-medium mb-4",children:h?"Custom Scenario":t?t.name:"Select a Scenario"}),t&&!h&&e.jsxs("div",{children:[t.description&&e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:t.description}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Budget"}),e.jsx("span",{className:"text-white font-medium",children:x(t.budget_cents)})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-2",children:"Plan Steps"}),t.plan.map((a,c)=>e.jsx("div",{className:"bg-gray-800 rounded px-3 py-2 mb-2 flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-white",children:a.skill}),e.jsxs("span",{className:"text-gray-500 text-sm ml-2",children:["x",a.iterations||1]})]})},c))]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>r.mutate(),disabled:r.isPending,className:"flex-1 flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-500 disabled:opacity-50 text-white px-4 py-2 rounded",children:[r.isPending?e.jsx(o,{className:"w-4 h-4 animate-spin"}):e.jsx(v,{className:"w-4 h-4"}),"Simulate"]}),e.jsx("button",{onClick:T,className:"flex items-center gap-2 bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded",title:"Copy to custom",children:e.jsx(X,{className:"w-4 h-4"})})]})]}),h&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Scenario Name"}),e.jsx("input",{type:"text",value:k,onChange:a=>_(a.target.value),placeholder:"Optional name for saving",className:"w-full bg-gray-800 border border-navy-border rounded px-3 py-2 text-sm text-white"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Budget (cents)"}),e.jsx("input",{type:"number",value:g,onChange:a=>{C(Math.max(0,parseInt(a.target.value)||0)),m(null)},min:0,max:1e6,className:"w-full bg-gray-800 border border-navy-border rounded px-3 py-2 text-sm text-white"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Plan Steps"}),e.jsxs("button",{onClick:D,className:"text-xs text-blue-400 hover:text-blue-300 flex items-center gap-1",children:[e.jsx(w,{className:"w-3 h-3"}),"Add Step"]})]}),d.map((a,c)=>e.jsx(re,{step:a,index:c,onChange:L,onRemove:$},c))]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>r.mutate(),disabled:r.isPending||d.length===0,className:"flex-1 flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-500 disabled:opacity-50 text-white px-4 py-2 rounded",children:[r.isPending?e.jsx(o,{className:"w-4 h-4 animate-spin"}):e.jsx(v,{className:"w-4 h-4"}),"Simulate"]}),e.jsx("button",{onClick:()=>N.mutate(),disabled:N.isPending||d.length===0,className:"flex items-center gap-2 bg-gray-700 hover:bg-gray-600 disabled:opacity-50 text-white px-4 py-2 rounded",title:"Save scenario",children:N.isPending?e.jsx(o,{className:"w-4 h-4 animate-spin"}):e.jsx(w,{className:"w-4 h-4"})})]})]}),!t&&!h&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(P,{className:"w-12 h-12 mx-auto text-gray-600 mb-3"}),e.jsx("p",{className:"text-gray-400",children:"Select a scenario from the list or create a custom one"})]})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"bg-gray-900/30 rounded-lg p-4",children:[e.jsxs("h2",{className:"text-white font-medium mb-4 flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5 text-green-400"}),"Simulation Results"]}),r.isPending&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(o,{className:"w-8 h-8 animate-spin text-blue-500"})}),r.isError&&e.jsxs("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4 text-center",children:[e.jsx(B,{className:"w-8 h-8 mx-auto text-red-500"}),e.jsx("p",{className:"text-red-400 mt-2",children:"Simulation failed"})]}),b&&!r.isPending&&e.jsx(ce,{result:b}),!b&&!r.isPending&&!r.isError&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{className:"w-12 h-12 mx-auto text-gray-600 mb-3"}),e.jsx("p",{className:"text-gray-400",children:"Run a simulation to see cost projections"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Results are advisory only"})]})]})})]})]})}export{Se as default};
