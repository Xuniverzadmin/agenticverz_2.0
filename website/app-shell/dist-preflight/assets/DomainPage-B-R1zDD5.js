import{S as b,j as e,U as X,c as B,b as Q,r as p,M as V,K as O,E as W,V as J,J as Y}from"./index-KppIquYQ.js";import{A as Z}from"./activity-DcrdMZEZ.js";import{C as ee,T as te,G as se,S as re}from"./SimulatedControl-UePwbO-C.js";import{F as ne}from"./file-text-kHBdGibj.js";import{L as ie}from"./layers-WKzZkqYb.js";import{L as D,l as ae,b as le,a as oe,c as F}from"./ui_projection_loader-B9H141-c.js";import{L as w}from"./list-vBwHXCn_.js";import{L as ce}from"./loader-2-Bq2xiA3F.js";import{S as de}from"./shield-DOFc1kEW.js";import{u as E,I as g}from"./RendererContext-CAEOzvyZ.js";import{u as x}from"./useQuery-DRhwJCEf.js";import{u as A}from"./useMutation-Ckq5ZrwF.js";import{f as N}from"./activity-BhrSjbzC.js";import"./refresh-cw-C5XbiSIu.js";import"./Modal-REvkbvop.js";async function P(t={}){const s=new URLSearchParams;t.page!==void 0&&s.set("page",t.page.toString()),t.per_page!==void 0&&s.set("per_page",t.per_page.toString()),t.status!==void 0&&s.set("status",t.status),t.severity!==void 0&&s.set("severity",t.severity),t.category!==void 0&&s.set("category",t.category),t.include_synthetic!==void 0&&s.set("include_synthetic",t.include_synthetic.toString());const r=`/api/v1/incidents${s.toString()?"?"+s.toString():""}`;return(await b.get(r)).data}async function q(t=!0){const s=`/api/v1/incidents/metrics?include_synthetic=${t}`;return(await b.get(s)).data}async function K(t={}){const s=new URLSearchParams;t.tenant_id!==void 0&&s.set("tenant_id",t.tenant_id),t.status!==void 0&&s.set("status",t.status),t.proposal_type!==void 0&&s.set("proposal_type",t.proposal_type),t.limit!==void 0&&s.set("limit",t.limit.toString()),t.offset!==void 0&&s.set("offset",t.offset.toString());const r=`/api/v1/policy-proposals${s.toString()?"?"+s.toString():""}`;return(await b.get(r)).data}async function xe(t,s){return(await b.post(`/api/v1/policy-proposals/${t}/approve`,s)).data}async function me(t,s){return(await b.post(`/api/v1/policy-proposals/${t}/reject`,s)).data}function ue({panel:t}){var a,o,l;const{data:s,isLoading:r,error:i}=x({queryKey:["activity","runs","running"],queryFn:()=>N({status:"running",include_synthetic:!0}),refetchInterval:3e4,staleTime:1e4});if(r)return e.jsx("div",{className:"text-slate-400 text-sm",children:"Loading..."});if(i)return e.jsx("div",{className:"text-red-400 text-sm",children:"Failed to load active runs"});const n=((a=s==null?void 0:s.runs)==null?void 0:a.length)??0;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-4xl font-bold text-blue-400",children:n}),e.jsxs("div",{className:"text-slate-400 text-sm",children:[n===1?"run":"runs"," currently active"]})]}),n>0&&(s==null?void 0:s.runs)&&e.jsxs("div",{className:"text-xs text-slate-500",children:["Latest: ",(l=(o=s.runs[0])==null?void 0:o.goal)==null?void 0:l.slice(0,50),"..."]})]})}function pe({panel:t}){const{data:s,isLoading:r,error:i}=x({queryKey:["activity","runs","completed"],queryFn:()=>N({status:"completed",include_synthetic:!0}),refetchInterval:3e4,staleTime:1e4});if(r)return e.jsx("div",{className:"text-slate-400 text-sm",children:"Loading..."});if(i)return e.jsx("div",{className:"text-red-400 text-sm",children:"Failed to load completed runs"});const n=(s==null?void 0:s.total)??0;return e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-4xl font-bold text-green-400",children:n}),e.jsxs("div",{className:"text-slate-400 text-sm",children:[n===1?"run":"runs"," completed"]})]})})}function he({panel:t}){var o;const{data:s,isLoading:r,error:i}=x({queryKey:["activity","runs","all"],queryFn:()=>N({include_synthetic:!0}),refetchInterval:3e4,staleTime:1e4});if(r)return e.jsx("div",{className:"text-slate-400 text-sm",children:"Loading..."});if(i)return e.jsx("div",{className:"text-red-400 text-sm",children:"Failed to load run summary"});const n=(s==null?void 0:s.total)??0,a=((o=s==null?void 0:s.runs)==null?void 0:o.filter(l=>l.is_synthetic).length)??0;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-4xl font-bold text-white",children:n}),e.jsx("div",{className:"text-slate-400 text-sm",children:"total runs"})]}),a>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 rounded border text-xs font-medium bg-purple-500/10 text-purple-400 border-purple-400/40",children:"SDSR"}),e.jsxs("span",{className:"text-xs text-purple-300",children:[a," synthetic"]})]})]})}function ge({panel:t}){const{data:s,isLoading:r,error:i}=x({queryKey:["activity","runs","running","list"],queryFn:()=>N({status:"running",include_synthetic:!0,per_page:10}),refetchInterval:15e3,staleTime:5e3});if(r)return e.jsx("div",{className:"text-slate-400 text-sm",children:"Loading active runs..."});if(i)return e.jsx("div",{className:"text-red-400 text-sm",children:"Failed to load active runs"});const n=(s==null?void 0:s.runs)??[];return n.length===0?e.jsx("div",{className:"text-slate-500 text-sm",children:"No active runs"}):e.jsx("div",{className:"space-y-2",children:n.map(a=>e.jsx($,{run:a},a.run_id))})}function ye({panel:t}){const{data:s,isLoading:r,error:i}=x({queryKey:["activity","runs","all","list"],queryFn:()=>N({include_synthetic:!0,per_page:10}),refetchInterval:3e4,staleTime:1e4});if(r)return e.jsx("div",{className:"text-slate-400 text-sm",children:"Loading runs..."});if(i)return e.jsx("div",{className:"text-red-400 text-sm",children:"Failed to load runs"});const n=(s==null?void 0:s.runs)??[];return n.length===0?e.jsx("div",{className:"text-slate-500 text-sm",children:"No runs found"}):e.jsxs("div",{className:"space-y-2",children:[n.map(a=>e.jsx($,{run:a},a.run_id)),s&&s.total>n.length&&e.jsxs("div",{className:"text-xs text-slate-500 pt-2",children:["Showing ",n.length," of ",s.total," runs"]})]})}function $({run:t}){const r={completed:"text-green-400 border-green-400/40",failed:"text-red-400 border-red-400/40",running:"text-blue-400 border-blue-400/40",queued:"text-yellow-400 border-yellow-400/40",pending:"text-orange-400 border-orange-400/40"}[t.status]||"text-slate-400 border-slate-600";return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900/50 rounded-lg border border-gray-700/50",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-mono text-xs text-slate-400",children:[t.run_id.slice(0,8),"..."]}),e.jsx("span",{className:`px-2 py-0.5 rounded border text-xs font-medium bg-transparent ${r}`,children:t.status}),t.is_synthetic&&e.jsx("span",{className:"px-2 py-0.5 rounded border text-xs font-medium bg-purple-500/10 text-purple-400 border-purple-400/40",children:"SDSR"})]}),e.jsx("div",{className:"text-sm text-white mt-1 truncate",children:t.goal.length>60?`${t.goal.slice(0,60)}...`:t.goal})]}),e.jsx("div",{className:"text-xs text-slate-500 ml-4",children:new Date(t.created_at).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})}function fe({panel:t}){const{data:s,isLoading:r,error:i}=x({queryKey:["incidents","metrics"],queryFn:()=>q(!0),refetchInterval:3e4,staleTime:1e4});if(r)return e.jsx("div",{className:"text-slate-400 text-sm",children:"Loading..."});if(i)return e.jsx("div",{className:"text-red-400 text-sm",children:"Failed to load incident metrics"});const n=(s==null?void 0:s.total_open)??0,a=s==null?void 0:s.by_severity;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-4xl font-bold text-orange-400",children:n}),e.jsxs("div",{className:"text-slate-400 text-sm",children:["open ",n===1?"incident":"incidents"]})]}),a&&(a.critical>0||a.high>0)&&e.jsxs("div",{className:"flex items-center gap-2",children:[a.critical>0&&e.jsxs("span",{className:"px-2 py-1 rounded border text-xs font-medium bg-red-500/10 text-red-400 border-red-400/40",children:[a.critical," CRITICAL"]}),a.high>0&&e.jsxs("span",{className:"px-2 py-1 rounded border text-xs font-medium bg-orange-500/10 text-orange-400 border-orange-400/40",children:[a.high," HIGH"]})]})]})}function je({panel:t}){var o;const{data:s,isLoading:r,error:i}=x({queryKey:["incidents","all"],queryFn:()=>P({include_synthetic:!0}),refetchInterval:3e4,staleTime:1e4});if(r)return e.jsx("div",{className:"text-slate-400 text-sm",children:"Loading..."});if(i)return e.jsx("div",{className:"text-red-400 text-sm",children:"Failed to load incidents"});const n=(s==null?void 0:s.total)??0,a=((o=s==null?void 0:s.incidents)==null?void 0:o.filter(l=>l.is_synthetic).length)??0;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-4xl font-bold text-white",children:n}),e.jsx("div",{className:"text-slate-400 text-sm",children:"total incidents"})]}),a>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 rounded border text-xs font-medium bg-purple-500/10 text-purple-400 border-purple-400/40",children:"SDSR"}),e.jsxs("span",{className:"text-xs text-purple-300",children:[a," synthetic"]})]})]})}function ve({panel:t}){const{data:s,isLoading:r,error:i}=x({queryKey:["incidents","metrics"],queryFn:()=>q(!0),refetchInterval:3e4,staleTime:1e4});if(r)return e.jsx("div",{className:"text-slate-400 text-sm",children:"Loading..."});if(i)return e.jsx("div",{className:"text-red-400 text-sm",children:"Failed to load incident metrics"});const n=(s==null?void 0:s.total_resolved)??0;return e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-4xl font-bold text-green-400",children:n}),e.jsxs("div",{className:"text-slate-400 text-sm",children:["resolved ",n===1?"incident":"incidents"]})]})})}function be({panel:t}){const{data:s,isLoading:r,error:i}=x({queryKey:["incidents","open","list"],queryFn:()=>P({status:"OPEN",include_synthetic:!0,per_page:10}),refetchInterval:15e3,staleTime:5e3});if(r)return e.jsx("div",{className:"text-slate-400 text-sm",children:"Loading open incidents..."});if(i)return e.jsx("div",{className:"text-red-400 text-sm",children:"Failed to load open incidents"});const n=(s==null?void 0:s.incidents)??[];return n.length===0?e.jsx("div",{className:"text-slate-500 text-sm",children:"No open incidents"}):e.jsxs("div",{className:"space-y-2",children:[n.map(a=>e.jsx(M,{incident:a},a.id)),s&&s.total>n.length&&e.jsxs("div",{className:"text-xs text-slate-500 pt-2",children:["Showing ",n.length," of ",s.total," incidents"]})]})}function Ne({panel:t}){const{data:s,isLoading:r,error:i}=x({queryKey:["incidents","resolved","list"],queryFn:()=>P({status:"RESOLVED",include_synthetic:!0,per_page:10}),refetchInterval:3e4,staleTime:1e4});if(r)return e.jsx("div",{className:"text-slate-400 text-sm",children:"Loading resolved incidents..."});if(i)return e.jsx("div",{className:"text-red-400 text-sm",children:"Failed to load resolved incidents"});const n=(s==null?void 0:s.incidents)??[];return n.length===0?e.jsx("div",{className:"text-slate-500 text-sm",children:"No resolved incidents"}):e.jsxs("div",{className:"space-y-2",children:[n.map(a=>e.jsx(M,{incident:a},a.id)),s&&s.total>n.length&&e.jsxs("div",{className:"text-xs text-slate-500 pt-2",children:["Showing ",n.length," of ",s.total," incidents"]})]})}function M({incident:t}){const s={CRITICAL:"text-red-400 border-red-400/40 bg-red-500/10",HIGH:"text-orange-400 border-orange-400/40 bg-orange-500/10",MEDIUM:"text-yellow-400 border-yellow-400/40 bg-yellow-500/10",LOW:"text-blue-400 border-blue-400/40 bg-blue-500/10"},r={OPEN:"text-orange-400 border-orange-400/40",ACKNOWLEDGED:"text-blue-400 border-blue-400/40",INVESTIGATING:"text-purple-400 border-purple-400/40",RESOLVED:"text-green-400 border-green-400/40",CLOSED:"text-slate-400 border-slate-600"},i=s[t.severity]||"text-slate-400 border-slate-600",n=r[t.status]||"text-slate-400 border-slate-600";return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900/50 rounded-lg border border-gray-700/50",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"font-mono text-xs text-slate-400",children:[t.id.slice(0,12),"..."]}),e.jsx("span",{className:`px-2 py-0.5 rounded border text-xs font-medium ${i}`,children:t.severity}),e.jsx("span",{className:`px-2 py-0.5 rounded border text-xs font-medium bg-transparent ${n}`,children:t.status}),t.is_synthetic&&e.jsx("span",{className:"px-2 py-0.5 rounded border text-xs font-medium bg-purple-500/10 text-purple-400 border-purple-400/40",children:"SDSR"})]}),e.jsx("div",{className:"text-sm text-white mt-1 truncate",children:t.title}),t.error_code&&e.jsx("div",{className:"text-xs text-slate-500 mt-1 font-mono",children:t.error_code})]}),e.jsx("div",{className:"text-xs text-slate-500 ml-4",children:new Date(t.created_at).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})}function _e({panel:t}){const{data:s,isLoading:r,error:i}=x({queryKey:["proposals","all"],queryFn:()=>K({limit:100}),refetchInterval:3e4,staleTime:1e4});if(r)return e.jsx("div",{className:"text-slate-400 text-sm",children:"Loading..."});if(i)return e.jsx("div",{className:"text-red-400 text-sm",children:"Failed to load proposals"});const n=(s==null?void 0:s.by_status)??{},a=n.draft??0,o=n.approved??0,l=n.rejected??0;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-4xl font-bold text-yellow-400",children:a}),e.jsxs("div",{className:"text-slate-400 text-sm",children:["pending ",a===1?"proposal":"proposals"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[o>0&&e.jsxs("span",{className:"px-2 py-1 rounded border text-xs font-medium bg-green-500/10 text-green-400 border-green-400/40",children:[o," approved"]}),l>0&&e.jsxs("span",{className:"px-2 py-1 rounded border text-xs font-medium bg-red-500/10 text-red-400 border-red-400/40",children:[l," rejected"]})]})]})}function Se({panel:t}){const s=X(),r=B(c=>c.user),{data:i,isLoading:n,error:a}=x({queryKey:["proposals","list"],queryFn:()=>K({limit:20}),refetchInterval:15e3,staleTime:5e3}),o=(r==null?void 0:r.email)||(r==null?void 0:r.id)||"unknown",l=A({mutationFn:c=>xe(c,{reviewed_by:o}),onSuccess:()=>{s.invalidateQueries({queryKey:["proposals"]})},onError:c=>{console.error("Failed to approve proposal:",c)}}),d=A({mutationFn:c=>me(c,{reviewed_by:o}),onSuccess:()=>{s.invalidateQueries({queryKey:["proposals"]})},onError:c=>{console.error("Failed to reject proposal:",c)}});if(n)return e.jsx("div",{className:"text-slate-400 text-sm",children:"Loading proposals..."});if(a)return e.jsx("div",{className:"text-red-400 text-sm",children:"Failed to load proposals"});const m=(i==null?void 0:i.items)??[];if(m.length===0)return e.jsx("div",{className:"text-slate-500 text-sm",children:"No proposals found"});const h=l.isPending||d.isPending;return e.jsxs("div",{className:"space-y-2",children:[m.map(c=>e.jsx(Le,{proposal:c,onApprove:()=>l.mutate(c.id),onReject:()=>d.mutate(c.id),isProcessing:h},c.id)),i&&i.total>m.length&&e.jsxs("div",{className:"text-xs text-slate-500 pt-2",children:["Showing ",m.length," of ",i.total," proposals"]})]})}function Le({proposal:t,onApprove:s,onReject:r,isProcessing:i}){const n={draft:"text-yellow-400 border-yellow-400/40 bg-yellow-500/10",approved:"text-green-400 border-green-400/40 bg-green-500/10",rejected:"text-red-400 border-red-400/40 bg-red-500/10"},a={timeout_policy:"text-orange-400 border-orange-400/40",crash_recovery_policy:"text-red-400 border-red-400/40",cost_cap_policy:"text-blue-400 border-blue-400/40",rate_limit_policy:"text-purple-400 border-purple-400/40",retry_policy:"text-cyan-400 border-cyan-400/40",failure_pattern_policy:"text-pink-400 border-pink-400/40"},o=n[t.status]||"text-slate-400 border-slate-600",l=a[t.proposal_type]||"text-slate-400 border-slate-600",d=t.status==="draft";return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900/50 rounded-lg border border-gray-700/50",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"font-mono text-xs text-slate-400",children:[t.id.slice(0,8),"..."]}),e.jsx("span",{className:`px-2 py-0.5 rounded border text-xs font-medium ${o}`,children:t.status}),e.jsx("span",{className:`px-2 py-0.5 rounded border text-xs font-medium bg-transparent ${l}`,children:t.proposal_type.replace(/_/g," ")})]}),e.jsx("div",{className:"text-sm text-white mt-1 truncate",children:t.proposal_name}),t.rationale&&e.jsxs("div",{className:"text-xs text-slate-500 mt-1 truncate",children:[t.rationale.slice(0,80),"..."]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[d&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:s,disabled:i,className:"px-3 py-1 rounded text-xs font-medium bg-green-600 hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed text-white",children:"Approve"}),e.jsx("button",{onClick:r,disabled:i,className:"px-3 py-1 rounded text-xs font-medium bg-red-600 hover:bg-red-500 disabled:opacity-50 disabled:cursor-not-allowed text-white",children:"Reject"})]}),e.jsx("div",{className:"text-xs text-slate-500",children:t.created_at&&new Date(t.created_at).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})}const U={"ACT-EX-AR-O1":ue,"ACT-EX-AR-O2":ge,"ACT-EX-CR-O1":pe,"ACT-EX-CR-O2":ye,"ACT-EX-RD-O1":he,"INC-AI-OI-O1":fe,"INC-AI-OI-O2":be,"INC-AI-ID-O1":je,"INC-HI-RI-O1":ve,"INC-HI-RI-O2":Ne,"POL-PR-PP-O1":_e,"POL-PR-PP-O2":Se};function Ce(t){return U[t]??null}function Ie(t){return t in U}function we({panel:t}){const s=Ce(t.panel_id);return s?e.jsx(s,{panel:t}):e.jsxs("div",{className:"bg-gray-900/50 border border-dashed border-gray-600 rounded-lg p-8 text-center",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Content surface — awaiting backend binding"}),e.jsxs("p",{className:"text-gray-600 text-xs mt-2 font-mono",children:["render_mode: ",t.render_mode," | controls: ",t.control_count]})]})}const Pe={Overview:D,Activity:Z,Incidents:V,Policies:de,Logs:ne},Re={FLAT:w,TREE:ie,GRID:se,TABLE:te,CARD:ee,LIST:w};function I(t){const s=new Set;for(const r of t)r.topic&&s.add(r.topic);return Array.from(s).sort()}function Te(t,s){return t.filter(r=>r.topic===s&&r.enabled)}function k(t){return t.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase())}function Fe({panel:t}){var o,l;const s=Re[t.render_mode]||w,r=(o=t._normalization)==null?void 0:o.auto_description,i=J(),n=E(),a=((l=t.controls)==null?void 0:l.filter(d=>d.category==="action"))||[];return e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary-900/30 rounded-lg",children:e.jsx(s,{size:20,className:"text-primary-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-100",children:t.panel_name}),t.short_description&&e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx("p",{className:"text-sm text-gray-400",children:t.short_description}),r&&e.jsx(g,{children:e.jsx("span",{className:"text-xs px-1 py-0.5 bg-amber-900/30 text-amber-500 rounded font-mono",children:"AUTO"})})]})]})]}),e.jsx(g,{children:e.jsx("span",{className:"text-xs px-2 py-1 bg-emerald-900/30 text-emerald-400 rounded font-mono",children:t.order})})]}),a.length>0&&e.jsxs("div",{className:"px-5 py-4 border-b border-gray-700 bg-gray-800/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-300 flex items-center gap-2",children:["Actions",i.isSimulationEnabled&&e.jsxs("span",{className:"flex items-center gap-1 text-xs px-2 py-0.5 rounded bg-amber-900/50 text-amber-400 border border-amber-700/50",children:[e.jsx(Y,{size:12}),"SIMULATION"]})]}),e.jsx(g,{children:e.jsxs("span",{className:"text-xs text-gray-500",children:[a.length," action",a.length!==1?"s":""]})})]}),e.jsx("div",{className:"space-y-2",children:a.map((d,m)=>e.jsx(re,{control:d,panelId:t.panel_id,showType:n.showControlTypes},`${d.type}-${m}`))})]}),e.jsx("div",{className:"p-5",children:Ie(t.panel_id)?e.jsxs(e.Fragment,{children:[e.jsx(we,{panel:t}),e.jsx(g,{children:e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-700/50",children:e.jsx("span",{className:"text-xs px-2 py-1 bg-green-900/30 text-green-400 rounded font-mono",children:"SDSR BOUND"})})})]}):e.jsxs("div",{className:"bg-gray-900/50 border border-dashed border-gray-600 rounded-lg p-8 text-center",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Content surface — awaiting backend binding"}),e.jsx(g,{children:e.jsxs("p",{className:"text-gray-600 text-xs mt-2 font-mono",children:["render_mode: ",t.render_mode," | controls: ",t.control_count]})})]})})]})}function Ae({topics:t,activeTopic:s,onSelectTopic:r}){return t.length===0?null:e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("div",{className:"flex gap-1 overflow-x-auto",children:t.map(i=>e.jsx("button",{onClick:()=>r(i),className:W("px-4 py-2.5 text-sm font-medium whitespace-nowrap transition-colors border-b-2 -mb-px",s===i?"text-primary-400 border-primary-400 bg-primary-900/10":"text-gray-400 border-transparent hover:text-gray-200 hover:border-gray-600"),children:k(i)},i))})})}function Oe({panels:t}){return t.length===0?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No panels in this topic."})}):e.jsx("div",{className:"space-y-4",children:t.map(s=>e.jsx(Fe,{panel:s},s.panel_id))})}function De(){return e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(ce,{className:"animate-spin text-gray-500 mr-3",size:24}),e.jsx("span",{className:"text-gray-400",children:"Loading projection..."})]})}function Ee({error:t,onRetry:s}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(O,{className:"text-red-500 mb-3",size:32}),e.jsx("h3",{className:"text-lg font-medium text-red-400 mb-2",children:"Failed to load"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:t}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-primary-600 text-white rounded hover:bg-primary-500",children:"Retry"})]})}function qe({domainName:t}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(O,{className:"text-amber-500 mb-3",size:32}),e.jsx("h3",{className:"text-lg font-medium text-amber-400 mb-2",children:"Domain Not Found"}),e.jsxs("p",{className:"text-sm text-gray-400",children:['The domain "',t,'" is not defined in the projection lock.']})]})}function _({domainName:t}){var T;const[s,r]=Q();E();const[i,n]=p.useState(!0),[a,o]=p.useState(null),[l,d]=p.useState(null),[m,h]=p.useState([]),c=s.get("subdomain"),[u,S]=p.useState(null),R=async()=>{n(!0),o(null);try{await ae();const f=le(t);if(f){d(f);const C=oe(t);if(c&&C.includes(c)){const j=F(t,c);h(j.filter(L=>L.enabled));const v=I(j);v.length>0&&!u&&S(v[0])}else if(C.length>0){const j=C[0];r({subdomain:j});const v=F(t,j);h(v.filter(H=>H.enabled));const L=I(v);L.length>0&&S(L[0])}else h([])}else d(null),h([])}catch(f){o(f instanceof Error?f.message:"Failed to load projection")}finally{n(!1)}};p.useEffect(()=>{R()},[t,c]);const y=p.useMemo(()=>I(m),[m]);p.useEffect(()=>{y.length>0&&(!u||!y.includes(u))&&S(y[0])},[y,u]);const z=p.useMemo(()=>u?Te(m,u):[],[m,u]),G=Pe[t]||D;return i?e.jsx(De,{}):a?e.jsx(Ee,{error:a,onRetry:R}):l?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary-900/30 rounded-lg",children:e.jsx(G,{size:24,className:"text-primary-400"})}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-100",children:l.domain})]}),c&&e.jsx("div",{className:"text-lg font-medium text-gray-300",children:k(c)}),l.short_description&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm text-gray-400",children:l.short_description}),((T=l._normalization)==null?void 0:T.auto_description)&&e.jsx(g,{children:e.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-amber-900/30 text-amber-500 rounded font-mono",children:"AUTO"})})]}),e.jsx(Ae,{topics:y,activeTopic:u,onSelectTopic:S}),u?e.jsx("div",{className:"space-y-4",children:e.jsx(Oe,{panels:z})}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Select a topic to view panels."})})]}):e.jsx(qe,{domainName:t})}function Ze(){return e.jsx(_,{domainName:"Overview"})}function et(){return e.jsx(_,{domainName:"Activity"})}function tt(){return e.jsx(_,{domainName:"Incidents"})}function st(){return e.jsx(_,{domainName:"Policies"})}function rt(){return e.jsx(_,{domainName:"Logs"})}export{et as ActivityPage,_ as DomainPage,tt as IncidentsPage,rt as LogsPage,Ze as OverviewPage,st as PoliciesPage};
