import{f as x,r as o,p,j as e,F as C,S as L,A as k,g as D,L as b,l as T,h as P,i as S,k as M,m as f,C as N,n as v,o as h}from"./index-BnpC133k.js";import{L as _}from"./layers-DhVPzhJz.js";import{L as y}from"./list-CPKIaiM_.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=x("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=x("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=x("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=x("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=x("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),O={Overview:b,Activity:D,Incidents:k,Policies:L,Logs:C},G={FLAT:y,TREE:_,GRID:I,TABLE:R,CARD:A,LIST:y};function H(s){const a=new Map;for(const r of s){const l=r.subdomain||"DEFAULT",t=r.topic||"GENERAL";a.has(l)||a.set(l,new Map);const n=a.get(l);n.has(t)||n.set(t,[]),n.get(t).push(r)}const i=[];for(const[r,l]of a){const t=Array.from(l.values()).flat();i.push({subdomain:r,topics:l,panelCount:t.length,enabledCount:t.filter(n=>n.enabled).length})}return i.sort((r,l)=>r.subdomain.localeCompare(l.subdomain))}function B({panel:s,compact:a=!1}){const i=G[s.render_mode]||y;return a?e.jsxs("div",{className:h("flex items-center justify-between px-3 py-2 rounded border transition-colors",s.enabled?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-gray-900/50 border-gray-800 opacity-60"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{size:14,className:"text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-200",children:s.panel_name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500 font-mono",children:s.render_mode}),s.enabled?e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500",title:"Enabled"}):e.jsx("span",{className:"w-2 h-2 rounded-full bg-gray-600",title:"Disabled"})]})]}):e.jsxs("div",{className:h("bg-gray-800 border border-gray-700 rounded-lg p-4 hover:border-gray-600 transition-colors",!s.enabled&&"opacity-60"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{size:16,className:"text-gray-500"}),e.jsx("h4",{className:"font-medium text-gray-100",children:s.panel_name})]}),e.jsx("span",{className:h("text-xs px-2 py-0.5 rounded",s.enabled?"bg-green-900/30 text-green-400":"bg-gray-700 text-gray-500"),children:s.enabled?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"space-y-1.5 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-gray-400",children:[e.jsx("span",{children:"ID"}),e.jsx("span",{className:"font-mono text-xs text-gray-500",children:s.panel_id})]}),e.jsxs("div",{className:"flex items-center justify-between text-gray-400",children:[e.jsx("span",{children:"Render"}),e.jsx("span",{className:"font-mono text-gray-300",children:s.render_mode})]}),e.jsxs("div",{className:"flex items-center justify-between text-gray-400",children:[e.jsx("span",{children:"Controls"}),e.jsx("span",{className:"font-mono text-gray-300",children:s.control_count})]})]}),s.controls.length>0&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.controls.slice(0,4).map((r,l)=>e.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-gray-700 text-gray-400 rounded",children:r.type},l)),s.controls.length>4&&e.jsxs("span",{className:"text-xs px-1.5 py-0.5 text-gray-500",children:["+",s.controls.length-4]})]})})]})}function q({topic:s,panels:a}){const[i,r]=o.useState(!0),l=a.filter(n=>n.enabled).length,t=()=>{r(!i),p.domain.topicExpand(s)};return e.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:t,className:"w-full flex items-center justify-between px-4 py-3 bg-gray-800/50 hover:bg-gray-800 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{size:14,className:"text-gray-500"}),e.jsx("span",{className:"font-medium text-gray-200",children:s.replace(/_/g," ")}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",l,"/",a.length," enabled)"]})]}),i?e.jsx(N,{size:16,className:"text-gray-500"}):e.jsx(v,{size:16,className:"text-gray-500"})]}),i&&e.jsx("div",{className:"p-3 space-y-2 bg-gray-900/30",children:a.map(n=>e.jsx(B,{panel:n,compact:!0},n.panel_id))})]})}function U({group:s}){const[a,i]=o.useState(!0),r=Array.from(s.topics.entries()).sort((t,n)=>t[0].localeCompare(n[0])),l=()=>{i(!a),p.domain.subdomainExpand(s.subdomain)};return e.jsxs("div",{className:"border border-gray-600 rounded-xl overflow-hidden",children:[e.jsxs("button",{onClick:l,className:"w-full flex items-center justify-between px-5 py-4 bg-gray-800 hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{size:18,className:"text-primary-400"}),e.jsx("span",{className:"font-semibold text-gray-100",children:s.subdomain.replace(/_/g," ")}),e.jsxs("span",{className:"text-sm text-gray-400",children:[s.enabledCount,"/",s.panelCount," panels • ",r.length," topics"]})]}),a?e.jsx(N,{size:18,className:"text-gray-400"}):e.jsx(v,{size:18,className:"text-gray-400"})]}),a&&e.jsx("div",{className:"p-4 space-y-3 bg-gray-850",children:r.map(([t,n])=>e.jsx(q,{topic:t,panels:n},t))})]})}function V(){return e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(M,{className:"animate-spin text-gray-500 mr-3",size:24}),e.jsx("span",{className:"text-gray-400",children:"Loading projection..."})]})}function Z({error:s,onRetry:a}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(f,{className:"text-red-500 mb-3",size:32}),e.jsx("h3",{className:"text-lg font-medium text-red-400 mb-2",children:"Failed to load"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:s}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-primary-600 text-white rounded hover:bg-primary-500",children:"Retry"})]})}function J({domainName:s}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(f,{className:"text-amber-500 mb-3",size:32}),e.jsx("h3",{className:"text-lg font-medium text-amber-400 mb-2",children:"Domain Not Found"}),e.jsxs("p",{className:"text-sm text-gray-400",children:['The domain "',s,'" is not defined in the projection lock.']})]})}function m({domainName:s}){const[a,i]=o.useState(!0),[r,l]=o.useState(null),[t,n]=o.useState(null),[c,u]=o.useState([]),j=async()=>{i(!0),l(null);try{await T();const d=P(s);d?(n(d),u(S(s))):(n(null),u([]))}catch(d){l(d instanceof Error?d.message:"Failed to load projection")}finally{i(!1)}};o.useEffect(()=>{j()},[s]);const g=o.useMemo(()=>{const d=H(c);return t&&p.domain.render(t.domain,d.length,c.length),d},[c,t]),w=O[s]||b,E=c.filter(d=>d.enabled);return a?e.jsx(V,{}):r?e.jsx(Z,{error:r,onRetry:j}):t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary-900/30 rounded-lg",children:e.jsx(w,{size:24,className:"text-primary-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-100",children:t.domain}),e.jsxs("p",{className:"text-sm text-gray-400",children:[g.length," subdomains • ",c.length," panels • ",t.total_controls," controls"]})]})]}),e.jsx("span",{className:"px-3 py-1 bg-amber-900/30 text-amber-400 text-sm font-mono rounded",children:"PREFLIGHT"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-semibold text-gray-100",children:g.length}),e.jsx("div",{className:"text-sm text-gray-400",children:"Subdomains"})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-semibold text-gray-100",children:c.length}),e.jsx("div",{className:"text-sm text-gray-400",children:"Total Panels"})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-semibold text-green-400",children:E.length}),e.jsx("div",{className:"text-sm text-gray-400",children:"Enabled"})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-semibold text-gray-100",children:t.total_controls}),e.jsx("div",{className:"text-sm text-gray-400",children:"Controls"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-200",children:"Subdomains & Topics"}),g.length===0?e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-8 text-center",children:e.jsx("p",{className:"text-gray-400",children:"No panels in this domain."})}):e.jsx("div",{className:"space-y-4",children:g.map(d=>e.jsx(U,{group:d},d.subdomain))})]}),e.jsxs("div",{className:"text-xs text-gray-500 border-t border-gray-800 pt-4",children:[e.jsx("span",{className:"font-mono",children:"Source: ui_projection_lock.json"}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsxs("span",{className:"font-mono",children:["Order: ",t.order]})]})]}):e.jsx(J,{domainName:s})}function X(){return e.jsx(m,{domainName:"Overview"})}function Y(){return e.jsx(m,{domainName:"Activity"})}function $(){return e.jsx(m,{domainName:"Incidents"})}function ee(){return e.jsx(m,{domainName:"Policies"})}function se(){return e.jsx(m,{domainName:"Logs"})}export{Y as ActivityPage,m as DomainPage,$ as IncidentsPage,se as LogsPage,X as OverviewPage,ee as PoliciesPage};
