import{e as m,r as g,j as e,I as o}from"./index-Cumb797X.js";import{u as d}from"./useQuery-CCaJ6Z3y.js";import{A as x}from"./activity-QuL4-Ix7.js";import{C as p}from"./chevron-right-BdTgfrGY.js";import{D as y}from"./dollar-sign-CfL9mPKX.js";import{H as j}from"./heart-Cw3IHLxA.js";import{R as b}from"./refresh-cw-CmWWJFix.js";import{S as v}from"./search-eJEagEwQ.js";import{S as N}from"./shield-D5PAFrWQ.js";import{T as f}from"./trending-up-Bz36NpXj.js";import{U as h}from"./users-iKsNFB9Z.js";import{a as c}from"./client-BT2DjEOZ.js";import"./index-B9ygI19o.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=m("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u=m("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);async function _(){return(await c.get("/api/v1/explorer/summary")).data}async function C(s){return(await c.get("/api/v1/explorer/tenants",{params:s})).data}async function S(s){return(await c.get(`/api/v1/explorer/tenant/${s}/diagnostics`)).data}async function T(){return(await c.get("/api/v1/explorer/system/health")).data}async function L(){return(await c.get("/api/v1/explorer/patterns")).data}function k(s){switch(s){case"healthy":return"text-green-400";case"degraded":return"text-yellow-400";case"critical":return"text-red-400";default:return"text-gray-400"}}function F(s){switch(s){case"pass":return"text-green-400 bg-green-900/30";case"warn":return"text-yellow-400 bg-yellow-900/30";case"fail":return"text-red-400 bg-red-900/30";default:return"text-gray-400 bg-gray-900/30"}}function q(s){switch(s){case"increasing":return{icon:"↑",color:"text-green-400"};case"decreasing":return{icon:"↓",color:"text-red-400"};case"stable":default:return{icon:"→",color:"text-gray-400"}}}function z(s){switch(s){case"high":return"text-red-400 bg-red-900/30";case"medium":return"text-yellow-400 bg-yellow-900/30";case"low":return"text-blue-400 bg-blue-900/30";default:return"text-gray-400 bg-gray-900/30"}}function U(s){return`${s.toFixed(1)}%`}function $(s){return s>=90?"text-red-400":s>=70?"text-yellow-400":"text-green-400"}function A(){const{data:s,isLoading:r,refetch:t}=d({queryKey:["explorer","summary"],queryFn:_,staleTime:3e4});return r?e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-700 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-20 bg-gray-700 rounded"})]}):s?e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-5 w-5 text-primary-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"System Overview"})]}),e.jsx("button",{onClick:()=>t(),className:"p-2 text-gray-400 hover:text-white transition-colors",title:"Refresh",children:e.jsx(b,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:s.total_tenants}),e.jsx("div",{className:"text-sm text-gray-400",children:"Total Tenants"})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:s.total_agents}),e.jsx("div",{className:"text-sm text-gray-400",children:"Total Agents"})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:s.runs_last_24h.toLocaleString()}),e.jsx("div",{className:"text-sm text-gray-400",children:"Runs (24h)"})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:`text-2xl font-bold ${k(s.system_health)}`,children:s.system_health.toUpperCase()})}),e.jsx("div",{className:"text-sm text-gray-400",children:"System Health"})]})]}),s.active_incidents>0&&e.jsxs("div",{className:"mt-4 p-3 bg-red-900/20 border border-red-800 rounded-lg flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5 text-red-400"}),e.jsxs("span",{className:"text-red-400",children:[s.active_incidents," active incident",s.active_incidents>1?"s":""," across tenants"]})]})]}):null}function R(){const{data:s,isLoading:r}=d({queryKey:["explorer","health"],queryFn:T,staleTime:3e4});return r?e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-700 rounded w-1/3 mb-4"}),e.jsx("div",{className:"space-y-2",children:[1,2,3].map(t=>e.jsx("div",{className:"h-8 bg-gray-700 rounded"},t))})]}):s?e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(j,{className:"h-5 w-5 text-primary-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Health Checks"})]}),e.jsx("div",{className:"space-y-2",children:s.checks.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-900/50 rounded",children:[e.jsx("span",{className:"text-gray-300",children:t.name}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${F(t.status)}`,children:t.status.toUpperCase()})]},t.name))}),e.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:["Uptime: ",s.uptime_pct.toFixed(2),"%"]})]}):null}function D(){const{data:s,isLoading:r}=d({queryKey:["explorer","patterns"],queryFn:L,staleTime:6e4});return r?e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-700 rounded w-1/3 mb-4"}),e.jsx("div",{className:"space-y-2",children:[1,2,3].map(t=>e.jsx("div",{className:"h-12 bg-gray-700 rounded"},t))})]}):s?e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(f,{className:"h-5 w-5 text-primary-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Usage Patterns"})]}),e.jsx("div",{className:"space-y-3",children:s.patterns.slice(0,5).map((t,n)=>{const a=q(t.trend);return e.jsxs("div",{className:"p-3 bg-gray-900/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-white font-medium",children:t.pattern_type}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${z(t.significance)}`,children:t.significance})]}),e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["Frequency: ",t.frequency]}),e.jsxs("span",{children:["Tenants: ",t.affected_tenants]}),e.jsxs("span",{className:a.color,children:[a.icon," ",t.trend]})]})]},n)})}),e.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:["Analyzed ",s.total_events_analyzed.toLocaleString()," events"]})]}):null}function H({onSelectTenant:s}){const[r,t]=g.useState(""),{data:n,isLoading:a}=d({queryKey:["explorer","tenants"],queryFn:()=>C({sortBy:"activity",order:"desc"}),staleTime:3e4}),l=n==null?void 0:n.filter(i=>i.tenant_id.toLowerCase().includes(r.toLowerCase())||i.name.toLowerCase().includes(r.toLowerCase()));return a?e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-700 rounded w-1/3 mb-4"}),e.jsx("div",{className:"space-y-2",children:[1,2,3,4].map(i=>e.jsx("div",{className:"h-16 bg-gray-700 rounded"},i))})]}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(w,{className:"h-5 w-5 text-primary-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Tenants"})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(v,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-500"}),e.jsx("input",{type:"text",placeholder:"Search tenants...",value:r,onChange:i=>t(i.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:l==null?void 0:l.map(i=>e.jsxs("button",{onClick:()=>s(i.tenant_id),className:"w-full p-3 bg-gray-900/50 rounded-lg hover:bg-gray-900 transition-colors text-left group",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:i.name}),e.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:[i.tenant_id.slice(0,8),"..."]})]}),e.jsx(p,{className:"h-4 w-4 text-gray-600 group-hover:text-primary-400 transition-colors"})]}),e.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(h,{className:"h-3 w-3"}),i.metrics.active_agents," agents"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(x,{className:"h-3 w-3"}),i.metrics.total_runs," runs"]}),i.metrics.incidents_last_7d>0&&e.jsxs("span",{className:"flex items-center gap-1 text-yellow-400",children:[e.jsx(o,{className:"h-3 w-3"}),i.metrics.incidents_last_7d," incidents"]})]})]},i.tenant_id))})]})}function M({tenantId:s,onClose:r}){const{data:t,isLoading:n}=d({queryKey:["explorer","diagnostics",s],queryFn:()=>S(s),staleTime:3e4});if(n)return e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-700 rounded w-1/2 mb-4"}),e.jsx("div",{className:"space-y-4",children:[1,2,3].map(l=>e.jsx("div",{className:"h-24 bg-gray-700 rounded"},l))})]});if(!t)return null;const{diagnostics:a}=t;return e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5 text-primary-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Tenant Diagnostics"})]}),e.jsx("button",{onClick:r,className:"text-sm text-gray-400 hover:text-white",children:"Close"})]}),e.jsx("div",{className:"text-sm text-gray-400 mb-4 font-mono",children:s}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),"Agents"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-900/50 rounded p-3",children:[e.jsx("div",{className:"text-xl font-bold text-white",children:a.agents.total}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Agents"})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded p-3",children:[e.jsx("div",{className:"text-xl font-bold text-white",children:a.agents.by_status.active||0}),e.jsx("div",{className:"text-xs text-gray-500",children:"Active"})]})]}),a.agents.recent_failures.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-red-900/20 border border-red-800 rounded",children:[e.jsx("div",{className:"text-xs text-red-400 mb-2",children:"Recent Failures"}),a.agents.recent_failures.slice(0,3).map(l=>e.jsxs("div",{className:"text-sm text-gray-300",children:[l.name," - ",l.failure_count," failures"]},l.agent_id))]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2",children:[e.jsx(x,{className:"h-4 w-4"}),"Runs"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-gray-900/50 rounded p-3",children:[e.jsx("div",{className:"text-xl font-bold text-white",children:a.runs.total.toLocaleString()}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Runs"})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded p-3",children:[e.jsxs("div",{className:"text-xl font-bold text-white",children:[a.runs.avg_duration_ms.toFixed(0),"ms"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Avg Duration"})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded p-3",children:[e.jsxs("div",{className:"text-xl font-bold text-white",children:[a.runs.p95_duration_ms.toFixed(0),"ms"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"P95 Duration"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),"Budget"]}),e.jsxs("div",{className:"bg-gray-900/50 rounded p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-400",children:"Utilization"}),e.jsx("span",{className:`font-bold ${$(a.budget.utilization_pct)}`,children:U(a.budget.utilization_pct)})]}),e.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${a.budget.utilization_pct>=90?"bg-red-500":a.budget.utilization_pct>=70?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(a.budget.utilization_pct,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["$",(a.budget.total_spent_cents/100).toFixed(2)," spent"]}),e.jsxs("span",{children:["$",(a.budget.limit_cents/100).toFixed(2)," limit"]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2",children:[e.jsx(o,{className:"h-4 w-4"}),"Incidents"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-900/50 rounded p-3",children:[e.jsx("div",{className:`text-xl font-bold ${a.incidents.open>0?"text-red-400":"text-white"}`,children:a.incidents.open}),e.jsx("div",{className:"text-xs text-gray-500",children:"Open"})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded p-3",children:[e.jsx("div",{className:"text-xl font-bold text-green-400",children:a.incidents.resolved_last_7d}),e.jsx("div",{className:"text-xs text-gray-500",children:"Resolved (7d)"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2",children:[e.jsx(N,{className:"h-4 w-4"}),"Policies"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-900/50 rounded p-3",children:[e.jsx("div",{className:"text-xl font-bold text-white",children:a.policies.active}),e.jsx("div",{className:"text-xs text-gray-500",children:"Active Policies"})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded p-3",children:[e.jsx("div",{className:`text-xl font-bold ${a.policies.violations_last_7d>0?"text-yellow-400":"text-white"}`,children:a.policies.violations_last_7d}),e.jsx("div",{className:"text-xs text-gray-500",children:"Violations (7d)"})]})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-700 text-xs text-gray-500",children:["Collected at: ",new Date(t.collected_at).toLocaleString()]})]})}function X(){const[s,r]=g.useState(null);return e.jsxs("div",{className:"min-h-screen bg-gray-900 p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(u,{className:"h-8 w-8 text-emerald-400"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Founder Explorer"})]}),e.jsx("p",{className:"text-gray-400",children:"Cross-tenant visibility for business learning and diagnostics"}),e.jsxs("div",{className:"mt-4 p-3 bg-emerald-900/20 border border-emerald-800 rounded-lg text-sm text-emerald-400",children:[e.jsx("strong",{children:"READ-ONLY:"})," This console provides visibility into all tenants for diagnostic purposes. No mutation operations are available."]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx(A,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(R,{}),e.jsx(D,{})]})]}),e.jsx("div",{children:s?e.jsx(M,{tenantId:s,onClose:()=>r(null)}):e.jsx(H,{onSelectTenant:r})})]})]})}export{X as default};
