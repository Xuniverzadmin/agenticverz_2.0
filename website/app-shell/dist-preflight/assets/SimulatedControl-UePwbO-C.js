import{f as n,j as t,E as m,M as G,X as u,I as O,V as z,r as b,Y as F,Z as E,_ as $,$ as q,a0 as V,a1 as X}from"./index-KppIquYQ.js";import{R as B}from"./refresh-cw-C5XbiSIu.js";import{S as Y}from"./shield-DOFc1kEW.js";import{M as K}from"./Modal-REvkbvop.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=n("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=n("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=n("FileOutput",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4",key:"702lig"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M2 15h10",key:"jfw4w8"}],["path",{d:"m5 12-3 3 3 3",key:"oke12k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=n("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=n("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=n("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=n("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=n("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=n("XOctagon",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function Q({open:e,onClose:i,onConfirm:a,title:y,subtitle:T,message:h,confirmText:x="Confirm",cancelText:l="Cancel",variant:f="default"}){const p=f==="destructive",g=p?G:u;return t.jsx(K,{open:e,onClose:i,title:y,description:T,size:"sm",footer:t.jsxs(t.Fragment,{children:[t.jsx(O,{variant:"ghost",onClick:i,children:l}),t.jsx(O,{variant:p?"destructive":"default",onClick:a,children:x})]}),children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:m("p-2 rounded-full",p?"bg-red-900/30":"bg-amber-900/30"),children:t.jsx(g,{size:24,className:m(p?"text-red-400":"text-amber-400")})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm text-gray-300",children:h}),t.jsx("div",{className:"mt-3 p-3 rounded bg-gray-900/50 border border-gray-700",children:t.jsxs("p",{className:"text-xs text-gray-400",children:[t.jsx("span",{className:"text-amber-400 font-medium",children:"Simulation Mode:"})," ","No actual changes will be made to the system."]})})]})]})})}const ee={FILTER:u,SORT:u,SELECT_SINGLE:u,SELECT_MULTI:u,NAVIGATE:u,DOWNLOAD:R,ACKNOWLEDGE:E,RESOLVE:E,STOP:W,RETRY:B,REPLAY_EXPORT:R,MITIGATE:Y,CLOSE:J,ESCALATE:G,TOGGLE:Z,EDIT:H,ARCHIVE:U,DELETE:F},D={data_control:{base:"bg-blue-900/30 text-blue-400 border-blue-700",hover:"hover:bg-blue-900/50 hover:border-blue-600",active:"bg-blue-800/50 border-blue-500"},selection:{base:"bg-purple-900/30 text-purple-400 border-purple-700",hover:"hover:bg-purple-900/50 hover:border-purple-600",active:"bg-purple-800/50 border-purple-500"},navigation:{base:"bg-cyan-900/30 text-cyan-400 border-cyan-700",hover:"hover:bg-cyan-900/50 hover:border-cyan-600",active:"bg-cyan-800/50 border-cyan-500"},action:{base:"bg-green-900/30 text-green-400 border-green-700",hover:"hover:bg-green-900/50 hover:border-green-600",active:"bg-green-800/50 border-green-500"},unknown:{base:"bg-gray-700 text-gray-400 border-gray-600",hover:"hover:bg-gray-600 hover:border-gray-500",active:"bg-gray-600 border-gray-500"}},k={STOP:{title:"Stop execution?",message:"This will simulate stopping the execution. The run will continue unaffected.",confirmText:"Stop (Preview)"},MITIGATE:{title:"Mitigate incident?",message:"This will record a mitigation request. No actual mitigation action will be executed.",confirmText:"Record Mitigation (Preview)"},CLOSE:{title:"Close incident?",message:"This will acknowledge closure intent. The incident remains visible for audit purposes.",confirmText:"Acknowledge Closure (Preview)"},ESCALATE:{title:"Escalate incident?",message:"This will record an escalation request. No ownership transfer will occur.",confirmText:"Record Escalation (Preview)"},DELETE:{title:"Delete logs?",message:"Log deletion is blocked. Logs are immutable and cannot be removed.",confirmText:"Understood"}};function oe({control:e,panelId:i,entityId:a,showType:y=!1,disabled:T=!1}){var L,M,A;const{executeSimulatedAction:h,executeRealAction:x,isRealMode:l,isSimulationEnabled:f}=z(),[p,g]=b.useState(!1),[w,r]=b.useState(null),[N,o]=b.useState(!1),I=ee[e.type]||u,C=D[e.category]||D.unknown,v=$(e.type),P=e.category==="action",d=f&&P&&!T,c=q(e.type),j=V(e.type),S=b.useCallback(async()=>{if(d){if(j&&!c){g(!0);return}if(l(e.type)&&a){const s=await x(e.type,i,a);s.success?r(`New run created: ${s.newRunId}`):r(`Failed: ${s.error}`),o(!0),setTimeout(()=>{r(null),o(!1)},5e3);return}await h(e.type,i),r(v.inline),o(!0),setTimeout(()=>{r(null),o(!1)},5e3)}},[d,j,c,l,a,x,h,e.type,i,v.inline]),_=b.useCallback(async()=>{if(g(!1),l(e.type)&&a){const s=await x(e.type,i,a);s.success?r(`New run created: ${s.newRunId}`):r(`Failed: ${s.error}`),o(!0),setTimeout(()=>{r(null),o(!1)},5e3);return}await h(e.type,i),r(v.inline),o(!0),setTimeout(()=>{r(null),o(!1)},5e3)},[l,a,x,h,e.type,i,v.inline]);return t.jsxs(t.Fragment,{children:[t.jsxs("div",{role:d?"button":void 0,tabIndex:d?0:void 0,onClick:S,onKeyDown:s=>{d&&(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),S())},className:m("flex flex-col rounded-lg border transition-all duration-200",C.base,d&&[C.hover,"cursor-pointer"],N&&C.active,!e.enabled&&!f&&"opacity-50",c&&"border-red-700/50"),children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(I,{size:16,className:m(c&&"text-red-400",N&&"animate-pulse")}),t.jsx("span",{className:"text-sm font-mono",children:e.type}),y&&t.jsxs("span",{className:"text-xs opacity-70",children:["(",e.category,")"]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[d&&t.jsx("span",{className:m("text-xs px-2 py-0.5 rounded border",c?"bg-red-900/50 text-red-400 border-red-700/50":l(e.type)&&a?"bg-green-900/50 text-green-400 border-green-700/50":"bg-amber-900/50 text-amber-400 border-amber-700/50"),children:c?"BLOCKED":l(e.type)&&a?"REAL":"SIMULATED"}),y&&t.jsxs("span",{className:"text-xs opacity-70",children:["Order: ",e.order]}),e.enabled?t.jsx(E,{size:14,className:"text-green-400"}):t.jsx(X,{size:14,className:"text-gray-500"})]})]}),w&&t.jsx("div",{className:m("px-4 py-2 text-xs border-t",c?"bg-red-900/20 border-red-700/30 text-red-300":"bg-amber-900/20 border-amber-700/30 text-amber-300"),children:t.jsx("span",{className:"opacity-80",children:w})}),e.disabled_reason&&!w&&t.jsx("div",{className:"px-4 py-2 text-xs border-t border-gray-700/50 bg-gray-800/50 text-gray-400",children:e.disabled_reason})]}),t.jsx(Q,{open:p,onClose:()=>g(!1),onConfirm:_,title:((L=k[e.type])==null?void 0:L.title)||`${e.type}?`,subtitle:"Simulation only",message:((M=k[e.type])==null?void 0:M.message)||`This will simulate the ${e.type.toLowerCase()} action. No actual changes will be made.`,confirmText:((A=k[e.type])==null?void 0:A.confirmText)||`${e.type} (Preview)`,cancelText:"Cancel",variant:c?"destructive":"default"})]})}export{ie as C,ne as G,oe as S,le as T};
