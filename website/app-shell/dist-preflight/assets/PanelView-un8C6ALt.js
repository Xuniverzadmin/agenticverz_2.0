import{f as S,W as E,V as T,r as i,j as e,L as y,M as k,E as x,X as P,J as C,K as f}from"./index-KppIquYQ.js";import{A as M}from"./activity-DcrdMZEZ.js";import{A}from"./arrow-left-DrPQYbfI.js";import{C as O,T as z,G as F,S as B}from"./SimulatedControl-UePwbO-C.js";import{F as $}from"./file-text-kHBdGibj.js";import{L as N}from"./layers-WKzZkqYb.js";import{L as b,l as V,p as G,g as v}from"./ui_projection_loader-B9H141-c.js";import{L as m}from"./list-vBwHXCn_.js";import{L as U}from"./loader-2-Bq2xiA3F.js";import{S as w}from"./shield-DOFc1kEW.js";import{u as q,I as W}from"./RendererContext-CAEOzvyZ.js";import"./refresh-cw-C5XbiSIu.js";import"./Modal-REvkbvop.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=S("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),J={Overview:b,Activity:M,Incidents:k,Policies:w,Logs:$},K={FLAT:m,TREE:N,GRID:F,TABLE:z,CARD:O,LIST:m};function X(t){const n=v();for(const a of n)for(const l of a.panels)if(l.route===t)return l}function Q(t){const n=v();for(const a of n)for(const l of a.panels)if(l.route===t)return a.domain}function Y({permissions:t}){const n=[{key:"nav_required",label:"Navigation Required",value:t.nav_required},{key:"filtering",label:"Filtering",value:t.filtering},{key:"read",label:"Read",value:t.read},{key:"write",label:"Write",value:t.write},{key:"activate",label:"Activate",value:t.activate}];return e.jsx("div",{className:"grid grid-cols-5 gap-2",children:n.map(a=>e.jsx("div",{className:x("px-3 py-2 rounded text-center text-xs border",a.value?"bg-green-900/20 border-green-700/50 text-green-400":"bg-gray-800 border-gray-700 text-gray-500"),children:a.label},a.key))})}function Z(){return e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx(U,{className:"animate-spin text-gray-500 mr-3",size:24}),e.jsx("span",{className:"text-gray-400",children:"Loading panel..."})]})}function ee({error:t,onRetry:n}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(f,{className:"text-red-500 mb-3",size:32}),e.jsx("h3",{className:"text-lg font-medium text-red-400 mb-2",children:"Failed to load"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:t}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-primary-600 text-white rounded hover:bg-primary-500",children:"Retry"})]})}function se({route:t,domainRoute:n}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(f,{className:"text-amber-500 mb-3",size:32}),e.jsx("h3",{className:"text-lg font-medium text-amber-400 mb-2",children:"Panel Not Found"}),e.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:['No panel found at route "',t,'" in the projection lock.']}),e.jsxs(y,{to:n,className:"px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 flex items-center gap-2",children:[e.jsx(A,{size:16}),"Back to Domain"]})]})}function he(){const{domain:t,panelSlug:n}=E(),a=q(),l=T(),[R,p]=i.useState(!0),[g,h]=i.useState(null),[s,_]=i.useState(null),[c,I]=i.useState(void 0),o=`/precus/${t}/${n}`,u=`/precus/${t}`,j=async()=>{p(!0),h(null);try{await V();const r=X(o),d=Q(o);_(r||null),I(d),r&&G.panel.render(r.panel_id,r.panel_name)}catch(r){h(r instanceof Error?r.message:"Failed to load projection")}finally{p(!1)}};i.useEffect(()=>{j()},[o]);const L=c?J[c]:b,D=s?K[s.render_mode]:m;return R?e.jsx(Z,{}):g?e.jsx(ee,{error:g,onRetry:j}):s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsxs(y,{to:u,className:"hover:text-gray-200 flex items-center gap-1",children:[e.jsx(L,{size:14}),e.jsx("span",{children:c})]}),e.jsx("span",{children:"/"}),e.jsx("span",{className:"text-gray-200",children:s.panel_name})]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:x("p-3 rounded-lg",s.enabled?"bg-primary-900/30":"bg-gray-800"),children:e.jsx(D,{size:28,className:s.enabled?"text-primary-400":"text-gray-500"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-100",children:s.panel_name}),s.short_description&&a.mode==="CUSTOMER"&&e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.short_description}),a.showInternalIDs&&e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("p",{className:"text-sm text-gray-500 font-mono",children:s.panel_id}),s.short_description&&e.jsxs("p",{className:"text-sm text-gray-500",children:["— ",s.short_description]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:x("px-3 py-1.5 rounded text-sm font-medium",s.enabled?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"),children:s.enabled?"Enabled":"Disabled"}),a.showDebugBanner&&!0&&e.jsx("span",{className:"px-3 py-1.5 bg-amber-900/30 text-amber-400 text-sm font-mono rounded",children:"PREFLIGHT"}),a.showDebugBanner&&e.jsx("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-400 text-xs font-mono rounded border border-blue-700/50",children:a.mode})]})]}),!s.enabled&&s.disabled_reason&&(a.showDisabledReasons||a.mode==="CUSTOMER")&&e.jsxs("div",{className:"bg-red-900/20 border border-red-700/50 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(H,{size:20,className:"text-red-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-red-400",children:a.mode==="CUSTOMER"?"Not Available":"Disabled Reason"}),e.jsx("p",{className:"text-sm text-gray-300 mt-1",children:s.disabled_reason})]})]}),e.jsx(W,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4 space-y-3",children:[e.jsxs("h3",{className:"font-medium text-gray-200 flex items-center gap-2",children:[e.jsx(P,{size:14,className:"text-blue-400"}),"Panel Info"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[a.showRenderMode&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Render Mode"}),e.jsx("span",{className:"text-gray-200 font-mono",children:s.render_mode})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Visibility"}),e.jsx("span",{className:"text-gray-200 font-mono",children:s.visibility})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"View Type"}),e.jsx("span",{className:"text-gray-200 font-mono",children:s.view_type})]}),a.showOrderInfo&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Order"}),e.jsx("span",{className:"text-gray-200 font-mono",children:s.order})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4 space-y-3",children:[e.jsxs("h3",{className:"font-medium text-gray-200 flex items-center gap-2",children:[e.jsx(N,{size:14,className:"text-purple-400"}),"Topic Info"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Subdomain"}),e.jsx("span",{className:"text-gray-200",children:s.subdomain||"—"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Topic"}),e.jsx("span",{className:"text-gray-200",children:s.topic||"—"})]}),a.showInternalIDs&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Topic ID"}),e.jsx("span",{className:"text-gray-200 font-mono text-xs",children:s.topic_id||"—"})]}),a.showRouteInfo&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Route"}),e.jsx("span",{className:"text-gray-200 font-mono text-xs",children:s.route})]})]})]})]})}),a.showPermissions&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4 space-y-3",children:[e.jsxs("h3",{className:"font-medium text-gray-200 flex items-center gap-2",children:[e.jsx(w,{size:14,className:"text-green-400"}),"Permissions"]}),e.jsx(Y,{permissions:s.permissions})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-medium text-gray-200 flex items-center gap-2",children:["Controls ",a.showMetadata&&`(${s.control_count})`,l.isSimulationEnabled&&e.jsxs("span",{className:"flex items-center gap-1 text-xs px-2 py-0.5 rounded bg-amber-900/50 text-amber-400 border border-amber-700/50",children:[e.jsx(C,{size:12}),"SIMULATION"]})]}),a.showMetadata&&e.jsxs("span",{className:"text-xs text-gray-500",children:[s.controls.filter(r=>r.enabled).length," enabled",s.controls.filter(r=>r.category==="action").length>0&&e.jsxs("span",{className:"ml-2 text-amber-400",children:["(",s.controls.filter(r=>r.category==="action").length," actions)"]})]})]}),s.controls.length===0?e.jsx("p",{className:"text-gray-500 text-sm py-4 text-center",children:"No controls defined"}):e.jsx("div",{className:"space-y-2",children:s.controls.map((r,d)=>e.jsx(B,{control:r,panelId:s.panel_id,showType:a.showControlTypes},`${r.type}-${d}`))})]}),e.jsx("div",{className:"bg-gray-900/50 border border-dashed border-gray-700 rounded-lg p-8 text-center",children:a.mode==="INSPECTOR"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Data execution surface placeholder — no backend wired"}),e.jsxs("p",{className:"text-gray-600 text-xs mt-2 font-mono",children:["render_mode: ",s.render_mode," | controls: ",s.control_count]})]}):e.jsx("p",{className:"text-gray-500 text-sm",children:"Coming soon"})}),a.showMetadata&&e.jsxs("div",{className:"text-xs text-gray-500 border-t border-gray-800 pt-4",children:[e.jsx("span",{className:"font-mono",children:"Source: ui_projection_lock.json"}),e.jsx("span",{className:"mx-2",children:"|"}),e.jsxs("span",{className:"font-mono",children:["Route: ",s.route]}),e.jsx("span",{className:"mx-2",children:"|"}),e.jsxs("span",{className:"font-mono",children:["Mode: ",a.mode]})]})]}):e.jsx(se,{route:o,domainRoute:u})}export{he as default};
