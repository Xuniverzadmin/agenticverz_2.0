# Mypy configuration for Agenticverz 2.0
# Reference: docs/HOUSEKEEPING_CLASSIFICATION.md
# Date: 2025-12-30
#
# QUARANTINE STRATEGY:
# - Bucket B (structural debt) modules are quarantined with ignore_errors = True
# - Each quarantine has a comment explaining WHY
# - Goal: Restore signal, not achieve zero warnings

[mypy]
python_version = 3.11
warn_return_any = False
warn_unused_ignores = False
ignore_missing_imports = True
no_strict_optional = True
disable_error_code = annotation-unchecked

# Note: sqlmodel.mypy_model_plugin removed - not available in current environment
# SQLModel types are handled via quarantine configuration below

# Global quarantine for backend modules during housekeeping phase
# This will be narrowed down as modules are fixed
[mypy-backend.*]
ignore_errors = True

[mypy-app.*]
ignore_errors = True

[mypy-budgetllm.*]
ignore_errors = True

# =============================================================================
# QUARANTINED MODULES (Bucket B — Structural Debt)
# =============================================================================
# These modules are quarantined due to SQLModel/SQLAlchemy typing issues.
# They are NOT ignored — they are ACKNOWLEDGED as structural debt.
# Review trigger: Phase B or major refactor

# Alembic migrations - not runtime code, different import pattern
[mypy-backend.alembic.versions.*]
ignore_errors = True
# QUARANTINED: Alembic migrations require E402 pattern, not runtime code

# Guard API - 200+ errors, SQLModel-heavy
[mypy-backend.app.api.guard]
ignore_errors = True
# QUARANTINED: SQLModel exec() typing, gradual fix in Phase B

# Agents API - 150+ errors, complex SQLModel patterns
[mypy-backend.app.api.agents]
ignore_errors = True
# QUARANTINED: SQLModel patterns, gradual fix in Phase B

# Main module - legacy patterns
[mypy-backend.app.main]
ignore_errors = True
# QUARANTINED: Legacy endpoint patterns, gradual fix

# Cost Intelligence API - SQLModel-heavy
[mypy-backend.app.api.cost_intelligence]
ignore_errors = True
# QUARANTINED: SQLModel patterns, gradual fix

# Costsim API - SQLModel-heavy
[mypy-backend.app.api.costsim]
ignore_errors = True
# QUARANTINED: SQLModel patterns, gradual fix

# V1 Proxy - SQLModel patterns
[mypy-backend.app.api.v1_proxy]
ignore_errors = True
# QUARANTINED: SQLModel patterns, gradual fix

# Ops API - SQLModel patterns
[mypy-backend.app.api.ops]
ignore_errors = True
# QUARANTINED: SQLModel patterns, gradual fix

# Workers API
[mypy-backend.app.api.workers]
ignore_errors = True
# QUARANTINED: SQLModel patterns

# Status History API
[mypy-backend.app.api.status_history]
ignore_errors = True
# QUARANTINED: Async file operations (intentional)

# =============================================================================
# MODULES THAT MUST PASS (Not quarantined)
# =============================================================================
# New code must pass mypy. These are enforced.

[mypy-backend.app.db]
ignore_errors = False
# ENFORCED: Core database module

[mypy-backend.app.auth.*]
ignore_errors = False
# ENFORCED: Authentication is security-critical

[mypy-backend.app.middleware.*]
ignore_errors = False
# ENFORCED: Middleware affects all requests

[mypy-backend.app.config.*]
ignore_errors = False
# ENFORCED: Configuration affects runtime
